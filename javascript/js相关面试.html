<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>js 运行机制 | note</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="note">
    
    <link rel="preload" href="/note/assets/css/0.styles.12c78510.css" as="style"><link rel="preload" href="/note/assets/js/app.488c70a4.js" as="script"><link rel="preload" href="/note/assets/js/3.38c21980.js" as="script"><link rel="preload" href="/note/assets/js/7.0a11c70e.js" as="script"><link rel="prefetch" href="/note/assets/js/10.3f67f622.js"><link rel="prefetch" href="/note/assets/js/100.cb354b05.js"><link rel="prefetch" href="/note/assets/js/101.5dc6fbd8.js"><link rel="prefetch" href="/note/assets/js/102.b748e78d.js"><link rel="prefetch" href="/note/assets/js/103.807da28c.js"><link rel="prefetch" href="/note/assets/js/104.7a2cd087.js"><link rel="prefetch" href="/note/assets/js/105.8b60f03f.js"><link rel="prefetch" href="/note/assets/js/106.ee2f5ef4.js"><link rel="prefetch" href="/note/assets/js/107.d2c95b73.js"><link rel="prefetch" href="/note/assets/js/108.6985e00d.js"><link rel="prefetch" href="/note/assets/js/109.8fb13bc0.js"><link rel="prefetch" href="/note/assets/js/11.28108975.js"><link rel="prefetch" href="/note/assets/js/110.707b4bcd.js"><link rel="prefetch" href="/note/assets/js/111.b63f3860.js"><link rel="prefetch" href="/note/assets/js/112.66a02e54.js"><link rel="prefetch" href="/note/assets/js/113.8d9f7031.js"><link rel="prefetch" href="/note/assets/js/114.924a9399.js"><link rel="prefetch" href="/note/assets/js/115.93f3d59e.js"><link rel="prefetch" href="/note/assets/js/116.df516761.js"><link rel="prefetch" href="/note/assets/js/117.a7cefecf.js"><link rel="prefetch" href="/note/assets/js/118.f0222a9d.js"><link rel="prefetch" href="/note/assets/js/119.cd8fb220.js"><link rel="prefetch" href="/note/assets/js/12.8383729c.js"><link rel="prefetch" href="/note/assets/js/120.084c82a4.js"><link rel="prefetch" href="/note/assets/js/121.25361534.js"><link rel="prefetch" href="/note/assets/js/122.9e7558ba.js"><link rel="prefetch" href="/note/assets/js/123.6a0a16f9.js"><link rel="prefetch" href="/note/assets/js/124.3b4eb741.js"><link rel="prefetch" href="/note/assets/js/125.2dd198fa.js"><link rel="prefetch" href="/note/assets/js/126.f151366a.js"><link rel="prefetch" href="/note/assets/js/127.42cc294b.js"><link rel="prefetch" href="/note/assets/js/128.e026049f.js"><link rel="prefetch" href="/note/assets/js/129.21db3290.js"><link rel="prefetch" href="/note/assets/js/13.e1a45f98.js"><link rel="prefetch" href="/note/assets/js/130.8b4ed3ee.js"><link rel="prefetch" href="/note/assets/js/131.e85ba5f9.js"><link rel="prefetch" href="/note/assets/js/132.971a0e72.js"><link rel="prefetch" href="/note/assets/js/133.503d053e.js"><link rel="prefetch" href="/note/assets/js/134.aca3f3ca.js"><link rel="prefetch" href="/note/assets/js/135.c0886a37.js"><link rel="prefetch" href="/note/assets/js/136.4411464d.js"><link rel="prefetch" href="/note/assets/js/137.bae4cc9e.js"><link rel="prefetch" href="/note/assets/js/138.2d31e0bc.js"><link rel="prefetch" href="/note/assets/js/139.67a012c2.js"><link rel="prefetch" href="/note/assets/js/14.e64b9505.js"><link rel="prefetch" href="/note/assets/js/140.9c3a9dbb.js"><link rel="prefetch" href="/note/assets/js/141.1a28a75d.js"><link rel="prefetch" href="/note/assets/js/142.6b5ef6b3.js"><link rel="prefetch" href="/note/assets/js/143.ad82c882.js"><link rel="prefetch" href="/note/assets/js/144.2e135e05.js"><link rel="prefetch" href="/note/assets/js/145.ce1d10c3.js"><link rel="prefetch" href="/note/assets/js/146.0c43f3d0.js"><link rel="prefetch" href="/note/assets/js/147.edce7195.js"><link rel="prefetch" href="/note/assets/js/148.5bf80fc7.js"><link rel="prefetch" href="/note/assets/js/149.193605b3.js"><link rel="prefetch" href="/note/assets/js/15.2aafd23f.js"><link rel="prefetch" href="/note/assets/js/150.9cd606df.js"><link rel="prefetch" href="/note/assets/js/151.3c54b27d.js"><link rel="prefetch" href="/note/assets/js/152.b9580021.js"><link rel="prefetch" href="/note/assets/js/153.a0ddef70.js"><link rel="prefetch" href="/note/assets/js/154.80aa9b03.js"><link rel="prefetch" href="/note/assets/js/155.668dc053.js"><link rel="prefetch" href="/note/assets/js/156.9f399689.js"><link rel="prefetch" href="/note/assets/js/157.8356c091.js"><link rel="prefetch" href="/note/assets/js/158.491e4759.js"><link rel="prefetch" href="/note/assets/js/159.7e824edf.js"><link rel="prefetch" href="/note/assets/js/16.195c46b9.js"><link rel="prefetch" href="/note/assets/js/160.ebfa6e13.js"><link rel="prefetch" href="/note/assets/js/161.b10d8a2b.js"><link rel="prefetch" href="/note/assets/js/162.0e8759b0.js"><link rel="prefetch" href="/note/assets/js/163.b0b1cf93.js"><link rel="prefetch" href="/note/assets/js/164.913dc7a2.js"><link rel="prefetch" href="/note/assets/js/165.c3431ef6.js"><link rel="prefetch" href="/note/assets/js/166.3815cf06.js"><link rel="prefetch" href="/note/assets/js/167.1a353a89.js"><link rel="prefetch" href="/note/assets/js/168.ed8d779f.js"><link rel="prefetch" href="/note/assets/js/169.9e932e12.js"><link rel="prefetch" href="/note/assets/js/17.e45e5412.js"><link rel="prefetch" href="/note/assets/js/170.ac06e37e.js"><link rel="prefetch" href="/note/assets/js/171.1af3832f.js"><link rel="prefetch" href="/note/assets/js/172.bef5a0b2.js"><link rel="prefetch" href="/note/assets/js/173.d4eb4f14.js"><link rel="prefetch" href="/note/assets/js/174.c9bec92a.js"><link rel="prefetch" href="/note/assets/js/175.58e0a962.js"><link rel="prefetch" href="/note/assets/js/176.414ea867.js"><link rel="prefetch" href="/note/assets/js/177.dbf6a479.js"><link rel="prefetch" href="/note/assets/js/178.6db95738.js"><link rel="prefetch" href="/note/assets/js/179.c2c44fbe.js"><link rel="prefetch" href="/note/assets/js/18.c8587cdd.js"><link rel="prefetch" href="/note/assets/js/180.52e16637.js"><link rel="prefetch" href="/note/assets/js/181.4cd7897d.js"><link rel="prefetch" href="/note/assets/js/182.1e0e737a.js"><link rel="prefetch" href="/note/assets/js/183.eca3a12f.js"><link rel="prefetch" href="/note/assets/js/184.5137b000.js"><link rel="prefetch" href="/note/assets/js/185.e53915f7.js"><link rel="prefetch" href="/note/assets/js/186.11d571bd.js"><link rel="prefetch" href="/note/assets/js/187.a4620029.js"><link rel="prefetch" href="/note/assets/js/188.fab6af32.js"><link rel="prefetch" href="/note/assets/js/189.a943dbc6.js"><link rel="prefetch" href="/note/assets/js/19.9fd0af1e.js"><link rel="prefetch" href="/note/assets/js/190.8ccb173a.js"><link rel="prefetch" href="/note/assets/js/191.aff52d73.js"><link rel="prefetch" href="/note/assets/js/192.3f6d8dfa.js"><link rel="prefetch" href="/note/assets/js/193.c003b8ba.js"><link rel="prefetch" href="/note/assets/js/194.3db9ea97.js"><link rel="prefetch" href="/note/assets/js/2.80da3a23.js"><link rel="prefetch" href="/note/assets/js/20.78dbf000.js"><link rel="prefetch" href="/note/assets/js/21.9052af7c.js"><link rel="prefetch" href="/note/assets/js/22.2d931173.js"><link rel="prefetch" href="/note/assets/js/23.5f814f4f.js"><link rel="prefetch" href="/note/assets/js/24.29ec27e7.js"><link rel="prefetch" href="/note/assets/js/25.136f11d0.js"><link rel="prefetch" href="/note/assets/js/26.d2ddc965.js"><link rel="prefetch" href="/note/assets/js/27.b0a5fce7.js"><link rel="prefetch" href="/note/assets/js/28.b8969f2a.js"><link rel="prefetch" href="/note/assets/js/29.b8b1ea67.js"><link rel="prefetch" href="/note/assets/js/30.6e5148aa.js"><link rel="prefetch" href="/note/assets/js/31.cf52690a.js"><link rel="prefetch" href="/note/assets/js/32.5d666486.js"><link rel="prefetch" href="/note/assets/js/33.3e5103be.js"><link rel="prefetch" href="/note/assets/js/34.5cac675f.js"><link rel="prefetch" href="/note/assets/js/35.4f2df59a.js"><link rel="prefetch" href="/note/assets/js/36.1fd27f73.js"><link rel="prefetch" href="/note/assets/js/37.6ac6ed61.js"><link rel="prefetch" href="/note/assets/js/38.a4c40d46.js"><link rel="prefetch" href="/note/assets/js/39.84c4f7cb.js"><link rel="prefetch" href="/note/assets/js/4.31610149.js"><link rel="prefetch" href="/note/assets/js/40.973c9a4d.js"><link rel="prefetch" href="/note/assets/js/41.cd1c3a8e.js"><link rel="prefetch" href="/note/assets/js/42.52e2138b.js"><link rel="prefetch" href="/note/assets/js/43.bf504599.js"><link rel="prefetch" href="/note/assets/js/44.3f3bb78e.js"><link rel="prefetch" href="/note/assets/js/45.dc7d6363.js"><link rel="prefetch" href="/note/assets/js/46.c8fa4caf.js"><link rel="prefetch" href="/note/assets/js/47.64fae38a.js"><link rel="prefetch" href="/note/assets/js/48.bd90eb04.js"><link rel="prefetch" href="/note/assets/js/49.f82f8167.js"><link rel="prefetch" href="/note/assets/js/5.d4e41aea.js"><link rel="prefetch" href="/note/assets/js/50.686a71eb.js"><link rel="prefetch" href="/note/assets/js/51.1d6cc22c.js"><link rel="prefetch" href="/note/assets/js/52.1cdf855e.js"><link rel="prefetch" href="/note/assets/js/53.e767cbb0.js"><link rel="prefetch" href="/note/assets/js/54.58f91bd3.js"><link rel="prefetch" href="/note/assets/js/55.8fc9425a.js"><link rel="prefetch" href="/note/assets/js/56.cbf8f747.js"><link rel="prefetch" href="/note/assets/js/57.b8eb1cd5.js"><link rel="prefetch" href="/note/assets/js/58.7bf73d42.js"><link rel="prefetch" href="/note/assets/js/59.7aeecf27.js"><link rel="prefetch" href="/note/assets/js/6.b7490ff8.js"><link rel="prefetch" href="/note/assets/js/60.da52c44d.js"><link rel="prefetch" href="/note/assets/js/61.8df07801.js"><link rel="prefetch" href="/note/assets/js/62.4a2cd7a2.js"><link rel="prefetch" href="/note/assets/js/63.353a63f1.js"><link rel="prefetch" href="/note/assets/js/64.43078943.js"><link rel="prefetch" href="/note/assets/js/65.cf0edd22.js"><link rel="prefetch" href="/note/assets/js/66.6edd981e.js"><link rel="prefetch" href="/note/assets/js/67.67fc8d6b.js"><link rel="prefetch" href="/note/assets/js/68.b1e3ca66.js"><link rel="prefetch" href="/note/assets/js/69.be26bacd.js"><link rel="prefetch" href="/note/assets/js/70.67eb0587.js"><link rel="prefetch" href="/note/assets/js/71.d54e546d.js"><link rel="prefetch" href="/note/assets/js/72.cc8dc2a5.js"><link rel="prefetch" href="/note/assets/js/73.5cebb3fe.js"><link rel="prefetch" href="/note/assets/js/74.d90491cd.js"><link rel="prefetch" href="/note/assets/js/75.7f62f3eb.js"><link rel="prefetch" href="/note/assets/js/76.69a1ddf7.js"><link rel="prefetch" href="/note/assets/js/77.3f1d1601.js"><link rel="prefetch" href="/note/assets/js/78.b7d92ed6.js"><link rel="prefetch" href="/note/assets/js/79.f74a4426.js"><link rel="prefetch" href="/note/assets/js/8.6a7b9557.js"><link rel="prefetch" href="/note/assets/js/80.515c8539.js"><link rel="prefetch" href="/note/assets/js/81.65660d00.js"><link rel="prefetch" href="/note/assets/js/82.de097885.js"><link rel="prefetch" href="/note/assets/js/83.a6c1a929.js"><link rel="prefetch" href="/note/assets/js/84.7eb96cb9.js"><link rel="prefetch" href="/note/assets/js/85.f5d32c36.js"><link rel="prefetch" href="/note/assets/js/86.812ecf38.js"><link rel="prefetch" href="/note/assets/js/87.4c70321b.js"><link rel="prefetch" href="/note/assets/js/88.f05645f4.js"><link rel="prefetch" href="/note/assets/js/89.beaf544b.js"><link rel="prefetch" href="/note/assets/js/9.fc839187.js"><link rel="prefetch" href="/note/assets/js/90.b9e649d3.js"><link rel="prefetch" href="/note/assets/js/91.be28ba64.js"><link rel="prefetch" href="/note/assets/js/92.422cb56d.js"><link rel="prefetch" href="/note/assets/js/93.06a2ff37.js"><link rel="prefetch" href="/note/assets/js/94.2cbe2702.js"><link rel="prefetch" href="/note/assets/js/95.61af0f95.js"><link rel="prefetch" href="/note/assets/js/96.63b149c5.js"><link rel="prefetch" href="/note/assets/js/97.d3ba4573.js"><link rel="prefetch" href="/note/assets/js/98.b6b82e9c.js"><link rel="prefetch" href="/note/assets/js/99.94cb5a47.js">
    <link rel="stylesheet" href="/note/assets/css/0.styles.12c78510.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/note/" class="home-link router-link-active"><!----> <span class="site-name">note</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/note/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/note/css/css基础.html" class="nav-link">
  css 相关
</a></div><div class="nav-item"><a href="/note/javascript/知识体系.html" class="nav-link">
  javascript
</a></div><div class="nav-item"><a href="/note/js-patterns/代理模式.html" class="nav-link">
  js 设计模式
</a></div><div class="nav-item"><a href="/note/webpack/基础知识.html" class="nav-link">
  webpack
</a></div><div class="nav-item"><a href="/note/vue/相关笔记.html" class="nav-link">
  vue
</a></div><div class="nav-item"><a href="/note/react/react基础.html" class="nav-link">
  react 相关
</a></div><div class="nav-item"><a href="/note/angular/基础.html" class="nav-link">
  angular
</a></div><div class="nav-item"><a href="/note/http/HTTP协议基础.html" class="nav-link">
  http
</a></div><div class="nav-item"><a href="/note/node/基础知识.html" class="nav-link">
  node
</a></div><div class="nav-item"><a href="/note/typescript/typescript基础语法.html" class="nav-link">
  typescript
</a></div><div class="nav-item"><a href="/note/webgis/坐标系相关.html" class="nav-link">
  webgis
</a></div><div class="nav-item"><a href="/note/js-gc/数据类型.html" class="nav-link">
  红宝书
</a></div><div class="nav-item"><a href="/note/interview/forEach-forIn-forOf-map之间的区别.html" class="nav-link">
  interview
</a></div><div class="nav-item"><a href="/note/gisAlgorithm/数据结构-矢量.html" class="nav-link">
  gis 算法
</a></div><div class="nav-item"><a href="/note/graphics/图形学基础.html" class="nav-link">
  图形学相关
</a></div><div class="nav-item"><a href="/note/js-algorithm/栈.html" class="nav-link">
  算法与数据结构
</a></div><div class="nav-item"><a href="/note/PerformanceOptimization/指标以及工具.html" class="nav-link">
  性能优化
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/note/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/note/css/css基础.html" class="nav-link">
  css 相关
</a></div><div class="nav-item"><a href="/note/javascript/知识体系.html" class="nav-link">
  javascript
</a></div><div class="nav-item"><a href="/note/js-patterns/代理模式.html" class="nav-link">
  js 设计模式
</a></div><div class="nav-item"><a href="/note/webpack/基础知识.html" class="nav-link">
  webpack
</a></div><div class="nav-item"><a href="/note/vue/相关笔记.html" class="nav-link">
  vue
</a></div><div class="nav-item"><a href="/note/react/react基础.html" class="nav-link">
  react 相关
</a></div><div class="nav-item"><a href="/note/angular/基础.html" class="nav-link">
  angular
</a></div><div class="nav-item"><a href="/note/http/HTTP协议基础.html" class="nav-link">
  http
</a></div><div class="nav-item"><a href="/note/node/基础知识.html" class="nav-link">
  node
</a></div><div class="nav-item"><a href="/note/typescript/typescript基础语法.html" class="nav-link">
  typescript
</a></div><div class="nav-item"><a href="/note/webgis/坐标系相关.html" class="nav-link">
  webgis
</a></div><div class="nav-item"><a href="/note/js-gc/数据类型.html" class="nav-link">
  红宝书
</a></div><div class="nav-item"><a href="/note/interview/forEach-forIn-forOf-map之间的区别.html" class="nav-link">
  interview
</a></div><div class="nav-item"><a href="/note/gisAlgorithm/数据结构-矢量.html" class="nav-link">
  gis 算法
</a></div><div class="nav-item"><a href="/note/graphics/图形学基础.html" class="nav-link">
  图形学相关
</a></div><div class="nav-item"><a href="/note/js-algorithm/栈.html" class="nav-link">
  算法与数据结构
</a></div><div class="nav-item"><a href="/note/PerformanceOptimization/指标以及工具.html" class="nav-link">
  性能优化
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/note/javascript/知识体系.html" class="sidebar-link">知识体系</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/note/javascript/作用域跟闭包..html" class="sidebar-link">作用域跟闭包.</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/作用域跟闭包..html#作用域跟闭包" class="sidebar-link">作用域跟闭包</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/作用域跟闭包..html#作用域和自由变量" class="sidebar-link">作用域和自由变量</a></li><li class="sidebar-sub-header"><a href="/note/javascript/作用域跟闭包..html#闭包" class="sidebar-link">闭包</a></li><li class="sidebar-sub-header"><a href="/note/javascript/作用域跟闭包..html#var-、let、const-区别" class="sidebar-link">var 、let、const 区别</a></li><li class="sidebar-sub-header"><a href="/note/javascript/作用域跟闭包..html#bind-、call、apply-的区别" class="sidebar-link">bind 、call、apply 的区别</a></li></ul></li></ul></li><li><a href="/note/javascript/值类型、引用类型、深拷贝.html" class="sidebar-link">值类型、引用类型、深拷贝</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/值类型、引用类型、深拷贝.html#值类型和引用类型" class="sidebar-link">值类型和引用类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/值类型、引用类型、深拷贝.html#常见的值类型" class="sidebar-link">常见的值类型</a></li><li class="sidebar-sub-header"><a href="/note/javascript/值类型、引用类型、深拷贝.html#常见的引用类型" class="sidebar-link">常见的引用类型</a></li><li class="sidebar-sub-header"><a href="/note/javascript/值类型、引用类型、深拷贝.html#typeof-能判断哪些类型" class="sidebar-link">typeof 能判断哪些类型</a></li><li class="sidebar-sub-header"><a href="/note/javascript/值类型、引用类型、深拷贝.html#深拷贝" class="sidebar-link">深拷贝</a></li></ul></li></ul></li><li><a href="/note/javascript/类型转换.html" class="sidebar-link">类型转换</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/类型转换.html#类型转换" class="sidebar-link">类型转换</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/类型转换.html#字符串拼接" class="sidebar-link">字符串拼接</a></li><li class="sidebar-sub-header"><a href="/note/javascript/类型转换.html#" class="sidebar-link">==</a></li><li class="sidebar-sub-header"><a href="/note/javascript/类型转换.html#if-语句和逻辑运算" class="sidebar-link">if 语句和逻辑运算</a></li></ul></li></ul></li><li><a href="/note/javascript/class、原型与原型链.html" class="sidebar-link">class、原型与原型链</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/class、原型与原型链.html#原型与原型链" class="sidebar-link">原型与原型链</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/class、原型与原型链.html#class" class="sidebar-link">class</a></li><li class="sidebar-sub-header"><a href="/note/javascript/class、原型与原型链.html#原型" class="sidebar-link">原型</a></li><li class="sidebar-sub-header"><a href="/note/javascript/class、原型与原型链.html#原型关系" class="sidebar-link">原型关系</a></li><li class="sidebar-sub-header"><a href="/note/javascript/class、原型与原型链.html#如何准确判断一个变量是不是数组" class="sidebar-link">如何准确判断一个变量是不是数组</a></li><li class="sidebar-sub-header"><a href="/note/javascript/class、原型与原型链.html#手写一个简易的-jquery-考虑插件和扩展性" class="sidebar-link">手写一个简易的 jQuery，考虑插件和扩展性</a></li><li class="sidebar-sub-header"><a href="/note/javascript/class、原型与原型链.html#class-的原型本质-怎么理解" class="sidebar-link">class 的原型本质，怎么理解</a></li></ul></li></ul></li><li><a href="/note/javascript/this.html" class="sidebar-link">this</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/this.html#this" class="sidebar-link">this</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/this.html#this-的确定" class="sidebar-link">this 的确定</a></li><li class="sidebar-sub-header"><a href="/note/javascript/this.html#手写-bind-函数" class="sidebar-link">手写 bind 函数</a></li><li class="sidebar-sub-header"><a href="/note/javascript/this.html#实例-创建-10-个-a-标签-点击的时候弹出来对应的序号" class="sidebar-link">实例：创建 10 个 a 标签，点击的时候弹出来对应的序号</a></li><li class="sidebar-sub-header"><a href="/note/javascript/this.html#this-指向" class="sidebar-link">this 指向</a></li><li class="sidebar-sub-header"><a href="/note/javascript/this.html#new-操作符" class="sidebar-link">new 操作符</a></li><li class="sidebar-sub-header"><a href="/note/javascript/this.html#this-优先级" class="sidebar-link">this 优先级</a></li><li class="sidebar-sub-header"><a href="/note/javascript/this.html#let、const" class="sidebar-link">let、const</a></li></ul></li></ul></li><li><a href="/note/javascript/同步跟异步.html" class="sidebar-link">同步跟异步</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/同步跟异步.html#异步和单线程" class="sidebar-link">异步和单线程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/同步跟异步.html#题目" class="sidebar-link">题目</a></li></ul></li></ul></li><li><a href="/note/javascript/es6.html" class="sidebar-link">es6</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#es6-新增内容" class="sidebar-link">es6 新增内容</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_1-变量" class="sidebar-link">1. 变量</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_2-箭头函数" class="sidebar-link">2. 箭头函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_2-1-优点" class="sidebar-link">2.1 优点：</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_2-2-箭头函数的局限性" class="sidebar-link">2.2 箭头函数的局限性：</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_3-es6-参数默认值" class="sidebar-link">3. ES6 参数默认值</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_4-模板字符串" class="sidebar-link">4. 模板字符串</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_5-对象解构" class="sidebar-link">5. 对象解构</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_6-数组解构" class="sidebar-link">6. 数组解构</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_7-for-of-用法" class="sidebar-link">7. for of 用法</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_8-array-from-array-of" class="sidebar-link">8. Array.from()  Array.of()</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_8-1-array-from" class="sidebar-link">8.1 Array.from()</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_8-2-array-of" class="sidebar-link">8.2 Array.of()</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_9-数组的其他方法" class="sidebar-link">9. 数组的其他方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_9-1-find" class="sidebar-link">9.1 .find()</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_9-2-findindex" class="sidebar-link">9.2 .findIndex()</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_9-3-some" class="sidebar-link">9.3 .some()</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_9-4-every" class="sidebar-link">9.4 .every()</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_10-剩余参数" class="sidebar-link">10. 剩余参数</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_11-扩展运算符" class="sidebar-link">11. 扩展运算符</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_12-对象的计算属性" class="sidebar-link">12. 对象的计算属性</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_13-es6-的-promise-对象" class="sidebar-link">13. ES6  的 Promise 对象</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_14-symbol" class="sidebar-link">14. Symbol</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#对象新增" class="sidebar-link">对象新增</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#深拷贝与浅拷贝" class="sidebar-link">深拷贝与浅拷贝</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#深拷贝" class="sidebar-link">深拷贝</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#浅拷贝" class="sidebar-link">浅拷贝</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_15-eslint" class="sidebar-link">15. ESLint</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_16-import-export" class="sidebar-link">16. import  export</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_17-使用-systemjs-进行打包" class="sidebar-link">17. 使用 SystemJS 进行打包</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_18-class" class="sidebar-link">18. Class</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_18-1-class基本用法" class="sidebar-link">18.1 Class基本用法</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_18-2-class的扩展" class="sidebar-link">18.2 Class的扩展</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_18-3-class-进行扩展内建对象" class="sidebar-link">18.3 Class 进行扩展内建对象</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_19-proxy" class="sidebar-link">19. Proxy</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#get-拦截操作" class="sidebar-link">get 拦截操作</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#set-拦截操作" class="sidebar-link">set 拦截操作</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#has-拦截-in-操作符-拦截操作" class="sidebar-link">has (拦截 in 操作符) 拦截操作</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#ownkeys-拦截操作" class="sidebar-link">ownKeys 拦截操作</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#deleteproperty-拦截操作" class="sidebar-link">deleteProperty 拦截操作</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#apply-拦截操作" class="sidebar-link">apply 拦截操作</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#construct-拦截操作" class="sidebar-link">construct 拦截操作</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_20-set" class="sidebar-link">20. Set</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#基本用法" class="sidebar-link">基本用法</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#应用" class="sidebar-link">应用</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_21-map" class="sidebar-link">21. Map</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_22-函数的参数" class="sidebar-link">22. 函数的参数</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_23-字符串的扩展" class="sidebar-link">23. 字符串的扩展</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#unicode-表示法" class="sidebar-link">Unicode 表示法</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#字符串的遍历器接口" class="sidebar-link">字符串的遍历器接口</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#带标签的模板字符串" class="sidebar-link">带标签的模板字符串</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#扩展方法" class="sidebar-link">扩展方法</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#_24-正则表达式的扩展" class="sidebar-link">24. 正则表达式的扩展</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#y-修饰符-粘连修饰符" class="sidebar-link">y 修饰符（粘连修饰符）</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#u-修饰符" class="sidebar-link">u 修饰符</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#数值的扩展" class="sidebar-link">数值的扩展</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#进制转换" class="sidebar-link">进制转换</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#新增方法" class="sidebar-link">新增方法</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#math-扩展" class="sidebar-link">Math 扩展</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#reflect" class="sidebar-link">Reflect</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#设计目的" class="sidebar-link">设计目的</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#常用方法" class="sidebar-link">常用方法</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#generator" class="sidebar-link">Generator</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#yield-表达式" class="sidebar-link">yield 表达式</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#应用场景" class="sidebar-link">应用场景</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/es6.html#iterator" class="sidebar-link">Iterator</a></li></ul></li><li><a href="/note/javascript/es7-11.html" class="sidebar-link">es7-11</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#es7-11-新增内容" class="sidebar-link">ES7~11 新增内容</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#es7-相关" class="sidebar-link">ES7 相关</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#array-prototype-includes" class="sidebar-link">Array.prototype.includes()</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#幂运算符" class="sidebar-link">幂运算符**</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#es8-相关" class="sidebar-link">ES8 相关</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#async-await" class="sidebar-link">async / await</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#object-扩展" class="sidebar-link">Object 扩展</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#string-扩展" class="sidebar-link">String 扩展</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#尾逗号-trailing-commas" class="sidebar-link">尾逗号 Trailing commas</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#es9-相关" class="sidebar-link">ES9 相关</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#for-await-of" class="sidebar-link">for await of</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#regexp-updates-正则扩展" class="sidebar-link">RegExp Updates 正则扩展</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#object-rest-spread-对象扩展" class="sidebar-link">Object Rest &amp; Spread 对象扩展</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#promise-prototype-finally" class="sidebar-link">Promise.prototype.finally()</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#字符串扩展" class="sidebar-link">字符串扩展</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#es10-相关" class="sidebar-link">ES10 相关</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#object-fromentries" class="sidebar-link">Object.fromEntries()</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#string-扩展-2" class="sidebar-link">String 扩展</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#array-扩展" class="sidebar-link">Array 扩展</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#修订-function-prototype-tostring" class="sidebar-link">修订 Function.prototype.toString()</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#可选的-catch-binding" class="sidebar-link">可选的 Catch Binding</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#json-扩展" class="sidebar-link">JSON 扩展</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#symbol-扩展" class="sidebar-link">Symbol 扩展</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#es11-相关" class="sidebar-link">ES11 相关</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#string-扩展-3" class="sidebar-link">String 扩展</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#dynamic-import" class="sidebar-link">Dynamic Import</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#bigint" class="sidebar-link">BigInt</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#promise-allsettled" class="sidebar-link">Promise.allSettled()</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#globalthis" class="sidebar-link">globalThis</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#可选链-optional-chaining" class="sidebar-link">可选链 Optional chaining</a></li><li class="sidebar-sub-header"><a href="/note/javascript/es7-11.html#空值合并运算符-nullish-coalescing-operator" class="sidebar-link">空值合并运算符（Nullish coalescing Operator）</a></li></ul></li></ul></li><li><a href="/note/javascript/存储.html" class="sidebar-link">存储</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/存储.html#存储" class="sidebar-link">存储</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/存储.html#cookie" class="sidebar-link">cookie</a></li><li class="sidebar-sub-header"><a href="/note/javascript/存储.html#localstorage-和-sessionstorage" class="sidebar-link">localStorage 和 sessionStorage</a></li></ul></li></ul></li><li><a href="/note/javascript/事件.html" class="sidebar-link">事件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/事件.html#事件" class="sidebar-link">事件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/事件.html#事件绑定" class="sidebar-link">事件绑定</a></li><li class="sidebar-sub-header"><a href="/note/javascript/事件.html#事件冒泡" class="sidebar-link">事件冒泡</a></li><li class="sidebar-sub-header"><a href="/note/javascript/事件.html#事件代理" class="sidebar-link">事件代理</a></li></ul></li></ul></li><li><a href="/note/javascript/页面加载和渲染过程.html" class="sidebar-link">页面加载和渲染过程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/页面加载和渲染过程.html#页面加载和渲染过程" class="sidebar-link">页面加载和渲染过程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/页面加载和渲染过程.html#加载过程" class="sidebar-link">加载过程</a></li><li class="sidebar-sub-header"><a href="/note/javascript/页面加载和渲染过程.html#渲染过程" class="sidebar-link">渲染过程</a></li><li class="sidebar-sub-header"><a href="/note/javascript/页面加载和渲染过程.html#window-onload-和-domcontentloaded" class="sidebar-link">window.onload 和 DOMContentLoaded</a></li></ul></li></ul></li><li><a href="/note/javascript/性能优化.html" class="sidebar-link">性能优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/性能优化.html#性能优化" class="sidebar-link">性能优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/性能优化.html#性能优化原则" class="sidebar-link">性能优化原则</a></li><li class="sidebar-sub-header"><a href="/note/javascript/性能优化.html#让加载更快" class="sidebar-link">让加载更快</a></li><li class="sidebar-sub-header"><a href="/note/javascript/性能优化.html#让渲染更快" class="sidebar-link">让渲染更快</a></li></ul></li></ul></li><li><a href="/note/javascript/防抖节流.html" class="sidebar-link">防抖节流</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/防抖节流.html#防抖、节流" class="sidebar-link">防抖、节流</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/防抖节流.html#防抖-debounce" class="sidebar-link">防抖 debounce</a></li><li class="sidebar-sub-header"><a href="/note/javascript/防抖节流.html#节流-throttle" class="sidebar-link">节流 throttle</a></li></ul></li></ul></li><li><a href="/note/javascript/安全.html" class="sidebar-link">安全</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/安全.html#安全" class="sidebar-link">安全</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/安全.html#xss-攻击" class="sidebar-link">XSS 攻击</a></li><li class="sidebar-sub-header"><a href="/note/javascript/安全.html#xsrf-攻击" class="sidebar-link">XSRF 攻击</a></li></ul></li></ul></li><li><a href="/note/javascript/ajax.html" class="sidebar-link">ajax</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/ajax.html#ajax" class="sidebar-link">ajax</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/ajax.html#xmlhttprequest" class="sidebar-link">XMLHttpRequest</a></li><li class="sidebar-sub-header"><a href="/note/javascript/ajax.html#状态码" class="sidebar-link">状态码</a></li><li class="sidebar-sub-header"><a href="/note/javascript/ajax.html#跨域-同源策略-跨域解决方案" class="sidebar-link">跨域：同源策略，跨域解决方案</a></li><li class="sidebar-sub-header"><a href="/note/javascript/ajax.html#问题" class="sidebar-link">问题</a></li><li class="sidebar-sub-header"><a href="/note/javascript/ajax.html#git" class="sidebar-link">git</a></li></ul></li></ul></li><li><a href="/note/javascript/js-web-API.html" class="sidebar-link">js-web-API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/js-web-API.html#js-web-api" class="sidebar-link">JS Web API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/js-web-API.html#dom-节点操作" class="sidebar-link">DOM 节点操作</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js-web-API.html#dom-是哪种数据结构" class="sidebar-link">DOM 是哪种数据结构</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js-web-API.html#dom-操作的常用-api" class="sidebar-link">DOM 操作的常用 API</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js-web-API.html#attr-和-property-的区别" class="sidebar-link">attr 和 property 的区别</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js-web-API.html#dom-性能" class="sidebar-link">DOM 性能</a></li></ul></li></ul></li><li><a href="/note/javascript/linux.html" class="sidebar-link">linux</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/linux.html#linux-简单操作" class="sidebar-link">linux 简单操作</a></li></ul></li><li><a href="/note/javascript/基础面试题.html" class="sidebar-link">基础面试题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/基础面试题.html#js" class="sidebar-link">js</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/基础面试题.html#实现一个判断两个值是否相等" class="sidebar-link">实现一个判断两个值是否相等</a></li><li class="sidebar-sub-header"><a href="/note/javascript/基础面试题.html#数组的-pop-push-unshift-shift-分别是什么" class="sidebar-link">数组的 pop push unshift shift 分别是什么</a></li><li class="sidebar-sub-header"><a href="/note/javascript/基础面试题.html#数组的-api-有哪些是纯函数" class="sidebar-link">数组的 API 有哪些是纯函数</a></li><li class="sidebar-sub-header"><a href="/note/javascript/基础面试题.html#数组-slice-和-splice-区别" class="sidebar-link">数组 slice 和 splice 区别</a></li><li class="sidebar-sub-header"><a href="/note/javascript/基础面试题.html#_10-20-30-map-parseint" class="sidebar-link">[10, 20, 30].map(parseInt)</a></li><li class="sidebar-sub-header"><a href="/note/javascript/基础面试题.html#new-object-和-object-create-区别" class="sidebar-link">new Object() 和 Object.create 区别</a></li><li class="sidebar-sub-header"><a href="/note/javascript/基础面试题.html#手写字符串-trim-保证浏览器兼容性" class="sidebar-link">手写字符串 trim 保证浏览器兼容性</a></li><li class="sidebar-sub-header"><a href="/note/javascript/基础面试题.html#获取多个数字中的最大值" class="sidebar-link">获取多个数字中的最大值</a></li><li class="sidebar-sub-header"><a href="/note/javascript/基础面试题.html#如何捕获-js-中的异常" class="sidebar-link">如何捕获 JS 中的异常</a></li><li class="sidebar-sub-header"><a href="/note/javascript/基础面试题.html#获取当前页面-url-参数" class="sidebar-link">获取当前页面 url 参数</a></li><li class="sidebar-sub-header"><a href="/note/javascript/基础面试题.html#将-url-参数解析为-js-对象" class="sidebar-link">将 URL 参数解析为 JS 对象</a></li><li class="sidebar-sub-header"><a href="/note/javascript/基础面试题.html#手写-flatern-考虑多层级" class="sidebar-link">手写 flatern 考虑多层级</a></li><li class="sidebar-sub-header"><a href="/note/javascript/基础面试题.html#数组去重" class="sidebar-link">数组去重</a></li><li class="sidebar-sub-header"><a href="/note/javascript/基础面试题.html#深拷贝" class="sidebar-link">深拷贝</a></li><li class="sidebar-sub-header"><a href="/note/javascript/基础面试题.html#介绍-raf-requestanimationframe" class="sidebar-link">介绍 RAF requestAnimationFrame</a></li></ul></li></ul></li><li><a href="/note/javascript/前端笔记.html" class="sidebar-link">前端笔记</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_1-js-的对象" class="sidebar-link">1. JS 的对象</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_2-await-与-async" class="sidebar-link">2. await 与 async</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_3-js-数据" class="sidebar-link">3. JS 数据</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_4-js-知识" class="sidebar-link">4. JS 知识</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_4-1-基本类型" class="sidebar-link">4.1 基本类型：</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_4-2-typeof-与-instanceof" class="sidebar-link">4.2 typeof 与 instanceof</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_4-3-for-of-for-in-和-foreach-map-的区别" class="sidebar-link">4.3  for of，for in 和 forEach，map 的区别</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_4-4-箭头函数" class="sidebar-link">4.4  箭头函数</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_4-5-词法作用域" class="sidebar-link">4.5 词法作用域</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_4-6-call与apply、bind-函数" class="sidebar-link">4.6 call与apply、bind 函数</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_4-7-this的指向" class="sidebar-link">4.7 this的指向</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_4-8-promise" class="sidebar-link">4.8 Promise</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_4-9-async-await" class="sidebar-link">4.9 async/await</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_4-10-作用域" class="sidebar-link">4.10 作用域</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_4-11-this指向" class="sidebar-link">4.11 this指向</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_4-12-闭包-closure" class="sidebar-link">4.12 闭包(closure)</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_4-13-原型链" class="sidebar-link">4.13 原型链</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_4-14-几种继承方式" class="sidebar-link">4.14 几种继承方式</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_4-15-js-的暂时性死区" class="sidebar-link">4.15 js 的暂时性死区</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_4-16-es6-中的-map-对象跟原生的对象之间的区别" class="sidebar-link">4.16 ES6 中的 map 对象跟原生的对象之间的区别</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_4-17-es6-中的-set-对象" class="sidebar-link">4.17 ES6 中的 Set 对象</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_4-18-事件的捕获与冒泡" class="sidebar-link">4.18 事件的捕获与冒泡</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_4-19-数组与对象的深拷贝" class="sidebar-link">4.19 数组与对象的深拷贝</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_4-12-实现队列与堆栈" class="sidebar-link">4.12 实现队列与堆栈</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_5-vue相关" class="sidebar-link">5. vue相关</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_5-1-vue-cli" class="sidebar-link">5.1 vue-cli</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_5-2-vue-router-中-hash-模式与-history-模式的对比" class="sidebar-link">5.2 vue-router 中 hash 模式与 history 模式的对比</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_5-3-组件之间的调用" class="sidebar-link">5.3 组件之间的调用</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_5-4-对mvvm的理解" class="sidebar-link">5.4 对MVVM的理解</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_5-5-vue等单页面应用及优缺点" class="sidebar-link">5.5 vue等单页面应用及优缺点</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_5-6-route和router的区别" class="sidebar-link">5.6 route和router的区别</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_5-7-vue-router的routes中name属性作用详解" class="sidebar-link">5.7 vue-router的routes中name属性作用详解</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_5-8-vue的声明周期" class="sidebar-link">5.8 vue的声明周期</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_5-9-vue如何自定义一个过滤器" class="sidebar-link">5.9 vue如何自定义一个过滤器</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_5-10-computed和watch区别" class="sidebar-link">5.10 computed和watch区别</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_5-11-extend能做什么" class="sidebar-link">5.11 extend能做什么</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_5-12-mixin和mixins区别" class="sidebar-link">5.12 mixin和mixins区别</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_5-13-如何使用vue-nexttick" class="sidebar-link">5.13 如何使用vue.nextTick()</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_5-14-transition-过渡的实现原理" class="sidebar-link">5.14 transition 过渡的实现原理</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_5-15-非父子组件通讯" class="sidebar-link">5.15 非父子组件通讯</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_5-16-vue-router" class="sidebar-link">5.16 vue-Router</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_5-17-vuex中的mapstate、mapmutation、mapactions" class="sidebar-link">5.17 vuex中的mapState、mapMutation、mapActions</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_5-18-vue的双向数据绑定原理的理解" class="sidebar-link">5.18 vue的双向数据绑定原理的理解</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_6-数据结构" class="sidebar-link">6. 数据结构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_6-1-数组与链表的区别" class="sidebar-link">6.1 数组与链表的区别</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_6-2-堆与栈" class="sidebar-link">6.2 堆与栈</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_7-其他" class="sidebar-link">7. 其他</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_7-1-es5-实现定义常量" class="sidebar-link">7.1 es5 实现定义常量</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_7-3-javascript实现前端路由" class="sidebar-link">7.3 JavaScript实现前端路由</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_7-2-const-声明的变量不可以改变-声明的对象属性为何可以改变" class="sidebar-link">7.2 const 声明的变量不可以改变，声明的对象属性为何可以改变</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_7-3-jquery-与-vue之间的对比" class="sidebar-link">7.3 jQuery 与 vue之间的对比</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_7-4-从输入url到看到页面发生的全过程" class="sidebar-link">7.4 从输入URL到看到页面发生的全过程</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_7-5-三次握手-四次挥手" class="sidebar-link">7.5 三次握手，四次挥手</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_7-6-数组去重" class="sidebar-link">7.6 数组去重</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_7-8-原生js无缝滚动效果的简单实现" class="sidebar-link">7.8 原生Js无缝滚动效果的简单实现</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_7-9-如何实现一个弹幕" class="sidebar-link">7.9 如何实现一个弹幕</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_7-10-js数组的堆与栈实现" class="sidebar-link">7.10 js数组的堆与栈实现</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_7-11-4-如果有成千上万个菜单-如何绑定点击事件" class="sidebar-link">7.11 4. 如果有成千上万个菜单，如何绑定点击事件</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_8-css-相关" class="sidebar-link">8 css 相关</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_8-1-实现元素的水平垂直居中" class="sidebar-link">8.1 实现元素的水平垂直居中</a></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_8-2-用伪类清除浮动" class="sidebar-link">8.2 用伪类清除浮动</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/前端笔记.html#_9-git" class="sidebar-link">9 git</a></li></ul></li><li><a href="/note/javascript/事件执行机制.html" class="sidebar-link">事件执行机制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/事件执行机制.html#javascript-事件执行机制" class="sidebar-link">JavaScript 事件执行机制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/事件执行机制.html#javascript-事件循环" class="sidebar-link">JavaScript 事件循环</a></li><li class="sidebar-sub-header"><a href="/note/javascript/事件执行机制.html#settimeout" class="sidebar-link">setTimeout</a></li><li class="sidebar-sub-header"><a href="/note/javascript/事件执行机制.html#setinterval" class="sidebar-link">setInterval</a></li><li class="sidebar-sub-header"><a href="/note/javascript/事件执行机制.html#promise-与-process-nexttick-callback" class="sidebar-link">Promise 与 process.nextTick(callback)</a></li><li class="sidebar-sub-header"><a href="/note/javascript/事件执行机制.html#总结" class="sidebar-link">总结</a></li></ul></li></ul></li><li><a href="/note/javascript/资源合并与压缩.html" class="sidebar-link">资源合并与压缩</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/资源合并与压缩.html#http-请求的过程以及潜在的性能优化" class="sidebar-link">http 请求的过程以及潜在的性能优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/资源合并与压缩.html#html-压缩" class="sidebar-link">HTML 压缩</a></li><li class="sidebar-sub-header"><a href="/note/javascript/资源合并与压缩.html#css-压缩" class="sidebar-link">css 压缩</a></li><li class="sidebar-sub-header"><a href="/note/javascript/资源合并与压缩.html#js-压缩与混乱" class="sidebar-link">js 压缩与混乱</a></li><li class="sidebar-sub-header"><a href="/note/javascript/资源合并与压缩.html#文件合并" class="sidebar-link">文件合并</a></li></ul></li></ul></li><li><a href="/note/javascript/几种循环.html" class="sidebar-link">几种循环</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/几种循环.html#for、foreach、for-of" class="sidebar-link">for、forEach、for ...of</a></li><li class="sidebar-sub-header"><a href="/note/javascript/几种循环.html#some、every" class="sidebar-link">some、every</a></li><li class="sidebar-sub-header"><a href="/note/javascript/几种循环.html#filter、map" class="sidebar-link">filter、map</a></li><li class="sidebar-sub-header"><a href="/note/javascript/几种循环.html#find、findindex" class="sidebar-link">find、findIndex</a></li><li class="sidebar-sub-header"><a href="/note/javascript/几种循环.html#reduce、reduceright" class="sidebar-link">reduce、reduceRight</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/几种循环.html#计算对象数组某一属性的总和" class="sidebar-link">计算对象数组某一属性的总和</a></li><li class="sidebar-sub-header"><a href="/note/javascript/几种循环.html#对象数组的去重-并统计每一项重复次数" class="sidebar-link">对象数组的去重，并统计每一项重复次数</a></li><li class="sidebar-sub-header"><a href="/note/javascript/几种循环.html#对象数组最大-最小值获取" class="sidebar-link">对象数组最大/最小值获取</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/几种循环.html#性能对比" class="sidebar-link">性能对比</a></li><li class="sidebar-sub-header"><a href="/note/javascript/几种循环.html#对象属性遍历" class="sidebar-link">对象属性遍历</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/几种循环.html#for-in" class="sidebar-link">for in</a></li><li class="sidebar-sub-header"><a href="/note/javascript/几种循环.html#object-keys" class="sidebar-link">Object.keys</a></li><li class="sidebar-sub-header"><a href="/note/javascript/几种循环.html#object-values" class="sidebar-link">Object.values</a></li><li class="sidebar-sub-header"><a href="/note/javascript/几种循环.html#object-entries" class="sidebar-link">Object.entries</a></li><li class="sidebar-sub-header"><a href="/note/javascript/几种循环.html#object-getownpropertynames" class="sidebar-link">Object.getOwnPropertyNames</a></li></ul></li></ul></li><li><a href="/note/javascript/js相关面试.html" class="active sidebar-link">js相关面试</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#js-运行机制" class="sidebar-link">js 运行机制</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#闭包是什么-有什么应用场景" class="sidebar-link">闭包是什么，有什么应用场景</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#闭包是什么" class="sidebar-link">闭包是什么</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#闭包的应用场景" class="sidebar-link">闭包的应用场景</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#什么是发布订阅模式" class="sidebar-link">什么是发布订阅模式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#观察者模式" class="sidebar-link">观察者模式</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#发布订阅模式" class="sidebar-link">发布订阅模式</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#如何解决跨域" class="sidebar-link">如何解决跨域</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#jsonp-跨域" class="sidebar-link">JSONP 跨域</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#跨域资源共享-cors" class="sidebar-link">跨域资源共享（CORS）</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#nginx-代理跨域" class="sidebar-link">nginx 代理跨域</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#document-domain-iframe-跨域" class="sidebar-link">document.domain + iframe 跨域</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#websocket-协议跨域" class="sidebar-link">WebSocket 协议跨域</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#浏览器的缓存策略" class="sidebar-link">浏览器的缓存策略</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#缓存位置" class="sidebar-link">缓存位置</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#service-worker" class="sidebar-link">Service Worker</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#memory-cache" class="sidebar-link">Memory Cache</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#disk-cache" class="sidebar-link">Disk Cache</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#push-cache" class="sidebar-link">Push Cache</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#http-缓存机制" class="sidebar-link">HTTP 缓存机制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#缓存的过程" class="sidebar-link">缓存的过程</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#强制缓存" class="sidebar-link">强制缓存</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#协商缓存" class="sidebar-link">协商缓存</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#总结" class="sidebar-link">总结</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#输入-url-后发生了什么" class="sidebar-link">输入 URL 后发生了什么</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#怎么模拟一个队列-有多少种方式" class="sidebar-link">怎么模拟一个队列，有多少种方式</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#实现一个-js-的反向链表" class="sidebar-link">实现一个 js 的反向链表</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#如果有一个列表非常长-分页后怎么做才能使得占据的内存最小" class="sidebar-link">如果有一个列表非常长，分页后怎么做才能使得占据的内存最小</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#this-的理解" class="sidebar-link">this 的理解</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#amd-cmd、commonjs-和-es6-的-esmodule-的区别" class="sidebar-link">AMD，CMD、CommonJS 和 es6 的 esmodule 的区别</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#amd-requirejs" class="sidebar-link">AMD (requireJS)</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#cmd-seajs" class="sidebar-link">CMD (SeaJS)</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#commonjs" class="sidebar-link">CommonJS</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#es6-module" class="sidebar-link">ES6 Module</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#总结-2" class="sidebar-link">总结</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#commonjs-和-es6-module-的区别" class="sidebar-link">Commonjs 和 es6 module 的区别</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#原型链和原型" class="sidebar-link">原型链和原型</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#怎么实现一个-new" class="sidebar-link">怎么实现一个 new</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#localstorage-和-sessionstorage-和-cookie" class="sidebar-link">localstorage 和 sessionstorage 和 cookie</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#使用方式" class="sidebar-link">使用方式</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#三者的异同" class="sidebar-link">三者的异同</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#能设置或读取子域的-cookie-吗" class="sidebar-link">能设置或读取子域的 cookie 吗?</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#同域-跨域-ajax-请求到底会不会带上-cookie" class="sidebar-link">同域/跨域 ajax 请求到底会不会带上 cookie?</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#纯-js-怎么实现当你需要一个-js-的时候再去加载" class="sidebar-link">纯 js 怎么实现当你需要一个 js 的时候再去加载</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#ts-的理解-优点和缺点" class="sidebar-link">ts 的理解，优点和缺点</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#泛型和接口的区别" class="sidebar-link">泛型和接口的区别</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#移动端适配方案有哪几种" class="sidebar-link">移动端适配方案有哪几种</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#async-await-和-promise-之间优缺点" class="sidebar-link">async await 和 promise 之间优缺点</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#async-await-优点" class="sidebar-link">async/await 优点</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#async-await-缺点" class="sidebar-link">async/await 缺点</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#promise-的一些问题" class="sidebar-link">promise 的一些问题</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#es6-中新增内容-symbol、proxy、object-is-、in、object-assign" class="sidebar-link">es6 中新增内容，symbol、proxy、Object.is(===)、in、Object.assign</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#object-is-与-区别" class="sidebar-link">Object.is 与 === 区别</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#in-运算符" class="sidebar-link">in 运算符</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#如何去重" class="sidebar-link">如何去重</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#双重循环" class="sidebar-link">双重循环</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#array-prototype-indexof" class="sidebar-link">Array.prototype.indexOf()</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#array-prototype-sort" class="sidebar-link">Array.prototype.sort()</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#array-prototype-includes" class="sidebar-link">Array.prototype.includes()</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#array-prototype-reduce" class="sidebar-link">Array.prototype.reduce()</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#set" class="sidebar-link">Set</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#map" class="sidebar-link">Map</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#map、for-in、for-of、filter-等等区别" class="sidebar-link">map、for in、for of、filter 等等区别</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#深拷贝、浅拷贝、遇到循环引用如何处理" class="sidebar-link">深拷贝、浅拷贝、遇到循环引用如何处理</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#原型链、继承、作用域" class="sidebar-link">原型链、继承、作用域</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#async-await-执行顺序" class="sidebar-link">async/await 执行顺序</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#前端性能优化" class="sidebar-link">前端性能优化</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#fetch-api" class="sidebar-link">fetch api</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#dom-操作如何优化" class="sidebar-link">dom 操作如何优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#减少在循环内进行-dom-操作-在循环外部进行-dom-缓存" class="sidebar-link">减少在循环内进行 DOM 操作，在循环外部进行 DOM 缓存</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#操作-dom-前-先把-dom-节点删除或隐藏" class="sidebar-link">操作 DOM 前，先把 DOM 节点删除或隐藏</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#最小化重绘和重排" class="sidebar-link">最小化重绘和重排</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#减少访问" class="sidebar-link">减少访问</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#改变选择器" class="sidebar-link">改变选择器</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#事件委托" class="sidebar-link">事件委托</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#documentfragment" class="sidebar-link">DocumentFragment</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#如何计算首屏时间以及优化" class="sidebar-link">如何计算首屏时间以及优化</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#script-中-async-以及-defer" class="sidebar-link">script 中 async 以及 defer</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#普通的-script-加载" class="sidebar-link">普通的 script 加载</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#defer-延迟脚本" class="sidebar-link">defer 延迟脚本</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#async-异步脚本" class="sidebar-link">async 异步脚本</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#总结-3" class="sidebar-link">总结</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#includes-与-indexof" class="sidebar-link">includes 与 indexOf</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#slice-与-splice-之前的区别" class="sidebar-link">slice 与 splice 之前的区别</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#slice" class="sidebar-link">slice</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#splice" class="sidebar-link">splice</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#扩展运算符" class="sidebar-link">扩展运算符</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#使用扩展运算符可以快速扁平化二维数组" class="sidebar-link">使用扩展运算符可以快速扁平化二维数组</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#indexdb" class="sidebar-link">indexDB</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#创建一个-indexeddb-数据库" class="sidebar-link">创建一个 indexedDB 数据库</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#创建一个对象仓库" class="sidebar-link">创建一个对象仓库</a></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#操作数据" class="sidebar-link">操作数据</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/js相关面试.html#javascript-空值合并操作符" class="sidebar-link">javaScript 空值合并操作符</a></li></ul></li><li><a href="/note/javascript/css面试.html" class="sidebar-link">css面试</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/css面试.html#span-标签设置-inline-block-后加-width-和-height-能起作用么-加-padding-和-margin-呢" class="sidebar-link">span 标签设置 inline-block 后加 width 和 height 能起作用么，加 padding 和 margin 呢</a></li><li class="sidebar-sub-header"><a href="/note/javascript/css面试.html#visible、display-none、opacity-之间的区别" class="sidebar-link">visible、display:none、opacity 之间的区别</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/css面试.html#display-none" class="sidebar-link">display: none</a></li><li class="sidebar-sub-header"><a href="/note/javascript/css面试.html#visibility-hidden" class="sidebar-link">visibility: hidden</a></li><li class="sidebar-sub-header"><a href="/note/javascript/css面试.html#opacity-0" class="sidebar-link">opacity: 0</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/css面试.html#盒子模型" class="sidebar-link">盒子模型</a></li><li class="sidebar-sub-header"><a href="/note/javascript/css面试.html#flex-以及如何实现响应式布局" class="sidebar-link">flex 以及如何实现响应式布局</a></li><li class="sidebar-sub-header"><a href="/note/javascript/css面试.html#清除浮动" class="sidebar-link">清除浮动</a></li><li class="sidebar-sub-header"><a href="/note/javascript/css面试.html#垂直居中布局" class="sidebar-link">垂直居中布局</a></li><li class="sidebar-sub-header"><a href="/note/javascript/css面试.html#css-动画" class="sidebar-link">css 动画</a></li><li class="sidebar-sub-header"><a href="/note/javascript/css面试.html#css-选择器" class="sidebar-link">css 选择器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/css面试.html#选择器语法" class="sidebar-link">选择器语法</a></li><li class="sidebar-sub-header"><a href="/note/javascript/css面试.html#选择器优先级" class="sidebar-link">选择器优先级</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/css面试.html#重绘和重排" class="sidebar-link">重绘和重排</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/css面试.html#导致页面重排的一些操作" class="sidebar-link">导致页面重排的一些操作</a></li><li class="sidebar-sub-header"><a href="/note/javascript/css面试.html#导致页面重绘的操作" class="sidebar-link">导致页面重绘的操作</a></li><li class="sidebar-sub-header"><a href="/note/javascript/css面试.html#浏览器分析" class="sidebar-link">浏览器分析</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/css面试.html#css-有哪些属性是可以继承的" class="sidebar-link">css 有哪些属性是可以继承的</a></li></ul></li><li><a href="/note/javascript/vue相关面试.html" class="sidebar-link">vue相关面试</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#谈谈-vue3-的-ref-和-reactive" class="sidebar-link">谈谈 vue3 的 ref 和 reactive</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#vue-的组件传值如何实现" class="sidebar-link">vue 的组件传值如何实现</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#vue-的响应式原理" class="sidebar-link">vue 的响应式原理</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#event-bus-如何实现" class="sidebar-link">event bus 如何实现</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#vue-声明周期做的事情" class="sidebar-link">vue 声明周期做的事情</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#beforecreate" class="sidebar-link">beforeCreate</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#created" class="sidebar-link">created</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#beforemount" class="sidebar-link">beforeMount</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#mounted" class="sidebar-link">mounted</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#beforeupdate" class="sidebar-link">beforeUpdate</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#updated" class="sidebar-link">updated</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#beforedestroy" class="sidebar-link">beforeDestroy</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#destroyed" class="sidebar-link">destroyed</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#provide-inject-实现响应式数据更新" class="sidebar-link">provide/inject 实现响应式数据更新</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#vue-如何实现-v-model" class="sidebar-link">vue 如何实现 v-model</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#什么是虚拟-dom" class="sidebar-link">什么是虚拟 DOM</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#vuex-实现原理以及使用" class="sidebar-link">vuex 实现原理以及使用</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#vuex-如何实现持久性存储" class="sidebar-link">vuex 如何实现持久性存储</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#v-if、v-show-实现原理" class="sidebar-link">v-if、v-show 实现原理；</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#vue-router-的实现原理-各个模式" class="sidebar-link">vue-router 的实现原理；各个模式</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#nexttrick-如何实现" class="sidebar-link">nexttrick 如何实现</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#vue-整个数据更新流程" class="sidebar-link">vue 整个数据更新流程；</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#object-defineproperty-注意。对数组有什么影响-vue2-为何不使用-proxy-api" class="sidebar-link">object.defineproperty 注意。对数组有什么影响，vue2 为何不使用；proxy API；</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#更新策略。以及虚拟-dom-等" class="sidebar-link">更新策略。以及虚拟 dom 等</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#与-react-相比-数据流向以及更新策略有何不同" class="sidebar-link">与 react 相比，数据流向以及更新策略有何不同</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#vue-中父组件能否监听子组件的生命周期" class="sidebar-link">Vue 中父组件能否监听子组件的生命周期</a></li><li class="sidebar-sub-header"><a href="/note/javascript/vue相关面试.html#vue-父组件与子组件声明周期的执行顺序" class="sidebar-link">Vue 父组件与子组件声明周期的执行顺序</a></li></ul></li><li><a href="/note/javascript/react相关面试.html" class="sidebar-link">react相关面试</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/react相关面试.html#react-的-key-值为什么那么重要-新版本-diff-是偏向算法还是策略-具体是怎么样的" class="sidebar-link">react 的 key 值为什么那么重要，新版本 diff 是偏向算法还是策略，具体是怎么样的</a></li><li class="sidebar-sub-header"><a href="/note/javascript/react相关面试.html#react16-新特性分别有什么-起什么作用" class="sidebar-link">react16 新特性分别有什么，起什么作用</a></li><li class="sidebar-sub-header"><a href="/note/javascript/react相关面试.html#react-之前可以怎么进行state的监听-排除-useeffect-的依赖监听" class="sidebar-link">react 之前可以怎么进行state的监听（排除 useEffect 的依赖监听）</a></li><li class="sidebar-sub-header"><a href="/note/javascript/react相关面试.html#react-hooks-和高阶组件的理解" class="sidebar-link">react hooks 和高阶组件的理解</a></li><li class="sidebar-sub-header"><a href="/note/javascript/react相关面试.html#针对-react-有什么优化方案" class="sidebar-link">针对 react 有什么优化方案</a></li><li class="sidebar-sub-header"><a href="/note/javascript/react相关面试.html#除了-react-官方和-webpack-的优化-还有什么优化方案或者是注意要点" class="sidebar-link">除了 react 官方和 webpack 的优化，还有什么优化方案或者是注意要点</a></li><li class="sidebar-sub-header"><a href="/note/javascript/react相关面试.html#react-hooks-为什么不能在条件语句里面书写" class="sidebar-link">react hooks 为什么不能在条件语句里面书写</a></li><li class="sidebar-sub-header"><a href="/note/javascript/react相关面试.html#react-页面为何要引入-react" class="sidebar-link">react 页面为何要引入 react</a></li><li class="sidebar-sub-header"><a href="/note/javascript/react相关面试.html#setstate-为何存在异步" class="sidebar-link">setState 为何存在异步</a></li><li class="sidebar-sub-header"><a href="/note/javascript/react相关面试.html#react-优化" class="sidebar-link">react 优化</a></li><li class="sidebar-sub-header"><a href="/note/javascript/react相关面试.html#react-class-组件与-function-组件之间区别" class="sidebar-link">react class 组件与 function 组件之间区别</a></li><li class="sidebar-sub-header"><a href="/note/javascript/react相关面试.html#react-加入-hooks-的意义是什么-或者说一下为什么-react-要加入hooks-这一特性-最后举例说一下-hooks-的基本实现原理" class="sidebar-link">React 加入 Hooks 的意义是什么？或者说一下为什么 React 要加入Hooks 这一特性？最后举例说一下 Hooks 的基本实现原理；</a></li><li class="sidebar-sub-header"><a href="/note/javascript/react相关面试.html#hook-的基本用法" class="sidebar-link">hook 的基本用法</a></li><li class="sidebar-sub-header"><a href="/note/javascript/react相关面试.html#react-何时清除-effect" class="sidebar-link">React 何时清除 effect？</a></li></ul></li><li><a href="/note/javascript/node_http_webpack相关.html" class="sidebar-link">node_http_webpack相关</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/node_http_webpack相关.html#webpack" class="sidebar-link">webpack</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/node_http_webpack相关.html#基本配置" class="sidebar-link">基本配置</a></li><li class="sidebar-sub-header"><a href="/note/javascript/node_http_webpack相关.html#webpack-有什么方案可以压缩体积和提高打包速度" class="sidebar-link">webpack 有什么方案可以压缩体积和提高打包速度</a></li><li class="sidebar-sub-header"><a href="/note/javascript/node_http_webpack相关.html#webpack-热更新原理" class="sidebar-link">webpack 热更新原理</a></li><li class="sidebar-sub-header"><a href="/note/javascript/node_http_webpack相关.html#webpack-如何实现跨域-domain、path-等设置" class="sidebar-link">webpack 如何实现跨域；domain、path 等设置</a></li><li class="sidebar-sub-header"><a href="/note/javascript/node_http_webpack相关.html#webpack-做过哪些优化" class="sidebar-link">webpack 做过哪些优化；</a></li><li class="sidebar-sub-header"><a href="/note/javascript/node_http_webpack相关.html#webpack-如何写一个-loader、plugin-等" class="sidebar-link">webpack 如何写一个 loader、plugin 等</a></li><li class="sidebar-sub-header"><a href="/note/javascript/node_http_webpack相关.html#webpack-打包原理" class="sidebar-link">webpack 打包原理</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/node_http_webpack相关.html#http" class="sidebar-link">http</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/node_http_webpack相关.html#_206-和-403-代表什么" class="sidebar-link">206 和 403 代表什么</a></li><li class="sidebar-sub-header"><a href="/note/javascript/node_http_webpack相关.html#http-相关-三次握手、四次挥手" class="sidebar-link">http 相关，三次握手、四次挥手</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/javascript/node_http_webpack相关.html#node" class="sidebar-link">node</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/javascript/node_http_webpack相关.html#express、koa2-之间的区别" class="sidebar-link">express、koa2 之间的区别</a></li><li class="sidebar-sub-header"><a href="/note/javascript/node_http_webpack相关.html#node-中间件实现、模块化" class="sidebar-link">node 中间件实现、模块化；</a></li></ul></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="js-运行机制"><a href="#js-运行机制" class="header-anchor">#</a> js 运行机制</h2> <p>参考：</p> <ol><li>https://juejin.cn/post/6844904050543034376#comment</li> <li>https://jiegiser.github.io/note/javascript/%E4%BA%8B%E4%BB%B6%E6%89%A7%E8%A1%8C%E6%9C%BA%E5%88%B6.html</li></ol> <h2 id="闭包是什么-有什么应用场景"><a href="#闭包是什么-有什么应用场景" class="header-anchor">#</a> 闭包是什么，有什么应用场景</h2> <h3 id="闭包是什么"><a href="#闭包是什么" class="header-anchor">#</a> 闭包是什么</h3> <p>其实在全局上下文中创建函数都会创建一个对应的闭包，存储了函数定义创建时作用域中的所有变量。只不过在全局作用域中创建的函数创建闭包，但是由于这些函数是在全局作用域中创建的，所以它们可以访问全局作用域中的所有变量，闭包的概念并不重要。</p> <p>当函数返回函数时，闭包的概念就变得更加重要了。返回的函数可以访问不属于全局作用域的变量，但它们仅存在于其闭包中。</p> <blockquote><p>参考：https://juejin.cn/post/6844903858636849159#comment</p></blockquote> <h3 id="闭包的应用场景"><a href="#闭包的应用场景" class="header-anchor">#</a> 闭包的应用场景</h3> <ol><li>模仿块级作用域</li></ol> <p>比如我们可以使用闭包能使下面的代码按照我们预期的进行执行（每隔 1s 打印 0,1,2,3,4）。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">j</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> j <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>私有变量</li></ol> <p>JavaScript 中没有私有成员的概念，所有属性都是公有的。但是有私有变量的概念，任何在函数中定义的变量，都可以认为是私有变量，因为在函数的外部不能访问这些变量。私有变量包括函数的参数，局部变量和函数内部定义的其他函数。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> counter <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">const</span> <span class="token function-variable function">myFunction</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    counter <span class="token operator">=</span> counter <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">return</span> counter
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> myFunction
<span class="token punctuation">}</span>
<span class="token keyword">const</span> increment <span class="token operator">=</span> <span class="token function">createCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> c1 <span class="token operator">=</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> c2 <span class="token operator">=</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> c3 <span class="token operator">=</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'example increment'</span><span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> c3<span class="token punctuation">)</span>
</code></pre></div><ol start="3"><li>静态私有变量</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token function-variable function">Person</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    name <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">setName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    name <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'xiaoming'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person1<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// xiaoming</span>
person1<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">'xiaohong'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person1<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// xiaohong</span>

<span class="token keyword">var</span> person2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'luckyStar'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person1<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// luckyStar</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person2<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// luckyStar</span>
</code></pre></div><p>上面代码通过一个匿名函数实现块级作用域，在块级作用域中 变量 name 只能在该作用域中访问，同样的通过闭包(作用域链)的方式实现 getName 和 setName 来访问 name, 而 getName 和 setName 又是原型对象的方法，所以它们成了 Person 实例的共享方法。
这种模式下，name 就变成了一个静态的、由所有实例共享的属性。在一个实例上调用 setName() 会影响所有的实例。</p> <ol start="4"><li>模块模式</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">singleton</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> privateVarible <span class="token operator">=</span> <span class="token number">10</span>
  <span class="token keyword">function</span> <span class="token function">privateFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    publicProperty<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token function-variable function">publicMethod</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      privateVarible<span class="token operator">++</span>
      <span class="token keyword">return</span> <span class="token function">privateFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="什么是发布订阅模式"><a href="#什么是发布订阅模式" class="header-anchor">#</a> 什么是发布订阅模式</h2> <p>说发布订阅模式之前，先看看观察者模式：</p> <h3 id="观察者模式"><a href="#观察者模式" class="header-anchor">#</a> 观察者模式</h3> <p>观察者模式说起来很简单，我们希望对一个目标进行 observe，当这个目标发生变化的时候告诉我们。其实这听上去和回调函数很像，其实回调函数就是一种特殊的观察者模式。真正的观察者模式需要是一对多的，被观察者 Subject 会管理一个观察者列表，当这个 Subject 发生某个变化的时候会通知观察者列表中的所有观察者。</p> <p>如下模拟代码：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 观察着</span>
<span class="token keyword">class</span> <span class="token class-name">Observer</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">update</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'val'</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">ObserverList</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observerList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>

  <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observerList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">remove</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observerList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>observerList<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">i</span> <span class="token operator">=&gt;</span> i<span class="token operator">!==</span> observer <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>observerList<span class="token punctuation">.</span>length
  <span class="token punctuation">}</span>

  <span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>observerList<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 目标</span>
<span class="token keyword">class</span> <span class="token class-name">Subject</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObserverList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">addObserver</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">removeObserver</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">notify</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> obCount <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> obCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> DouYu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Subject</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> zs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

DouYu<span class="token punctuation">.</span><span class="token function">addObserver</span><span class="token punctuation">(</span>zs<span class="token punctuation">)</span>
DouYu<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">122</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>这和我们经常使用的 DOM 事件模式完全相同。我们的 DOM 事件也就是一个观察者模式的实现。当我们为一个元素绑定事件的时候，我们就相当于进行了 Subscribe 订阅，成为了一个观察者。当对应的事件触发的时候，被观察的元素会通知我们，执行我们的回调函数（所谓的通知其实就是执行观察者中的对应方法，并不是真的发个通知）。我们也可以绑定多个 Observer，当事件触发的时候，所有的观察者都会被通知。DOM 提供了我们订阅 addEventListener，和取消订阅 removeEventListener 的 API。</p> <h3 id="发布订阅模式"><a href="#发布订阅模式" class="header-anchor">#</a> 发布订阅模式</h3> <p>有了观察者模式，为什么又要有发布订阅模式呢？观察者模式中，观察者和目标是依赖的，耦合性很强。</p> <p>我们可以想象一个场景，我们有多个目标要进行监听，但是这些目标事件触发后执行的逻辑其实是相同的，如果是使用观察者模式我们不得不对每一个目标都进行绑定，并且每一个目标都要事先一套上面 Subject 的逻辑。这样处理在系统越来越复杂的情况下代码的逻辑会非常混乱，也非常难以管理，并且有非常多冗余的部分。</p> <p>为了解决这个问题，就有了发布订阅模式。他们的本质都是一样的，都是对于未来会发生的事件进行一个监听，当事件发生了，通知监听的对象执行对应的方法。但是他们实现的逻辑不同。</p> <p>在发布订阅模式中，添加了一个事件通道，发布者和订阅者不在直接进行交互。所有的注册，解绑，发布都是通过 Event Channel 来实现的。也就是说我们把观察者模式中的逻辑抽象出来，形成了一个单独的模块。</p> <p>现在整个的逻辑大概是这样：我们不再是对某个对象进行监听，而是告诉 Event Channel，我想要注册一个名叫 type 的事件，当这个事件触发以后，请执行 fn 函数。事件中心将我的注册信息进行保存。当有一个模块想要执行订阅者的对应方法的时候，只要告诉 Event Channel，我想要触发 type 事件，并且传入参数 arg1, arg2 ...。Event Channel 就会找到对应事件对应的 fn 传入 arg1, arg2 ... 并执行。</p> <p>我们可以看到 Event Channel 就像一个消息中介，调度中心，它让发布者和订阅者之间完全解耦，它们甚至不知道对方的存在。我们将所有的订阅发布行为进行集中的管理，并且能够定制我们的订阅发布行为，让不同模块之间的通信业变得非常便捷。我们看下面的模拟实现发布订阅代码：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">PubSub</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>subscribers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> listeners <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>subscribers<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      listeners<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> listeners <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>subscribers<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>listeners <span class="token operator">||</span> <span class="token operator">!</span>listeners<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>subscribers<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">=</span> listeners<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> v <span class="token operator">!==</span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">publish</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> listeners <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>subscribers<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>listeners <span class="token operator">||</span> <span class="token operator">!</span>listeners<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      listeners<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fn</span> <span class="token operator">=&gt;</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> ob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PubSub</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ob<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token string">'add'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ob<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">'add'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>比较观察者模式和发布订阅模式的代码我们可以发现，观察者模式由具体目标调度，每个被订阅的目标里面都需要有对观察者的处理，会造成代码的冗余。而发布订阅模式则统一由调度中心处理，消除了发布者和订阅者之间的依赖。</p> <p>我们可以结合生活中的实例来帮助你理解，比如你周五想约朋友去吃饭，你不知道谁有空，按观察者模式的逻辑来说，你得给每个可能的朋友发条信息：<code>如果触发有空事件请给我打电话（注册）</code>，当朋友触发<code>有空</code>事件的时候，将会对你进行通知（执行<code>打电话</code>方法）。如果是订阅发布模式的话逻辑就是，你向<code>朋友圈</code>（这里相当于 Event Channel） 注册了一个事件，名字叫<code>有空</code>，方法是<code>打电话</code>，当有朋友想要参与聚会的时候，会告诉<code>朋友圈 （Event Channel）</code>，你要发布<code>有空</code>事件，参数是<code>185xxxxxxxx</code>，朋友圈用这个参数执行了<code>打电话</code>方法。</p> <ul><li>实现</li></ul> <p>正因为观察订阅模式的这种机制，它成了很多框架和库用来实现模块之间通信的方式。比如 Vue 的 Event(bus)，React 的 Event 模块，他们都用来实现非父子组件的通信。实际上几乎所有的模块通信都是基于类似的模式,包括安卓开发中的Event Bus，Node.js 中的 Event 模块( Node 中几乎所有的模块都依赖于 Event,包括不限于 http、stream、buffer、fs 等)。</p> <p>这一小节我们就仿照 NodeJS 的 Event API 实现一个简单的 Event 库。</p> <p>我们的大致需求是：实现一个 Emitter 类，该类能够实现事件的订阅，解绑，发布。事件的存储使用 Map。对于同一个类型的事件，支持多次绑定（即传入多个方法），当事件发布的时候，这些方法都将执行。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Emitter</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_event <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_event <span class="token operator">||</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>maxListeners <span class="token operator">=</span> <span class="token number">10</span>
  <span class="token punctuation">}</span>

  <span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> handler <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_event<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>handler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_event<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> fn<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>handler <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> handler <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_event<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> <span class="token punctuation">[</span>handler<span class="token punctuation">,</span> fn<span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        handler<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> handler <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_event<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>handler <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> handler <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>handler <span class="token operator">===</span> fn<span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_event<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> newHandler <span class="token operator">=</span> handler<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> v <span class="token operator">!==</span> fn<span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>newHandler<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_event<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> newHandler<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_event<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> newHandler<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">emit</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> handler <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_event<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>handler<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      handler<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fn</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">handler</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> emitter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Emitter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

emitter<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token parameter">obj</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>obj<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

emitter<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token parameter">obj</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">age is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>obj<span class="token punctuation">.</span>age<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

emitter<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token parameter">obj</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">sex is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>obj<span class="token punctuation">.</span>sex<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">site</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">site is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>obj<span class="token punctuation">.</span>site<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

emitter<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> site<span class="token punctuation">)</span>

emitter<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'jiegiser'</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
  sex<span class="token operator">:</span> <span class="token string">'male'</span><span class="token punctuation">,</span>
  site<span class="token operator">:</span> <span class="token string">'123.com'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

emitter<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> site<span class="token punctuation">)</span>

emitter<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'jiegiser'</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
  sex<span class="token operator">:</span> <span class="token string">'male'</span><span class="token punctuation">,</span>
  site<span class="token operator">:</span> <span class="token string">'123.com'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Emitter</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_event <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_event <span class="token operator">||</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>maxListeners <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> handler <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_event<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>handler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>_event<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> fn<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>handler <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> handler <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_event<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> <span class="token punctuation">[</span>handler<span class="token punctuation">,</span> fn<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                handler<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> handler <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_event<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>handler <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> handler <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>handler <span class="token operator">===</span> fn<span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_event<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> newHandler <span class="token operator">=</span> handler<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> v <span class="token operator">!==</span> fn<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>newHandler<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_event<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> newHandler<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_event<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> newHandler<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">emit</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> handler <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_event<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>handler<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            handler<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fn</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">handler</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> emitter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Emitter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

emitter<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token parameter">obj</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>obj<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

emitter<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token parameter">obj</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">age is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>obj<span class="token punctuation">.</span>age<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

emitter<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token parameter">obj</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">sex is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>obj<span class="token punctuation">.</span>sex<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">site</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">site is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>obj<span class="token punctuation">.</span>site<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

emitter<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> site<span class="token punctuation">)</span>

emitter<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'clloz'</span><span class="token punctuation">,</span>
    age<span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
    sex<span class="token operator">:</span> <span class="token string">'male'</span><span class="token punctuation">,</span>
    site<span class="token operator">:</span> <span class="token string">'clloz.com'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//name is clloz.</span>
<span class="token comment">//age is 28.</span>
<span class="token comment">//sex is male.</span>
<span class="token comment">//site is clloz.com</span>

emitter<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> site<span class="token punctuation">)</span>

emitter<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'clloz'</span><span class="token punctuation">,</span>
    age<span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
    sex<span class="token operator">:</span> <span class="token string">'male'</span><span class="token punctuation">,</span>
    site<span class="token operator">:</span> <span class="token string">'clloz.com'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//name is clloz.</span>
<span class="token comment">//age is 28.</span>
<span class="token comment">//sex is male.</span>

</code></pre></div><blockquote><p>参考：https://www.clloz.com/programming/front-end/js/2020/10/18/observer-pub-sub-pattern/</p></blockquote> <h2 id="如何解决跨域"><a href="#如何解决跨域" class="header-anchor">#</a> 如何解决跨域</h2> <ul><li>首先得知道什么是跨域：</li></ul> <p>在前端领域中，跨域是指浏览器允许向服务器发送跨域请求，从而克服 Ajax 只能同源使用的限制。</p> <ul><li>什么是同源策略</li></ul> <p>同源策略是一种约定，由 Netscape 公司 1995 年引入浏览器，它是浏览器最核心也最基本的安全功能，如果缺少了同源策略，浏览器很容易受到 XSS、CSFR 等攻击。所谓同源是指&quot;协议+域名+端口&quot;三者相同，即便两个不同的域名指向同一个 ip 地址，也非同源。域名和域名对应相同 ip 也是不行；</p> <p>同源策略限制以下几种行为：</p> <ul><li>Cookie、LocalStorage 和 IndexDB 无法读取</li> <li>DOM 和 JS 对象无法获得</li> <li>AJAX 请求不能发送</li></ul> <p>下面是几种跨域解决方法</p> <h3 id="jsonp-跨域"><a href="#jsonp-跨域" class="header-anchor">#</a> JSONP 跨域</h3> <p>jsonp 的原理就是利用<code>&lt;script&gt;</code>标签没有跨域限制，通过<code>&lt;script&gt;</code>标签 src 属性，发送带有 callback 参数的 GET 请求，服务端
将接口返回数据拼凑到 callback 函数中，返回给浏览器，浏览器解析执行，从而前端拿到 callback 函数返回的数据。</p> <p>原生 JS 实现:</p> <div class="language-html extra-class"><pre class="language-html"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">var</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span>
    script<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'text/javascript'</span>

    <span class="token comment">// 传参一个回调函数名给后端，方便后端返回时执行这个在前端定义的回调函数</span>
    script<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'http://www.domain2.com:8080/login?user=admin&amp;callback=handleCallback'</span>
    document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span>

    <span class="token comment">// 回调执行函数</span>
    <span class="token keyword">function</span> <span class="token function">handleCallback</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
 </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>服务端返回如下（返回时即执行全局函数）：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">handleCallback</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'success'</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">'user'</span><span class="token operator">:</span> <span class="token string">'admin'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>axios 实现：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$http <span class="token operator">=</span> axios
<span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">jsonp</span><span class="token punctuation">(</span><span class="token string">'http://www.domain2.com:8080/login'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  params<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  jsonp<span class="token operator">:</span> <span class="token string">'handleCallback'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><p>后端 node.js 代码：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> querystring <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'querystring'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'request'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> params <span class="token operator">=</span> querystring<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'?'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> fn <span class="token operator">=</span> params<span class="token punctuation">.</span>callback<span class="token punctuation">;</span>
  <span class="token comment">// jsonp 返回设置</span>
  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'text/javascript'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>fn <span class="token operator">+</span> <span class="token string">'('</span> <span class="token operator">+</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">')'</span><span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token string">'8080'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Server is running at port 8080...'</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>jsonp 的缺点：只能发送 get 一种请求。</p></blockquote> <h3 id="跨域资源共享-cors"><a href="#跨域资源共享-cors" class="header-anchor">#</a> 跨域资源共享（CORS）</h3> <p>CORS 是一个 W3C 标准，全称是&quot;跨域资源共享&quot;（Cross-origin resource sharing）。它允许浏览器向跨源服务器，发出XMLHttpRequest 请求，从而克服了 AJAX 只能同源使用的限制。CORS 需要浏览器和服务器同时支持。目前，所有浏览器都支持该功能，IE 浏览器不能低于 IE10。浏览器将 CORS 跨域请求分为简单请求和非简单请求。
只要同时满足以下两个条件，就属于简单请求：</p> <ol><li>使用下列方法之一：</li></ol> <ul><li>head</li> <li>get</li> <li>post</li></ul> <ol start="2"><li>请求的 Heder 是</li></ol> <ul><li>Accept</li> <li>Accept-Language</li> <li>Content-Language</li> <li>Content-Type: 只限于三个值：application/x-www-form-urlencoded、multipart/form-data、text/plain</li></ul> <blockquote><p>参考链接：https://juejin.cn/post/6844903882083024910</p></blockquote> <h4 id="简单请求"><a href="#简单请求" class="header-anchor">#</a> 简单请求</h4> <p>对于简单请求，浏览器直接发出 CORS 请求。具体来说，就是在头信息之中，增加一个 Origin 字段。</p> <div class="language-shell extra-class"><pre class="language-shell"><code>GET /cors HTTP/1.1
Origin: http://api.bob.com
Host: api.alice.com
Accept-Language: en-US
Connection: keep-alive
User-Agent: Mozilla/5.0<span class="token punctuation">..</span>.
</code></pre></div><p>上面的头信息中，Origin 字段用来说明，本次请求来自哪个源（协议 + 域名 + 端口）。服务器根据这个值，决定是否同意这次请求。</p> <p>CORS 请求设置的响应头字段，都以 Access-Control- 开头:</p> <ul><li>Access-Control-Allow-Origin：必选；它的值要么是请求时 Origin 字段的值，要么是一个 *，表示接受任意域名的请求。</li> <li>Access-Control-Allow-Credentials：可选；它的值是一个布尔值，表示是否允许发送 Cookie。默认情况下，Cookie 不包括在CORS 请求之中。设为 true，即表示服务器明确许可，Cookie 可以包含在请求中，一起发给服务器。这个值也只能设为 true，如果服务器不要浏览器发送 Cookie，删除该字段即可。</li> <li>Access-Control-Expose-Headers：可选；CORS 请求时，XMLHttpRequest 对象的 getResponseHeader() 方法只能拿到 6 个基本字段：Cache-Control、Content-Language、Content-Type、Expires、Last-Modified、Pragma。如果想拿到其他字段，就必须在Access-Control-Expose-Headers 里面指定。上面的例子指定，getResponseHeader('FooBar') 可以返回 FooBar 字段的值。</li></ul> <h4 id="非简单请求"><a href="#非简单请求" class="header-anchor">#</a> 非简单请求</h4> <p>非简单请求是那种对服务器有特殊要求的请求，比如请求方法是 PUT 或 DELETE，或者 Content-Type 字段的类型是 application/json。非简单请求的 CORS 请求，会在正式通信之前，增加一次 HTTP 查询请求，称为&quot;预检&quot;请求（preflight）。</p> <ul><li>预检请求</li></ul> <p>预检&quot;请求用的请求方法是 OPTIONS，表示这个请求是用来询问的。请求头信息里面，关键字段是 Origin，表示请求来自哪个源。除了Origin 字段，&quot;预检&quot;请求的头信息包括两个特殊字段。</p> <div class="language-shell extra-class"><pre class="language-shell"><code>OPTIONS /cors HTTP/1.1
Origin: http://api.bob.com
Access-Control-Request-Method: PUT
Access-Control-Request-Headers: X-Custom-Header
Host: api.alice.com
Accept-Language: en-US
Connection: keep-alive
User-Agent: Mozilla/5.0<span class="token punctuation">..</span>
</code></pre></div><ol><li>Access-Control-Request-Method：必选；用来列出浏览器的 CORS 请求会用到哪些 HTTP方 法，上例是 PUT。</li> <li>Access-Control-Request-Headers：可选；该字段是一个逗号分隔的字符串，指定浏览器 CORS 请求会额外发送的头信息字段，上例是 X-Custom-Header。</li></ol> <ul><li>预检请求的回应</li></ul> <p>服务器收到&quot;预检&quot;请求以后，检查了 Origin、Access-Control-Request-Method 和 Access-Control-Request-Headers 字段以后，确认允许跨源请求，就可以做出回应。HTTP 回应中，除了关键的是 Access-Control-Allow-Origin 字段，其他 CORS 相关字段如下：</p> <ol><li>Access-Control-Allow-Methods：必选；它的值是逗号分隔的一个字符串，表明服务器支持的所有跨域请求的方法。注意，返回的是所有支持的方法，而不单是浏览器请求的那个方法。这是为了避免多次&quot;预检&quot;请求。</li> <li>Access-Control-Allow-Headers 如果浏览器请求包括 Access-Control-Request-Headers 字段，则Access-Control-Allow-Headers 字段是必需的。它也是一个逗号分隔的字符串，表明服务器支持的所有头信息字段，不限于浏览器在&quot;预检&quot;中请求的字段。</li> <li>Access-Control-Allow-Credentials：可选；该字段与简单请求时的含义相同。</li> <li>Access-Control-Max-Age：可选；用来指定本次预检请求的有效期，单位为秒。</li></ol> <h4 id="前端示例"><a href="#前端示例" class="header-anchor">#</a> 前端示例</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// IE8/9 需用 window.XDomainRequest 兼容</span>
<span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 前端设置是否带 cookie</span>
xhr<span class="token punctuation">.</span>withCredentials <span class="token operator">=</span> <span class="token boolean">true</span>

xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'post'</span><span class="token punctuation">,</span> <span class="token string">'http://www.domain2.com:8080/login'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'application/x-www-form-urlencoded'</span><span class="token punctuation">)</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'user=admin'</span><span class="token punctuation">)</span>

xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><h4 id="服务器端设置"><a href="#服务器端设置" class="header-anchor">#</a> 服务器端设置</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> qs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'querystring'</span><span class="token punctuation">)</span>

server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'request'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> postData <span class="token operator">=</span> <span class="token string">''</span>
  <span class="token comment">// 数据块接收中</span>
  req<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    postData <span class="token operator">+=</span> chunk<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 数据接收完毕</span>
  req<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    postData <span class="token operator">=</span> qs<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>postData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 跨域后台设置</span>
    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token string">'Access-Control-Allow-Credentials'</span><span class="token operator">:</span> <span class="token string">'true'</span><span class="token punctuation">,</span>     <span class="token comment">// 后端允许发送 Cookie</span>
      <span class="token string">'Access-Control-Allow-Origin'</span><span class="token operator">:</span> <span class="token string">'http://www.domain1.com'</span><span class="token punctuation">,</span><span class="token comment">// 允许访问的域（协议+域名+端口）</span>
      <span class="token comment">/* 
        * 此处设置的cookie还是domain2的而非domain1，因为后端也不能跨域写cookie(nginx反向代理可以实现)，
        * 但只要domain2中写入一次cookie认证，后面的跨域接口都能从domain2中获取cookie，从而实现所有的接口都能跨域访问
      */</span>
      <span class="token string">'Set-Cookie'</span><span class="token operator">:</span> <span class="token string">'l=a123456;Path=/;Domain=www.domain2.com;HttpOnly'</span>  <span class="token comment">// HttpOnly的作用是让js无法读cookie</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>postData<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token string">'8080'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Server is running at port 8080...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="nginx-代理跨域"><a href="#nginx-代理跨域" class="header-anchor">#</a> nginx 代理跨域</h3> <p>nginx 代理跨域，实质和 CORS 跨域原理一样，通过配置文件设置请求响应头 Access-Control-Allow-Origin...等字段。</p> <h4 id="nginx-配置解决-iconfont-跨域"><a href="#nginx-配置解决-iconfont-跨域" class="header-anchor">#</a> nginx 配置解决 iconfont 跨域</h4> <p>浏览器跨域访问 js、css、img 等常规静态资源被同源策略许可，但 iconfont 字体文件(eot|otf|ttf|woff|svg)例外，此时可在nginx的静态资源服务器中加入以下配置。</p> <div class="language-shell extra-class"><pre class="language-shell"><code>location / <span class="token punctuation">{</span>
  add_header Access-Control-Allow-Origin *<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="nginx-反向代理接口跨域"><a href="#nginx-反向代理接口跨域" class="header-anchor">#</a> nginx 反向代理接口跨域</h4> <blockquote><p>跨域问题：同源策略仅是针对浏览器的安全策略。服务器端调用HTTP接口只是使用HTTP协议，不需要同源策略，也就不存在跨域问题。</p></blockquote> <p>实现思路：通过 Nginx 配置一个代理服务器域名与 domain1 相同，端口不同）做跳板机，反向代理访问 domain2 接口，并且可以顺便修改 cookie 中 domain 信息，方便当前域 cookie 写入，实现跨域访问。</p> <p>nginx 具体配置：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment">#proxy服务器</span>
server <span class="token punctuation">{</span>
  listen <span class="token number">81</span><span class="token punctuation">;</span>
  server_name  www.domain1.com<span class="token punctuation">;</span>

  location / <span class="token punctuation">{</span>
    proxy_pass   http://www.domain2.com:8080<span class="token punctuation">;</span>  <span class="token comment">#反向代理</span>
    proxy_cookie_domain www.domain2.com www.domain1.com<span class="token punctuation">;</span> <span class="token comment">#修改cookie里域名</span>
    index  index.html index.htm<span class="token punctuation">;</span>
    <span class="token comment"># 当用webpack-dev-server等中间件代理接口访问nignx时，此时无浏览器参与，故没有同源限制，下面的跨域配置可不启用</span>
    add_header Access-Control-Allow-Origin http://www.domain1.com<span class="token punctuation">;</span>  <span class="token comment">#当前端只跨域不带cookie时，可为*</span>
    add_header Access-Control-Allow-Credentials <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="document-domain-iframe-跨域"><a href="#document-domain-iframe-跨域" class="header-anchor">#</a> document.domain + iframe 跨域</h3> <p>此方案仅限主域相同，子域不同的跨域应用场景。实现原理：两个页面都通过 js 强制设置 document.domain 为基础主域，就实现了同域。</p> <ul><li>父窗口：</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>iframe<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://child.domain.com/b.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  document<span class="token punctuation">.</span>domain <span class="token operator">=</span> <span class="token string">'domain.com'</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> user <span class="token operator">=</span> <span class="token string">'admin'</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>子窗口:</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  document<span class="token punctuation">.</span>domain <span class="token operator">=</span> <span class="token string">'domain.com'</span><span class="token punctuation">;</span>
  <span class="token comment">// 获取父窗口中变量</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'get js data from parent ---&gt; '</span> <span class="token operator">+</span> window<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="websocket-协议跨域"><a href="#websocket-协议跨域" class="header-anchor">#</a> WebSocket 协议跨域</h3> <p>WebSocket protocol 是 HTML5 一种新的协议。它实现了浏览器与服务器全双工通信，同时允许跨域通讯，是 server push 技术的一种很好的实现。
原生 WebSocket API 使用起来不太方便，我们使用 Socket.io，它很好地封装了 webSocket 接口，提供了更简单、灵活的接口，也对不支持 webSocket 的浏览器提供了向下兼容。</p> <ul><li>前端代码</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>user input：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcss.com/socket.io/2.2.0/socket.io.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">var</span> socket <span class="token operator">=</span> <span class="token function">io</span><span class="token punctuation">(</span><span class="token string">'http://www.domain2.com:8080'</span><span class="token punctuation">)</span>
<span class="token comment">// 连接成功处理</span>
socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'connect'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 监听服务端消息</span>
  socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data from server: ---&gt; '</span> <span class="token operator">+</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// 监听服务端关闭</span>
  socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'disconnect'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Server socket has closed.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function-variable function">onblur</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  socket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>Nodejs socket 后台</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> socket <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'socket.io'</span><span class="token punctuation">)</span>

<span class="token comment">// 启http服务</span>
<span class="token keyword">var</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token string">'Content-type'</span><span class="token operator">:</span> <span class="token string">'text/html'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token string">'8080'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Server is running at port 8080...'</span><span class="token punctuation">)</span>

<span class="token comment">// 监听socket连接</span>
socket<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'connection'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">client</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 接收信息</span>
  client<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    client<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'hello：'</span> <span class="token operator">+</span> msg<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data from client: ---&gt; '</span> <span class="token operator">+</span> msg<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// 断开处理</span>
  client<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'disconnect'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Client socket has closed.'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>链接：https://juejin.cn/post/6844903882083024910</p> <h2 id="浏览器的缓存策略"><a href="#浏览器的缓存策略" class="header-anchor">#</a> 浏览器的缓存策略</h2> <p>首先对于一个数据请求来说，可以分为发起网络请求、后端处理、浏览器响应三个步骤。浏览器缓存可以帮助我们在第一和第三步骤中优化性能。比如说直接使用缓存而不发起请求，或者发起了请求但后端存储的数据和前端一致，那么就没有必要再将数据回传回来，这样就减少了响应数据。接下来的内容中我们将通过缓存位置、缓存策略以及实际场景应用缓存策略来探讨浏览器缓存机制。</p> <h3 id="缓存位置"><a href="#缓存位置" class="header-anchor">#</a> 缓存位置</h3> <p>从缓存位置上来说分为四种，并且各自有优先级，当依次查找缓存且都没有命中的时候，才会去请求网络。</p> <ul><li>Service Worker</li> <li>Memory Cache</li> <li>Disk Cache</li> <li>Push Cache</li></ul> <h3 id="service-worker"><a href="#service-worker" class="header-anchor">#</a> Service Worker</h3> <p>Service Worker 是运行在浏览器背后的独立线程，一般可以用来实现缓存功能。使用 Service Worker的话，传输协议必须为 HTTPS。因为 Service Worker 中涉及到请求拦截，所以必须使用 HTTPS 协议来保障安全。Service Worker 的缓存与浏览器其他内建的缓存机制不同，它可以让我们自由控制缓存哪些文件、如何匹配缓存、如何读取缓存，并且缓存是持续性的。</p> <p>Service Worker 实现缓存功能一般分为三个步骤：首先需要先注册 Service Worker，然后监听到 install 事件以后就可以缓存需要的文件，那么在下次用户访问的时候就可以通过拦截请求的方式查询是否存在缓存，存在缓存的话就可以直接读取缓存文件，否则就去请求数据。</p> <p>当 Service Worker 没有命中缓存的时候，我们需要去调用 fetch 函数获取数据。也就是说，如果我们没有在 Service Worker 命中缓存的话，会根据缓存查找优先级去查找数据。但是不管我们是从 Memory Cache 中还是从网络请求中获取的数据，浏览器都会显示我们是从 Service Worker 中获取的内容。</p> <h3 id="memory-cache"><a href="#memory-cache" class="header-anchor">#</a> Memory Cache</h3> <p>Memory Cache 也就是内存中的缓存，主要包含的是当前中页面中已经抓取到的资源,例如页面上已经下载的样式、脚本、图片等。读取内存中的数据肯定比磁盘快,内存缓存虽然读取高效，可是缓存持续性很短，会随着进程的释放而释放。 一旦我们关闭 Tab 页面，内存中的缓存也就被释放了。</p> <p>那么既然内存缓存这么高效，我们是不是能让数据都存放在内存中呢？
这是不可能的。计算机中的内存一定比硬盘容量小得多，操作系统需要精打细算内存的使用，所以能让我们使用的内存必然不多。</p> <p>当我们访问过页面以后，再次刷新页面，可以发现很多数据都来自于内存缓存：</p> <p>![在这里插入图片描述](./img/http14.png</p> <p>内存缓存中有一块重要的缓存资源是 preloader 相关指令（例如<code>&lt;link rel=&quot;prefetch&quot;&gt;</code>）下载的资源。总所周知 preloader 的相关指令已经是页面优化的常见手段之一，它可以一边解析 js/css 文件，一边网络请求下一个资源。</p> <p>需要注意的事情是，内存缓存在缓存资源时并不关心返回资源的 HTTP 缓存头 Cache-Control 是什么值，同时资源的匹配也并非仅仅是对URL 做匹配，还可能会对 Content-Type，CORS 等其他特征做校验。</p> <h3 id="disk-cache"><a href="#disk-cache" class="header-anchor">#</a> Disk Cache</h3> <p>Disk Cache 也就是存储在硬盘中的缓存，读取速度慢点，但是什么都能存储到磁盘中，比之 Memory Cache 胜在容量和存储时效性上。</p> <p>在所有浏览器缓存中，Disk Cache 覆盖面基本是最大的。它会根据 HTTP Herder 中的字段判断哪些资源需要缓存，哪些资源可以不请求直接使用，哪些资源已经过期需要重新请求。并且即使在跨站点的情况下，相同地址的资源一旦被硬盘缓存下来，就不会再次去请求数据。绝大部分的缓存都来自 Disk Cache，关于 HTTP 的协议头中的缓存字段，我们会在下文进行详细介绍。</p> <h3 id="push-cache"><a href="#push-cache" class="header-anchor">#</a> Push Cache</h3> <p>Push Cache（推送缓存）是 HTTP/2 中的内容，当以上三种缓存都没有命中时，它才会被使用。它只在会话（Session）中存在，一旦会话结束就被释放，并且缓存时间也很短暂，在Chrome浏览器中只有5分钟左右，同时它也并非严格执行HTTP头中的缓存指令。</p> <p>他有如下几个特点：</p> <ul><li>所有的资源都能被推送，并且能够被缓存,但是 Edge 和 Safari 浏览器支持相对比较差</li> <li>可以推送 no-cache 和 no-store 的资源</li> <li>一旦连接被关闭，Push Cache 就被释放</li> <li>多个页面可以使用同一个 HTTP/2 的连接，也就可以使用同一个 Push Cache。这主要还是依赖浏览器的实现而定，出于对性能的考虑，有的浏览器会对相同域名但不同的 tab 标签使用同一个 HTTP 连接。</li> <li>Push Cache 中的缓存只能被使用一次</li> <li>浏览器可以拒绝接受已经存在的资源推送</li> <li>你可以给其他域名推送资源</li></ul> <p>如果以上四种缓存都没有命中的话，那么只能发起请求来获取资源了。</p> <p>那么为了性能上的考虑，大部分的接口都应该选择好缓存策略，通常浏览器缓存策略分为两种：强缓存和协商缓存，并且缓存策略都是通过设置 HTTP Header 来实现的。参考 http 缓存机制；</p> <blockquote><p>参考链接：https://www.jianshu.com/p/54cc04190252</p></blockquote> <h2 id="http-缓存机制"><a href="#http-缓存机制" class="header-anchor">#</a> HTTP 缓存机制</h2> <p>其机制是根据 HTTP 报文的缓存标识进行的；根据是否需要向服务器重新发起 HTTP 请求将缓存过程分为两个部分，分别是强制缓存和协商缓存</p> <h3 id="缓存的过程"><a href="#缓存的过程" class="header-anchor">#</a> 缓存的过程</h3> <p>浏览器与服务器通信的方式为应答模式，即是：浏览器发起 HTTP 请求 – 服务器响应该请求。那么浏览器第一次向服务器发起该请求后拿到请求结果，会根据响应报文中HTTP头的缓存标识，决定是否缓存结果，是则将请求结果和缓存标识存入浏览器缓存中，简单的过程如下
图：</p> <p><img src="/note/assets/img/http1.275c298a.png" alt="在这里插入图片描述"></p> <p>由上图我们可以知道：</p> <ul><li>浏览器每次发起请求，都会先在浏览器缓存中查找该请求的结果以及缓存标识</li> <li>浏览器每次拿到返回的请求结果都会将该结果和缓存标识存入浏览器缓存中</li></ul> <p>以上两点结论就是浏览器缓存机制的关键，他确保了每个请求的缓存存入与读取，只要我们再理解浏览器缓存的使用规则，那么所有的问题就迎刃而解了，本文也将围绕着这点进行详细分析。</p> <h3 id="强制缓存"><a href="#强制缓存" class="header-anchor">#</a> 强制缓存</h3> <p>强制缓存就是向浏览器缓存查找该请求结果，并根据该结果的缓存规则来决定是否使用该缓存结果的过程，强制缓存的情况主要有三种(暂不分析协商缓存过程)，如下：</p> <p>不存在该缓存结果和缓存标识，强制缓存失效，则直接向服务器发起请求（跟第一次发起请求一致），如下图：</p> <p><img src="/note/assets/img/http2.1a653253.png" alt="在这里插入图片描述"></p> <p>存在该缓存结果和缓存标识，但该结果已失效，强制缓存失效，则使用协商缓存(暂不分析)，如下图</p> <p><img src="/note/assets/img/http3.8b3ffdc0.png" alt="在这里插入图片描述"></p> <p>存在该缓存结果和缓存标识，且该结果尚未失效，强制缓存生效，直接返回该结果，如下图</p> <p><img src="/note/assets/img/http4.e32b0bf9.png" alt="在这里插入图片描述"></p> <h4 id="强制缓存的规则"><a href="#强制缓存的规则" class="header-anchor">#</a> 强制缓存的规则</h4> <p>当浏览器向服务器发起请求时，服务器会将缓存规则放入 HTTP 响应报文的 HTTP 头中和请求结果一起返回给浏览器，控制强制缓存的字段分别是 Expires 和 Cache-Control，其中 Cache-Control 优先级比 Expires 高。</p> <h4 id="expires"><a href="#expires" class="header-anchor">#</a> Expires</h4> <p>Expires 是 HTTP/1.0 控制网页缓存的字段，其值为服务器返回该请求结果缓存的到期时间，即再次发起该请求时，如果客户端的时间小于 Expires 的值时，直接使用缓存结果。</p> <p>到了 HTTP/1.1，Expire 已经被 Cache-Control 替代，原因在于 Expires 控制缓存的原理是使用客户端的时间与服务端返回的时间做对比，那么如果客户端与服务端的时间因为某些原因（例如时区不同；客户端和服务端有一方的时间不准确）发生误差，那么强制缓存则会直接失效，这样的话强制缓存的存在则毫无意义，那么 Cache-Control 又是如何控制的呢？</p> <h4 id="cache-control"><a href="#cache-control" class="header-anchor">#</a> Cache-Control</h4> <p>在HTTP/1.1中，Cache-Control 是最重要的规则，主要用于控制网页缓存，主要取值为：</p> <ul><li>public：所有内容都将被缓存（客户端和代理服务器都可缓存）</li> <li>private：所有内容只有客户端可以缓存，Cache-Control 的默认取值</li> <li>no-cache：客户端缓存内容，但是是否使用缓存则需要经过协商缓存来验证决定</li> <li>no-store：所有内容都不会被缓存，即不使用强制缓存，也不使用协商缓存</li> <li>max-age=xxx (xxx is numeric)：缓存内容将在 xxx 秒后失效</li></ul> <p>接下来，我们直接看一个例子，如下：</p> <p><img src="/note/assets/img/http5.282f48ee.png" alt="在这里插入图片描述"></p> <p>由上面的例子我们可以知道：</p> <ul><li>HTTP 响应报文中 Cache-Control 为 max-age=600，是相对值</li> <li>HTTP 响应报文中 expires 的时间值，是一个绝对值</li></ul> <p>由于 Cache-Control 的优先级比 expires，那么直接根据 Cache-Control 的值进行缓存，意思就是说在 600 秒内再次发起该请求，则会直接使用缓存结果，强制缓存生效。</p> <blockquote><p>注：在无法确定客户端的时间是否与服务端的时间同步的情况下，Cache-Control 相比于 expires 是更好的选择，所以同时存在时，只有 Cache-Control 生效。</p></blockquote> <p>了解强制缓存的过程后，我们拓展性的思考一下：浏览器的缓存存放在哪里，如何在浏览器中判断强制缓存是否生效？如下图：</p> <p><img src="/note/assets/img/http6.25801968.png" alt="在这里插入图片描述"></p> <p>这里我们以博客的请求为例，状态码为灰色的请求则代表使用了强制缓存，请求对应的 Size 值则代表该缓存存放的位置，分别为 from memory cache 和 from disk cache。</p> <p>from memory cache 代表使用内存中的缓存，from disk cache 则代表使用的是硬盘中的缓存，浏览器读取缓存的顺序为 memory –&gt; disk。</p> <p>那么如何对于 memory cache 和 disk cache 缓存的进行选择，我们需要了解内存缓存 (from memory cache) 和硬盘缓存 (from disk cache)，如下:</p> <ol><li>内存缓存(from memory cache)：内存缓存具有两个特点，分别是快速读取和时效性：</li></ol> <ul><li>快速读取：内存缓存会将编译解析后的文件，直接存入该进程的内存中，占据该进程一定的内存资源，以方便下次运行使用时的快速读取。</li> <li>时效性：一旦该进程关闭，则该进程的内存则会清空。</li></ul> <ol start="2"><li>硬盘缓存(from disk cache)：硬盘缓存则是直接将缓存写入硬盘文件中，读取缓存需要对该缓存存放的硬盘文件进行 I/O 操作，然后重新解析该缓存内容，读取复杂，速度比内存缓存慢。</li></ol> <p>在浏览器中，浏览器会在 js 和图片等文件解析执行后直接存入内存缓存中，那么当刷新页面时只需直接从内存缓存中读取(from memory cache)；而 css 文件则会存入硬盘文件中，所以每次渲染页面都需要从硬盘读取缓存(from disk cache)。</p> <h3 id="协商缓存"><a href="#协商缓存" class="header-anchor">#</a> 协商缓存</h3> <p>协商缓存就是强制缓存失效后，浏览器携带缓存标识向服务器发起请求，由服务器根据缓存标识决定是否使用缓存的过程，主要有以下两种情况：</p> <p>协商缓存生效，返回 304，如下</p> <p><img src="/note/assets/img/http7.7c83a0e3.png" alt="在这里插入图片描述"></p> <p>协商缓存失效，返回200和请求结果结果，如下</p> <p><img src="/note/assets/img/http8.b1746736.png" alt="在这里插入图片描述"></p> <p>同样，协商缓存的标识也是在响应报文的 HTTP 头中和请求结果一起返回给浏览器的，控制协商缓存的字段分别有：Last-Modified / If-Modified-Since 和 Etag / If-None-Match，其中 Etag / If-None-Match 的优先级比 Last-Modified / If-Modified-Since 高。</p> <h4 id="last-modified-if-modified-since"><a href="#last-modified-if-modified-since" class="header-anchor">#</a> Last-Modified / If-Modified-Since</h4> <p>Last-Modified 是服务器响应请求时，返回该资源文件在服务器最后被修改的时间，如下。</p> <p><img src="/note/assets/img/http9.75a36c8c.png" alt="在这里插入图片描述"></p> <p>If-Modified-Since 则是客户端再次发起该请求时，携带上次请求返回的 Last-Modified 值，通过此字段值告诉服务器该资源上次请求返回的最后被修改时间。服务器收到该请求，发现请求头含有 If-Modified-Since 字段，则会根据 If-Modified-Since 的字段值与该资源在服务器的最后被修改时间做对比，若服务器的资源最后被修改时间大于 If-Modified-Since 的字段值，则重新返回资源，状态码为200；否则则返回304，代表资源无更新，可继续使用缓存文件，如下。</p> <p><img src="/note/assets/img/http10.4c5175e7.png" alt="在这里插入图片描述"></p> <h4 id="etag-if-none-match"><a href="#etag-if-none-match" class="header-anchor">#</a> Etag / If-None-Match</h4> <p>Etag 是服务器响应请求时，返回当前资源文件的一个唯一标识(由服务器生成)，如下。</p> <p><img src="/note/assets/img/http11.c59fe4a9.png" alt="在这里插入图片描述"></p> <p>If-None-Match 是客户端再次发起该请求时，携带上次请求返回的唯一标识 Etag 值，通过此字段值告诉服务器该资源上次请求返回的唯一标识值。服务器收到该请求后，发现该请求头中含有 If-None-Match，则会根据 If-None-Match 的字段值与该资源在服务器的 Etag 值做对比，一致则返回 304，代表资源无更新，继续使用缓存文件；不一致则重新返回资源文件，状态码为 200，如下。</p> <p><img src="/note/assets/img/http12.eef19ccb.png" alt="在这里插入图片描述"></p> <p>注：Etag / If-None-Match 优先级高于 Last-Modified / If-Modified-Since，同时存在则只有 Etag / If-None-Match 生效。</p> <h3 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h3> <p>强制缓存优先于协商缓存进行，若强制缓存(Expires 和 Cache-Control)生效则直接使用缓存，若不生效则进行协商缓存(Last-Modified / If-Modified-Since 和 Etag / If-None-Match)，协商缓存由服务器决定是否使用缓存，若协商缓存失效，那么代表该请求的缓存失效，重新获取请求结果，再存入浏览器缓存中；生效则返回 304，继续使用缓存，主要过程如下：</p> <p><img src="/note/assets/img/http13.9da117d7.png" alt="在这里插入图片描述"></p> <blockquote><p>参考链接：https://juejin.cn/post/6844903593275817998</p></blockquote> <h2 id="输入-url-后发生了什么"><a href="#输入-url-后发生了什么" class="header-anchor">#</a> 输入 URL 后发生了什么</h2> <blockquote><p>https://tridiamond.blog.csdn.net/article/details/108023150</p></blockquote> <h2 id="怎么模拟一个队列-有多少种方式"><a href="#怎么模拟一个队列-有多少种方式" class="header-anchor">#</a> 怎么模拟一个队列，有多少种方式</h2> <h2 id="实现一个-js-的反向链表"><a href="#实现一个-js-的反向链表" class="header-anchor">#</a> 实现一个 js 的反向链表</h2> <h2 id="如果有一个列表非常长-分页后怎么做才能使得占据的内存最小"><a href="#如果有一个列表非常长-分页后怎么做才能使得占据的内存最小" class="header-anchor">#</a> 如果有一个列表非常长，分页后怎么做才能使得占据的内存最小</h2> <h2 id="this-的理解"><a href="#this-的理解" class="header-anchor">#</a> this 的理解</h2> <h2 id="amd-cmd、commonjs-和-es6-的-esmodule-的区别"><a href="#amd-cmd、commonjs-和-es6-的-esmodule-的区别" class="header-anchor">#</a> AMD，CMD、CommonJS 和 es6 的 esmodule 的区别</h2> <h3 id="amd-requirejs"><a href="#amd-requirejs" class="header-anchor">#</a> AMD (requireJS)</h3> <p>异步模块加载机制；requireJS 实现了 AMD 规范；下面是 RequireJS 的基本用法：</p> <ul><li>通过 define 进行定义模块</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// a.js</span>
<span class="token comment">// define 可以传入三个参数，分别是字符串-模块名、数组-依赖模块、函数-回调函数</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token number">1</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>使用 require 导入定义的模块</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// b.js</span>
<span class="token comment">// 数组中声明需要加载的模块，可以是模块名、js文件路径</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment">// 1</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>RequireJS 的特点：对于依赖的模块，AMD 推崇<code>依赖前置，提前执行</code>。也就是说，在 define 方法里传入的依赖模块(数组)，会在一开始就下载并执行。</p> <h3 id="cmd-seajs"><a href="#cmd-seajs" class="header-anchor">#</a> CMD (SeaJS)</h3> <p>CMD 是 SeaJS 在推广过程中生产的对模块定义的规范，在 Web 浏览器端的模块加载器中，SeaJS 与 RequireJS 并称，相对于 AMD，他是对于依赖的模块，推崇<code>依赖就近，延迟执行</code>。也就是说，只有到 require 时依赖模块才执行。就是什么时候需要再进行模块的引入；</p> <p>如下基本用法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// a.js</span>
<span class="token comment">/*
* define 接受 factory 参数，factory 可以是一个函数，也可以是一个对象或字符串，
* factory 为对象、字符串时，表示模块的接口就是该对象、字符串。
* define 也可以接受两个以上参数。字符串 id 表示模块标识，数组 deps 是模块依赖.
*/</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">require<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> module</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> $ <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'jquery'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  exports<span class="token punctuation">.</span><span class="token function-variable function">setColor</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'color'</span><span class="token punctuation">,</span><span class="token string">'#333'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// b.js</span>
<span class="token comment">// 数组中声明需要加载的模块，可以是模块名、js文件路径</span>
seajs<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#el'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>setColor<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="commonjs"><a href="#commonjs" class="header-anchor">#</a> CommonJS</h3> <p>CommonJS 规范为 CommonJS 小组所提出，目的是弥补 JavaScript 在服务器端缺少模块化机制，NodeJS、webpack 都是基于该规范来实现的。</p> <ul><li>基本用法</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// a.js</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// b.js</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a.js'</span><span class="token punctuation">)</span>

<span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 'a'</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// a.js</span>
exports<span class="token punctuation">.</span>num <span class="token operator">=</span> <span class="token number">1</span>
exports<span class="token punctuation">.</span>obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'obj'</span>
<span class="token punctuation">}</span>

<span class="token comment">// b2.js</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a2<span class="token punctuation">)</span> <span class="token comment">// { num: 1, obj: { name: 'obj' } }</span>
</code></pre></div><ul><li><p>CommonJS的特点</p></li> <li><p>所有代码都运行在模块作用域，不会污染全局作用域；</p></li> <li><p>模块是同步加载的，即只有加载完成，才能执行后面的操作；</p></li> <li><p>模块在首次执行后就会缓存，再次加载只返回缓存结果，如果想要再次执行，可清除缓存；</p></li> <li><p>require 返回的值是被输出的值的拷贝，模块内部的变化也不会影响这个值；</p></li></ul> <h3 id="es6-module"><a href="#es6-module" class="header-anchor">#</a> ES6 Module</h3> <p>ES6 Module 是 ES6 中规定的模块体系，相比上面提到的规范， ES6 Module 有更多的优势，有望成为浏览器和服务器通用的模块解决方案。</p> <p>ES6 Module 的基本用法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// a.js</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">'lin'</span>
<span class="token keyword">const</span> age <span class="token operator">=</span> <span class="token number">13</span>
<span class="token keyword">const</span> job <span class="token operator">=</span> <span class="token string">'ninja'</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> job<span class="token punctuation">}</span>

<span class="token comment">// b.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> job<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./a.js'</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> job<span class="token punctuation">)</span> <span class="token comment">// lin 13 ninja</span>
</code></pre></div><p>ES6 Module 的特点(对比 CommonJS )</p> <ul><li>CommonJS 模块是运行时加载，因为它最终是输出一个对象，ES6 Module 是编译时输出接口；</li> <li>CommonJS 加载的是整个模块，将所有的接口全部加载进来，ES6 Module可以单独加载其中的某个接口；</li> <li>CommonJS 输出是值的拷贝，ES6 Module 输出的是值的引用，被输出模块的内部的改变会影响引用的改变；</li> <li>CommonJS this 指向当前模块，ES6 Module this 指向 undefined;</li></ul> <h3 id="总结-2"><a href="#总结-2" class="header-anchor">#</a> 总结</h3> <ul><li>AMD 依赖前置，提前执行 (require.js)，语法是 define，require；</li> <li>CMD 依赖就近，延迟执行 （sea.js），语法是 define，seajs.use([],cb)；</li> <li>commonJS 语法 module.exports=fn或者exports.a=1; 通过 require('./a1') 来引入；</li> <li>commonJS 模块首次执行会被缓存，再次加载只返回缓存结果，require 返回的值是输出值的拷贝（对于引用类型是浅拷贝）；</li> <li>es6 module 语法是 export {...}, import ...from..., export 输出的是值的引用。</li> <li>NodeJS、webpack 都是基于 commonJS 该规范来实现的</li></ul> <h3 id="commonjs-和-es6-module-的区别"><a href="#commonjs-和-es6-module-的区别" class="header-anchor">#</a> Commonjs 和 es6 module 的区别</h3> <ul><li>commonJS 是同步导入，因用于服务端，文件都在本地，同步导入即使卡住主线程影响也不大，后者是异步导入，因为用于浏览器端，需下载文件，如果采用同步导入对渲染会有很大影响；</li> <li>CommonJS 在导出时都是值的拷贝，就算导出的值变了，导入的值也不会变。如果想更新，必须重新导入一回；</li> <li>ES Module 导入导出的值指向同一个内存地址。所以，导入值也会随着导出值变化；</li> <li>ES Module 会编译成 require/exports 来执行；</li> <li>一个导出的是值的拷贝，一个导出的是值的引用；</li> <li>一个是同步导入，一个是异步导入；</li></ul> <blockquote><p>参考：https://juejin.cn/post/6844903998089101319</p></blockquote> <h2 id="原型链和原型"><a href="#原型链和原型" class="header-anchor">#</a> 原型链和原型</h2> <h2 id="怎么实现一个-new"><a href="#怎么实现一个-new" class="header-anchor">#</a> 怎么实现一个 new</h2> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
  <span class="token punctuation">}</span>

  <span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>have <span class="token operator">=</span> <span class="token string">'cat'</span>
  <span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">function</span> <span class="token function">fakenews</span><span class="token punctuation">(</span><span class="token parameter">Fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Fn</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
    <span class="token function">Fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> obj
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token function">fakenews</span><span class="token punctuation">(</span>Person<span class="token punctuation">,</span> <span class="token string">&quot;张三&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;20&quot;</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>age<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>have<span class="token punctuation">)</span>
  person<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="localstorage-和-sessionstorage-和-cookie"><a href="#localstorage-和-sessionstorage-和-cookie" class="header-anchor">#</a> localstorage 和 sessionstorage 和 cookie</h2> <h3 id="使用方式"><a href="#使用方式" class="header-anchor">#</a> 使用方式</h3> <ul><li>cookie</li></ul> <ol><li>客户端操作</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 获取</span>
document<span class="token punctuation">.</span>cookie

<span class="token comment">// 设置 - 追加到第一位</span>
document<span class="token punctuation">.</span>cookie <span class="token operator">=</span> <span class="token string">'jiegiser=123'</span>
</code></pre></div><blockquote><p>注意，如果服务器端设置了 HttpOnly，在前端是获取不到 cookie 的；</p></blockquote> <ol start="2"><li>服务端设置</li></ol> <p>服务端向客户端发送的cookie(HTTP头,不带参数)：</p> <div class="language-shell extra-class"><pre class="language-shell"><code>Set-Cookie: <span class="token operator">&lt;</span>cookie-name<span class="token operator">&gt;</span><span class="token operator">=</span><span class="token operator">&lt;</span>cookie-value<span class="token operator">&gt;</span> <span class="token punctuation">(</span>name可选<span class="token punctuation">)</span>
</code></pre></div><p>服务端向客户端发送的cookie(HTTP头，带参数)：</p> <div class="language-shell extra-class"><pre class="language-shell"><code>Set-Cookie: <span class="token operator">&lt;</span>cookie-name<span class="token operator">&gt;</span><span class="token operator">=</span><span class="token operator">&lt;</span>cookie-value<span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token punctuation">(</span>可选参数1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>可选参数2<span class="token punctuation">)</span>
</code></pre></div><ol start="3"><li>可选参数</li></ol> <p><code>Expires=&lt;date&gt;</code>：cookie 的最长有效时间，若不设置则 cookie 生命期与会话期相同；
<code>Max-Age=&lt;non-zero-digit&gt;</code>：cookie 生成后失效的秒数；
<code>Domain=&lt;domain-value&gt;</code>：指定 cookie 可以送达的主机域名，若一级域名设置了则二级域名也能获取；
<code>Path=&lt;path-value&gt;</code>：指定一个 URL，例如指定 path=/docs，则”/docs”、”/docs/Web/“、”/docs/Web/Http” 均满足匹配条件；
<code>Secure</code>：必须在请求使用 SSL 或 HTTPS 协议的时候 cookie 才回被发送到服务器；
<code>HttpOnly</code>：客户端无法更改 Cookie，客户端设置 cookie 时不能使用这个参数，一般是服务器端使用；</p> <ol start="4"><li>可选前缀</li></ol> <p><code>__Secure-</code>：以 __Secure- 为前缀的 cookie，必须与 secure 属性一同设置，同时必须应用于安全页面（即使用 HTTPS）；</p> <p><code>__Host-</code>：以 __Host- 为前缀的 cookie，必须与 secure 属性一同设置，同时必须应用于安全页面（即使用 HTTPS）。必须不能设置domian 属性（这样可以防止二级域名获取一级域名的 cookie），path 属性的值必须为 ”/“。</p> <p>前缀使用示例：</p> <div class="language-shell extra-class"><pre class="language-shell"><code>Set-Cookie: __Secure-ID<span class="token operator">=</span><span class="token number">123</span><span class="token punctuation">;</span> Secure<span class="token punctuation">;</span> <span class="token assign-left variable">Domain</span><span class="token operator">=</span>example.com
Set-Cookie: __Host-ID<span class="token operator">=</span><span class="token number">123</span><span class="token punctuation">;</span> Secure<span class="token punctuation">;</span> <span class="token assign-left variable">Path</span><span class="token operator">=</span>/

document.cookie <span class="token operator">=</span> <span class="token string">&quot;__Secure-KMKNKK=1234;Sercure&quot;</span>
document.cookie <span class="token operator">=</span> <span class="token string">&quot;__Host-KMKNKK=1234;Sercure;path=/&quot;</span>
</code></pre></div><ul><li>localStorage 和 sessionStorage</li></ul> <p>localStorage 和 sessionStorage 所使用的方法是一样的，下面以 sessionStorage 为例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">'jiegiser'</span>
<span class="token keyword">const</span> age <span class="token operator">=</span> <span class="token number">18</span>

<span class="token comment">// 存储数据</span>
sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span>
sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'key'</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">)</span>

<span class="token comment">// 获取到全部数据</span>
<span class="token keyword">const</span> dataAll <span class="token operator">=</span> sessionStorage<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">/**
 * IsThisFirstTime_Log_From_LiveServer: &quot;true&quot;
    jiegiser: &quot;18&quot;
    length: 3
    key: &lt;unreadable&gt;
 */</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dataAll<span class="token punctuation">)</span>

<span class="token comment">// 获取指定 key 数据</span>
<span class="token keyword">const</span> dataSession <span class="token operator">=</span> sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dataSession<span class="token punctuation">)</span> <span class="token comment">// 18</span>

<span class="token comment">// sessionStorage 是 js 对象，也可以使用 key 的方式来获取值</span>
<span class="token keyword">const</span> dataSession2 <span class="token operator">=</span> sessionStorage<span class="token punctuation">[</span>name<span class="token punctuation">]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dataSession2<span class="token punctuation">)</span> <span class="token comment">// 18</span>

<span class="token comment">// 删除指定 key 数据</span>
sessionStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dataAll<span class="token punctuation">)</span>

<span class="token comment">// 清空缓存数据</span>
sessionStorage<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dataAll<span class="token punctuation">)</span>
</code></pre></div><h3 id="三者的异同"><a href="#三者的异同" class="header-anchor">#</a> 三者的异同</h3> <ul><li>生命周期</li></ul> <ol><li>cookie：可设置失效时间，没有设置的话，默认是关闭浏览器后失效。</li> <li>localStorage：除非被手动清除，否则将会永久保存。</li> <li>sessionStorage：仅在当前网页会话下有效，关闭页面或浏览器后就会被清除。</li></ol> <ul><li>存放数据大小</li></ul> <ol><li>cookie：4KB 左右</li> <li>localStorage 和 sessionStorage：可以保存 5MB 的信息。</li></ol> <ul><li>http 请求</li></ul> <ol><li>cookie：每次都会携带在 HTTP 头中（在指定作用域情况下），如果使用 cookie 保存过多数据会带来性能问题</li> <li>localStorage 和 sessionStorage：仅在客户端（即浏览器）中保存，不参与和服务器的通信</li></ol> <ul><li>作用域</li></ul> <ol><li>localStorage: 在同一个浏览器内，<code>同源文档</code>之间共享 localStorage 数据，可以互相读取、覆盖。</li> <li>sessionStorage: 与 localStorage 一样需要<code>同一浏览器同源文档</code>这一条件。不仅如此，sessionStorage 的作用域还被限定在了窗口中，也就是说，只有同一浏览器、同一窗口的同源文档才能共享数据。</li></ol> <p>例如你在浏览器中打开了两个相同地址的页面 A、B,虽然这两个页面的源完全相同，但是他们还是不能共享数据，因为他们是不同窗口中的。但是如果是一个窗口中，有两个同源的 iframe 元素的话，这两个 iframe 的 sessionStorage 是可以互通的。</p> <ul><li>易用性</li></ul> <ol><li>cookie：需要程序员自己封装，原生的 Cookie 接口不友好；</li> <li>localStorage 和 sessionStorage：原生接口可以接受，亦可再次封装来对 Object 和 Array 有更好的支持；</li></ol> <h3 id="能设置或读取子域的-cookie-吗"><a href="#能设置或读取子域的-cookie-吗" class="header-anchor">#</a> 能设置或读取子域的 cookie 吗?</h3> <p>不行! 只能向当前域或者更高级域设置cookie
例如 client.com 不能向 a.client.com 设置 cookie, 而 a.client.com 可以向 client.com 设置 cookie</p> <p>读取 cookie 情况同上</p> <h4 id="客户端设置-cookie-与服务端设置-cookie-有什么区别"><a href="#客户端设置-cookie-与服务端设置-cookie-有什么区别" class="header-anchor">#</a> 客户端设置 cookie 与服务端设置 cookie 有什么区别?</h4> <ul><li>无论是客户端还是服务端, 都只能向自己的域或者更高级域设置 cookie；例如 client.com 不能向 server.com 设置 cookie, 同样 server.com 也不能向 client.com 设置 cookie；</li> <li>服务端可以设置 httpOnly: true, 带有该属性的 cookie 客户端无法读取；</li> <li>客户端只会带上与请求同域的 cookie, 例如 client.com/index.html 会带上 client.com 的 cookie, server.com/app.js 会带上 server.com 的 cookie, 并且也会带上 httpOnly 的 cookie；</li> <li>但是, 如果是向服务端的 ajax 请求, 则不会带上 cookie；</li></ul> <h3 id="同域-跨域-ajax-请求到底会不会带上-cookie"><a href="#同域-跨域-ajax-请求到底会不会带上-cookie" class="header-anchor">#</a> 同域/跨域 ajax 请求到底会不会带上 cookie?</h3> <p>这个问题与你发起 ajax 请求的方式有关:</p> <ol><li><p>fetch 在默认情况下, 不管是同域还是跨域 ajax 请求都不会带上 cookie, 只有当设置了 credentials 时才会带上该 ajax 请求所在域的 cookie, 服务端需要设置响应头 Access-Control-Allow-Credentials: true, 否则浏览器会因为安全限制而报错, 拿不到响应；</p></li> <li><p>axios 和 jQuery 在同域ajax请求时会带上cookie, 跨域请求不会, 跨域请求需要设置 withCredentials 和服务端响应头</p></li></ol> <h4 id="fetch-设置-credentials"><a href="#fetch-设置-credentials" class="header-anchor">#</a> fetch 设置 credentials</h4> <p>使 fetch 带上 cookie：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  credentials<span class="token operator">:</span> <span class="token string">&quot;include&quot;</span><span class="token punctuation">,</span> <span class="token comment">// include, same-origin, omit</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>include: 跨域 ajax 带上 cookie</li> <li>same-origin: 仅同域 ajax 带上 cookie</li> <li>omit: 任何情况都不带 cookie</li></ul> <h4 id="axios-设置-withcredentials"><a href="#axios-设置-withcredentials" class="header-anchor">#</a> axios 设置 withCredentials</h4> <p>使 axios 带上 cookie：</p> <div class="language-js extra-class"><pre class="language-js"><code>axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://server.com'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> withCredentials<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="jquery-设置-withcredentials"><a href="#jquery-设置-withcredentials" class="header-anchor">#</a> jQuery 设置 withCredentials</h4> <div class="language-js extra-class"><pre class="language-js"><code>$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  method<span class="token operator">:</span> <span class="token string">'get'</span><span class="token punctuation">,</span>
  url<span class="token operator">:</span> <span class="token string">'http://server.com'</span><span class="token punctuation">,</span>
  xhrFields<span class="token operator">:</span> <span class="token punctuation">{</span>
    withCredentials<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>参考：https://juejin.cn/post/6844903587764502536
https://juejin.cn/post/6844903648384778247</p></blockquote> <h2 id="纯-js-怎么实现当你需要一个-js-的时候再去加载"><a href="#纯-js-怎么实现当你需要一个-js-的时候再去加载" class="header-anchor">#</a> 纯 js 怎么实现当你需要一个 js 的时候再去加载</h2> <p>第一种：函数引用，将所需加载方法放在匿名函数中传入</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">laodScript</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 创建一个 script</span>
  <span class="token keyword">const</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span>
  script<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'text/javascript'</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>script<span class="token punctuation">.</span>readyState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 判断当异步加载完后才执行回调 IE使用</span>
    script<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>script<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token string">'complete'</span> <span class="token operator">||</span> script<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token string">'loaded'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// Chrome Safari Opera Firefox使用</span>
    script<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  script<span class="token punctuation">.</span>src <span class="token operator">=</span> url
  document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">laodScript</span><span class="token punctuation">(</span><span class="token string">'./a.js'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>第二种：使用 XMLHttpRequest 对象</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">laodScript</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
  xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">&gt;=</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>status <span class="token operator">&lt;</span> <span class="token number">300</span> <span class="token operator">||</span> xhr<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">304</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span>
        script<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'text/javascript'</span>
        script<span class="token punctuation">.</span>text <span class="token operator">=</span> xhr<span class="token punctuation">.</span>responseText
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">laodScript</span><span class="token punctuation">(</span><span class="token string">'./a.js'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>第三种：Dynamic import 方式</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// a.js</span>

<span class="token keyword">const</span> <span class="token function-variable function">test</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> test

<span class="token comment">// 按需加载</span>
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./a.js'</span><span class="token punctuation">,</span> <span class="token parameter">mod</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  mod<span class="token punctuation">.</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="ts-的理解-优点和缺点"><a href="#ts-的理解-优点和缺点" class="header-anchor">#</a> ts 的理解，优点和缺点</h2> <h2 id="泛型和接口的区别"><a href="#泛型和接口的区别" class="header-anchor">#</a> 泛型和接口的区别</h2> <h2 id="移动端适配方案有哪几种"><a href="#移动端适配方案有哪几种" class="header-anchor">#</a> 移动端适配方案有哪几种</h2> <h2 id="async-await-和-promise-之间优缺点"><a href="#async-await-和-promise-之间优缺点" class="header-anchor">#</a> async await 和 promise 之间优缺点</h2> <h3 id="async-await-优点"><a href="#async-await-优点" class="header-anchor">#</a> async/await 优点</h3> <ul><li>它做到了真正的串行的同步写法，代码阅读相对容易</li> <li>对于条件语句和其他流程语句比较友好，可以直接写到判断条件里面</li> <li>处理复杂流程时，在代码清晰度方面有优势</li></ul> <h3 id="async-await-缺点"><a href="#async-await-缺点" class="header-anchor">#</a> async/await 缺点</h3> <ul><li>无法处理 promise 返回的 reject 对象，要借助 try…catch…</li> <li>用 await 可能会导致性能问题，因为 await 会阻塞代码，也许之后的异步代码并不依赖于前者，但仍然需要等待前者完成，导致代码失去了并发性。</li> <li>try…catch…内部的变量无法传递给下一个 try…catch…,Promise 和 then/catch 内部定义的变量，能通过 then 链条的参数传递到下一个 then/catch，但是 async/await 的 try 内部的变量，如果用let和const定义则无法传递到下一个 try…catch…，只能在外层作用域先定义好。</li></ul> <h3 id="promise-的一些问题"><a href="#promise-的一些问题" class="header-anchor">#</a> promise 的一些问题</h3> <ul><li>一旦执行，无法中途取消，链式调用多个 then 中间不能随便跳出来</li> <li>错误无法在外部被捕捉到，只能在内部进行预判处理，如果不设置回调函数，Promise 内部抛出的错误，不会反应到外部</li> <li>Promise 内部如何执行，监测起来很难，当处于 pending 状态时，无法得知目前进展到哪一个阶段（刚刚开始还是即将完成）</li></ul> <h2 id="es6-中新增内容-symbol、proxy、object-is-、in、object-assign"><a href="#es6-中新增内容-symbol、proxy、object-is-、in、object-assign" class="header-anchor">#</a> es6 中新增内容，symbol、proxy、Object.is(===)、in、Object.assign</h2> <h3 id="object-is-与-区别"><a href="#object-is-与-区别" class="header-anchor">#</a> Object.is 与 === 区别</h3> <p>严格相等检查和 Object.is() 之间的区别在于，如何处理 NaN 和如何处理负零 -0。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">-</span><span class="token number">0</span> <span class="token operator">===</span> <span class="token operator">+</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token number">NaN</span> <span class="token operator">===</span> <span class="token number">NaN</span><span class="token punctuation">;</span> <span class="token comment">// false</span>

Object<span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">+</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
Object<span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">,</span> <span class="token number">NaN</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><h3 id="in-运算符"><a href="#in-运算符" class="header-anchor">#</a> in 运算符</h3> <p>如果指定的属性在指定的对象或其原型链中，则in 运算符返回 true。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> car <span class="token operator">=</span> <span class="token punctuation">{</span> make<span class="token operator">:</span> <span class="token string">'Honda'</span><span class="token punctuation">,</span> model<span class="token operator">:</span> <span class="token string">'Accord'</span><span class="token punctuation">,</span> year<span class="token operator">:</span> <span class="token number">1998</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'make'</span> <span class="token keyword">in</span> car<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// expected output: true</span>

<span class="token keyword">delete</span> car<span class="token punctuation">.</span>make<span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'make'</span> <span class="token keyword">in</span> car <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  car<span class="token punctuation">.</span>make <span class="token operator">=</span> <span class="token string">'Suzuki'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>car<span class="token punctuation">.</span>make<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// expected output: &quot;Suzuki&quot;</span>
</code></pre></div><ul><li>语法</li></ul> <blockquote><p>prop in object</p></blockquote> <p>prop: 一个字符串类型或者 symbol 类型的属性名或者数组索引（非symbol类型将会强制转为字符串）。
objectName: 检查它（或其原型链）是否包含具有指定名称的属性的对象。</p> <h2 id="如何去重"><a href="#如何去重" class="header-anchor">#</a> 如何去重</h2> <h3 id="双重循环"><a href="#双重循环" class="header-anchor">#</a> 双重循环</h3> <p>实现 1：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">unique</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> newArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> isRepeat<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    isRepeat <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> newArray<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> newArray<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        isRepeat <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isRepeat<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      newArray<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> newArray<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>实现 2：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">unique</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> newArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> isRepeat<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    isRepeat <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        isRepeat <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isRepeat<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      newArray<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> newArray<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="array-prototype-indexof"><a href="#array-prototype-indexof" class="header-anchor">#</a> Array.prototype.indexOf()</h3> <p>基本思路：如果索引不是第一个索引，说明是重复值。</p> <p>实现一：</p> <ul><li>利用 Array.prototype.filter() 过滤功能</li> <li>Array.prototype.indexOf() 返回的是第一个索引值</li> <li>只将数组中元素第一次出现的返回</li> <li>之后出现的将被过滤掉</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">unique1</span> <span class="token operator">=</span> <span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> item<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">i<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">===</span> index<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="array-prototype-sort"><a href="#array-prototype-sort" class="header-anchor">#</a> Array.prototype.sort()</h3> <p>基本思路：先对原数组进行排序，然后再进行元素比较。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">unique3</span> <span class="token operator">=</span> <span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> newArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  item<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> item<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!==</span> item<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      newArray<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> newArray
<span class="token punctuation">}</span>
</code></pre></div><h3 id="array-prototype-includes"><a href="#array-prototype-includes" class="header-anchor">#</a> Array.prototype.includes()</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">unique4</span> <span class="token operator">=</span> <span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> newArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> item<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>newArray<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      newArray<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> newArray
<span class="token punctuation">}</span>
</code></pre></div><h3 id="array-prototype-reduce"><a href="#array-prototype-reduce" class="header-anchor">#</a> Array.prototype.reduce()</h3> <div class="language-js extra-class"><pre class="language-js"><code>onst <span class="token function-variable function">unique</span> <span class="token operator">=</span> <span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> item<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">init<span class="token punctuation">,</span> current</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>init<span class="token punctuation">,</span> current<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>init<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">||</span> init<span class="token punctuation">[</span>init<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!==</span> current<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      init<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> init
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="set"><a href="#set" class="header-anchor">#</a> Set</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">unique4</span> <span class="token operator">=</span> <span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><h3 id="map"><a href="#map" class="header-anchor">#</a> Map</h3> <p>实现一：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">unique</span> <span class="token operator">=</span> <span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> newArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> item<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tmp<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      tem<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      newArray<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> newArray
<span class="token punctuation">}</span>
</code></pre></div><p>实现二：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">unique</span> <span class="token operator">=</span> <span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> item<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">i</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">!</span>tmp<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> tmp<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="map、for-in、for-of、filter-等等区别"><a href="#map、for-in、for-of、filter-等等区别" class="header-anchor">#</a> map、for in、for of、filter 等等区别</h2> <h2 id="深拷贝、浅拷贝、遇到循环引用如何处理"><a href="#深拷贝、浅拷贝、遇到循环引用如何处理" class="header-anchor">#</a> 深拷贝、浅拷贝、遇到循环引用如何处理</h2> <h2 id="原型链、继承、作用域"><a href="#原型链、继承、作用域" class="header-anchor">#</a> 原型链、继承、作用域</h2> <h2 id="async-await-执行顺序"><a href="#async-await-执行顺序" class="header-anchor">#</a> async/await 执行顺序</h2> <p>如下代码：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 start'</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 end'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async2'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script start'</span><span class="token punctuation">)</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setTimeout'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise1'</span><span class="token punctuation">)</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise2'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script end'</span><span class="token punctuation">)</span>
</code></pre></div><p>执行结果：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// script start</span>
<span class="token comment">// async1 start</span>
<span class="token comment">// async2</span>
<span class="token comment">// promise1</span>
<span class="token comment">// script end</span>
<span class="token comment">// async1 end</span>
<span class="token comment">// promise2</span>
<span class="token comment">// setTimeout</span>
</code></pre></div><ol><li>首先执行整体代码，打印 script start</li> <li>遇到 async1() 执行函数；打印 async1 start；然后执行 async2() 函数；打印 async2；await 后面的代码放到微任务执行（类似 promise then 里面的内容）；</li> <li>然后执行 new Promise，打印 promise1；</li> <li>首次宏任务执行完毕，打印 script end；</li> <li>然后执行微任务，从头开始，第一位微任务打印 async1 end，然后就是 Promise 里面的 promise2；微任务执行完毕；</li> <li>执行宏任务；settimeout 中打印 setTimeout；执行完毕；</li></ol> <h2 id="前端性能优化"><a href="#前端性能优化" class="header-anchor">#</a> 前端性能优化</h2> <blockquote><p>https://juejin.cn/post/6981673766178783262#heading-7</p></blockquote> <h2 id="fetch-api"><a href="#fetch-api" class="header-anchor">#</a> fetch api</h2> <h2 id="dom-操作如何优化"><a href="#dom-操作如何优化" class="header-anchor">#</a> dom 操作如何优化</h2> <h3 id="减少在循环内进行-dom-操作-在循环外部进行-dom-缓存"><a href="#减少在循环内进行-dom-操作-在循环外部进行-dom-缓存" class="header-anchor">#</a> 减少在循环内进行 DOM 操作，在循环外部进行 DOM 缓存</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//优化前代码</span>
<span class="token keyword">function</span> <span class="token function">Loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token string">'loop1'</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> count <span class="token operator">&lt;</span> <span class="token number">15000</span><span class="token punctuation">;</span> count<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> <span class="token string">'dom'</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token string">'loop1'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 优化后代码</span>
<span class="token keyword">function</span> <span class="token function">Loop2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token string">'loop2'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> content <span class="token operator">=</span> <span class="token string">''</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> count <span class="token operator">&lt;</span> <span class="token number">15000</span><span class="token punctuation">;</span> count<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    content <span class="token operator">+=</span> <span class="token string">'dom'</span>
  <span class="token punctuation">}</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'text2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> content
  console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token string">'loop2'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>优化前的代码中，每进行一次循环，都会读取一次 div 的 innerHtml 属性，并且对这个属性进行了重新赋值，即每循环一次就会操作两次DOM，因此执行时间很长，页面性能差。</p> <p>在优化后的代码中，将要更新的 DOM 内容进行缓存，在循环时只操作字符串，循环结束后字符串的值写入到 div 中，只进行了一次查找innerHtml 属性和一次对该属性重新赋值的操作，因此同样的循环次数先，优化后的方法执行时间远远少于优化前。</p> <h3 id="操作-dom-前-先把-dom-节点删除或隐藏"><a href="#操作-dom-前-先把-dom-节点删除或隐藏" class="header-anchor">#</a> 操作 DOM 前，先把 DOM 节点删除或隐藏</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> list1 <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.list1'</span><span class="token punctuation">)</span>
list1<span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">15000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> item <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">)</span>
  item<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  list1<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
list1<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>display 属性值为 none 的元素不在渲染树中，因此对隐藏的元素操作不会引发其他元素的重排。如果要对一个元素进行多次DOM操作，可以先将其隐藏，操作完成后再显示。这样只在隐藏和显示时触发2次重排，而不会是在每次进行操作时都出发一次重排。</p> <h3 id="最小化重绘和重排"><a href="#最小化重绘和重排" class="header-anchor">#</a> 最小化重绘和重排</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//优化前代码</span>
<span class="token keyword">const</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'mydiv'</span><span class="token punctuation">)</span>
element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token string">'100px'</span><span class="token punctuation">;</span>
element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>borderLeft <span class="token operator">=</span> <span class="token string">'1px'</span> 
element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>padding <span class="token operator">=</span> <span class="token string">'20px'</span>
</code></pre></div><p>在上面的代码中，每对 element 进行一次样式更改都会影响该元素的集合结构，最糟糕情况下会触发三次重排。
优化方式：利用 js 或 jquery 对该元素的 class 重新赋值，获得新的样式，这样减少了多次的 DOM 操作。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//优化后代码</span>
<span class="token comment">// js 操作</span>
<span class="token punctuation">.</span>newStyle <span class="token punctuation">{</span>  
  height<span class="token operator">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  
  border<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">1</span>px<span class="token punctuation">;</span>  
  padding<span class="token operator">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
element<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">'newStyle'</span>

<span class="token comment">// jquery 操作</span>
<span class="token function">$</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  height<span class="token operator">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  
  border<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">1</span>px<span class="token punctuation">;</span>  
  padding<span class="token operator">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="减少访问"><a href="#减少访问" class="header-anchor">#</a> 减少访问</h3> <p>减少访问次数自然是想到缓存元素，但是要注意：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> ele <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'ele'</span><span class="token punctuation">)</span>
</code></pre></div><p>这样并不是对 ele 进行缓存，每一次调用 ele 还是相当于访问了一次 id 为 ele 的节点。</p> <h3 id="改变选择器"><a href="#改变选择器" class="header-anchor">#</a> 改变选择器</h3> <p>获取元素最常见的有两种方法，getElementsByXXX() 和 queryselectorAll()，这两种选择器区别是很大的，前者是获取动态集合，后者是获取静态集合，举个例子。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 假设一开始有 2 个 li</span>
<span class="token keyword">const</span> lis <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">)</span> <span class="token comment">// 动态集合</span>
<span class="token keyword">const</span> ul <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'ul'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
 
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>lis<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
  <span class="token keyword">const</span> newLi <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">)</span>
  ul<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>newLi<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 输出结果：2， 3， 4</span>
<span class="token comment">// 优化后</span>
<span class="token keyword">const</span> lis <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">)</span> <span class="token comment">// 静态集合 </span>
<span class="token keyword">const</span> ul <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'ul'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
 
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>lis<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
  <span class="token keyword">const</span> newLi <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">)</span>
  ul<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>newLi<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 输出结果：2， 2， 2</span>
</code></pre></div><p>对静态集合的操作不会引起对文档的重新查询，相比于动态集合更加优化。</p> <h3 id="事件委托"><a href="#事件委托" class="header-anchor">#</a> 事件委托</h3> <p>js 中的事件函数都是对象，如果事件函数过多会占用大量内存，而且绑定事件的 DOM 元素越多会增加访问 dom 的次数，对页面的交互就绪时间也会有延迟。所以诞生了事件委托，事件委托是利用了事件冒泡，只指定一个事件处理程序就可以管理某一类型的所有事件。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 事件委托前</span>
<span class="token keyword">const</span> lis <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> lis<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  lis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>    

<span class="token comment">// 事件委托后</span>
<span class="token keyword">const</span> ul <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'ul'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
ul<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="documentfragment"><a href="#documentfragment" class="header-anchor">#</a> DocumentFragment</h3> <p>createDocumentFragment() 方法是用了创建一个虚拟的节点对象，或者说，是用来创建文档碎片节点。它可以包含各种类型的节点，在创建之初是空的。</p> <p>DocumentFragment 节点不属于文档树，继承的 parentNode 属性总是 null。它有一个很实用的特点，当请求把一个 DocumentFragment节点插入文档树时，插入的不是 DocumentFragment 自身，而是它的所有子孙节点。 这个特性使得 DocumentFragment 成了占位符，暂时存放那些一次插入文档的节点</p> <p>另外，当需要添加多个 dom 元素时，如果先将这些元素添加到 DocumentFragment 中，再统一将 DocumentFragment 添加到页面，会减少页面渲染 dom 的次数，效率会明显提升。
使用方法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> frag <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createDocumentFragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 创建一个 DOM 片段		</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>				
  <span class="token keyword">const</span> li <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">)</span>
  li<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> i	
  frag<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>li<span class="token punctuation">)</span> <span class="token comment">//将li元素加到文档碎片上	</span>
<span class="token punctuation">}</span> 			
ul<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>frag<span class="token punctuation">)</span> <span class="token comment">//将文档碎片加到 ul 上</span>
</code></pre></div><h2 id="如何计算首屏时间以及优化"><a href="#如何计算首屏时间以及优化" class="header-anchor">#</a> 如何计算首屏时间以及优化</h2> <p>主要是通过 Window.performance 来实现计算，Web Performance API 允许网页访问某些函数来测量网页和 Web 应用程序的性能；</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>performance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> performance <span class="token operator">=</span> window<span class="token punctuation">.</span>performance<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>performance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> t <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">getEntriesByType</span><span class="token punctuation">(</span><span class="token string">'navigation'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
      <span class="token keyword">let</span> r <span class="token operator">=</span> <span class="token number">0</span>

      t <span class="token operator">||</span> <span class="token punctuation">(</span>r <span class="token operator">=</span> <span class="token punctuation">(</span>t <span class="token operator">=</span> performance<span class="token punctuation">.</span>timing<span class="token punctuation">)</span><span class="token punctuation">.</span>navigationStart<span class="token punctuation">)</span>
        <span class="token keyword">const</span> details <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
            key<span class="token operator">:</span> <span class="token string">&quot;Redirect&quot;</span><span class="token punctuation">,</span>
            desc<span class="token operator">:</span> <span class="token string">&quot;网页重定向的耗时&quot;</span><span class="token punctuation">,</span>
            value<span class="token operator">:</span> t<span class="token punctuation">.</span>redirectEnd <span class="token operator">-</span> t<span class="token punctuation">.</span>redirectStart
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
              key<span class="token operator">:</span> <span class="token string">&quot;AppCache&quot;</span><span class="token punctuation">,</span>
              desc<span class="token operator">:</span> <span class="token string">&quot;检查本地缓存的耗时&quot;</span><span class="token punctuation">,</span>
              value<span class="token operator">:</span> t<span class="token punctuation">.</span>domainLookupStart <span class="token operator">-</span> t<span class="token punctuation">.</span>fetchStart
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
              key<span class="token operator">:</span> <span class="token string">&quot;DNS&quot;</span><span class="token punctuation">,</span>
              desc<span class="token operator">:</span> <span class="token string">&quot;DNS查询的耗时&quot;</span><span class="token punctuation">,</span>
              value<span class="token operator">:</span> t<span class="token punctuation">.</span>domainLookupEnd <span class="token operator">-</span> t<span class="token punctuation">.</span>domainLookupStart
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
              key<span class="token operator">:</span> <span class="token string">&quot;TCP&quot;</span><span class="token punctuation">,</span>
              desc<span class="token operator">:</span> <span class="token string">&quot;TCP连接的耗时&quot;</span><span class="token punctuation">,</span>
              value<span class="token operator">:</span> t<span class="token punctuation">.</span>connectEnd <span class="token operator">-</span> t<span class="token punctuation">.</span>connectStart
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
              key<span class="token operator">:</span> <span class="token string">&quot;Waiting(TTFB)&quot;</span><span class="token punctuation">,</span>
              desc<span class="token operator">:</span> <span class="token string">&quot;从客户端发起请求到接收到响应的时间 / Time To First Byte&quot;</span><span class="token punctuation">,</span>
              value<span class="token operator">:</span> t<span class="token punctuation">.</span>responseStart <span class="token operator">-</span> t<span class="token punctuation">.</span>requestStart
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
              key<span class="token operator">:</span> <span class="token string">&quot;Content Download&quot;</span><span class="token punctuation">,</span>
              desc<span class="token operator">:</span> <span class="token string">&quot;下载服务端返回数据的时间&quot;</span><span class="token punctuation">,</span>
              value<span class="token operator">:</span> t<span class="token punctuation">.</span>responseEnd <span class="token operator">-</span> t<span class="token punctuation">.</span>responseStart
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
              key<span class="token operator">:</span> <span class="token string">&quot;HTTP Total Time&quot;</span><span class="token punctuation">,</span>
              desc<span class="token operator">:</span> <span class="token string">&quot;http请求总耗时&quot;</span><span class="token punctuation">,</span>
              value<span class="token operator">:</span> t<span class="token punctuation">.</span>responseEnd <span class="token operator">-</span> t<span class="token punctuation">.</span>requestStart
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
              key<span class="token operator">:</span> <span class="token string">&quot;DOMContentLoaded&quot;</span><span class="token punctuation">,</span>
              desc<span class="token operator">:</span> <span class="token string">&quot;dom加载完成的时间&quot;</span><span class="token punctuation">,</span>
              value<span class="token operator">:</span> t<span class="token punctuation">.</span>domContentLoadedEventEnd <span class="token operator">-</span> r
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
              key<span class="token operator">:</span> <span class="token string">&quot;Loaded&quot;</span><span class="token punctuation">,</span>
              desc<span class="token operator">:</span> <span class="token string">&quot;页面load的总耗时&quot;</span><span class="token punctuation">,</span>
              value<span class="token operator">:</span> t<span class="token punctuation">.</span>loadEventEnd <span class="token operator">-</span> r
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
              key<span class="token operator">:</span> <span class="token string">&quot;FirstContentful&quot;</span><span class="token punctuation">,</span>
              desc<span class="token operator">:</span> <span class="token string">&quot;首屏时间&quot;</span><span class="token punctuation">,</span>
              value<span class="token operator">:</span> performance<span class="token punctuation">.</span><span class="token function">getEntriesByName</span><span class="token punctuation">(</span><span class="token string">&quot;first-contentful-paint&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>startTime <span class="token operator">-</span> r
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
              key<span class="token operator">:</span> <span class="token string">&quot;Full&quot;</span><span class="token punctuation">,</span>
              desc<span class="token operator">:</span> <span class="token string">&quot;白屏时间&quot;</span><span class="token punctuation">,</span>
              value<span class="token operator">:</span> t<span class="token punctuation">.</span>responseStart <span class="token operator">-</span> r
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
  
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>details<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="script-中-async-以及-defer"><a href="#script-中-async-以及-defer" class="header-anchor">#</a> script 中 async 以及 defer</h2> <h3 id="普通的-script-加载"><a href="#普通的-script-加载" class="header-anchor">#</a> 普通的 script 加载</h3> <p>例如 <code>&lt;link rel=&quot;preload&quot;&gt;</code>。这些显式指定的预加载资源，也会被放入 memory cache 中。</p> <p>前端性能优化的一条原则是将 script 标签放在 body 底部，为什么呢？因为 script 标签的加载和执行时会阻塞 DOM 结构渲染的，若是 script 标签放在头部，加载时间或者执行时间过长，会影响后续 DOM 的渲染，造成很长时间的页面白屏，前端体验会变得很差。
那么我们不妨亲自试一试？</p> <p>为了使例子更加直观，直接用 nodejs 写一个服务。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// a.js</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;我是外部a.js文件&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// b.js</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;我是外部b.js文件&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//server.js</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> a <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">&quot;./a.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">&quot;./b.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">serverBack</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> req<span class="token punctuation">.</span>url<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>url <span class="token operator">===</span> <span class="token string">&quot;/a.js&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/javascript; charset=UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">9000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>url <span class="token operator">===</span> <span class="token string">&quot;/b.js&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/javascript; charset=UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>serverBack<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3003</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>a.js 和 b.js 代码中都获取一下当前执行时间的时间戳，在 server.js 中读取两个文件的代码，若是访问相应的文件，返回即可，a.js 延迟 9s 返回，b.js 延迟 5s 返回，这样时间体验上会更清晰。
在前端的 html 文件中直接通过 script 标签引入:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IE=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>123213<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;内部script文件&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;上&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://localhost:3003/a.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://localhost:3003/b.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;内部script文件&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;下&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    所有有脚本下面的内容
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>那么，直接运行这个 html 文件，控制台打印的最终结果为：</p> <p><img src="/note/assets/img/script1.97c466f7.png" alt="在这里插入图片描述"></p> <p>可以看出来，内部上边的 script 标签的最先被执行，然后大约 9s 后基本上是同时执行了外部引入的 a.js、b.js 和内部下边的 script 标签。执行内部最下边的 script 的几乎同时渲染出最下面的 dom 结构（可以看到 script 的加载会阻塞 dom 的渲染）；那么它们三个的执行顺序是随机的吗？</p> <p>当然不是！不管刷新多少次，它们的执行顺序是永远不会改变的，永远是 a.js-&gt;b.js-&gt; 内部下边的 script 标签。我们在 server 端设置的 b.js 文件是 5s 返回结果，那么 b.js 文件肯定是先下载完的，可是会永远先执行 a.js 文件。
这是因为 <code>&lt;script&gt;</code> 标签是并发下载，同步执行的，也就是说，不管引入多少个外部 script 标签，它们都会异步去下载，但是下载完成后，会按照标签的顺序同步执行，这也是为什么 <code>&lt;script&gt;</code> 阻塞 DOM 渲染的原因。</p> <p>那么外部 js 文件中是异步代码呢？</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// a.js</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;我是外部a.js文件&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;我是外部a.js文件&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;setTimeout&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">6000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// b.js</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;我是外部b.js文件&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;我是外部b.js文件&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;setTimeout&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>我们来看一下运行结果：</p> <p><img src="/note/assets/img/script2.76aae448.png" alt="在这里插入图片描述"></p> <p>可以得出结论，a.js 和 b.js 文件依然会按照同步顺序执行，然后渲染出 dom；但是对于异步任务，也是遵循 eventloop 机制，将异步任务放入异步队列中去执行，内部 script 标签并不会等待异步任务执行完。</p> <p>⚠️defer 和 async 属性只适用于外部引入的 js 文件</p> <h3 id="defer-延迟脚本"><a href="#defer-延迟脚本" class="header-anchor">#</a> defer 延迟脚本</h3> <p>现在我们来给外部的两个script标签加上defer属性：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IE=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>123213<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;内部script文件&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;上&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://localhost:3003/a.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defer</span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://localhost:3003/b.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defer</span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;内部script文件&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;下&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    所有有脚本下面的内容
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>执行结果：</p> <p><img src="/note/assets/img/script4.6a8b6309.png" alt="在这里插入图片描述"></p> <p>可以看出来，dom 是首先渲染出来的；内部的 script 标签中的代码并没有等 a.js 和 b.js 文件全部执行下载完就执行了，这也就是 defer 属性的延迟执行功能。虽然是延迟执行，但两个文件执行的先后顺序并不能改变。所以 defer 属性是并发下载，延迟同步执行，不会阻塞 DOM 渲染。
在《javascript 高级程序设计》中，原话是这样的：
HTML5 规范要求脚本按照它们出现的先后顺序执行，因此第一个延迟脚本会先于第二个执行。在现实中，延迟脚本并不一定会按照顺序执行，因此最好只包含一个延迟脚本。
本文中的浏览器是 Chrome，在 FirFox 和 Safari 中也尝试了一下，结果并没有发生改变。猜测作者是考虑到某些低版本浏览器没有做到严格的规范，才出此言。</p> <h3 id="async-异步脚本"><a href="#async-异步脚本" class="header-anchor">#</a> async 异步脚本</h3> <p>如下代码：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IE=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>123213<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;内部script文件&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;上&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://localhost:3003/a.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">async</span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://localhost:3003/b.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">async</span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;内部script文件&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;下&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    所有有脚本下面的内容
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>执行结果如下：</p> <p><img src="/note/assets/img/script3.a79dbc1c.png" alt="在这里插入图片描述"></p> <p>可以看出，内部下边的 script 标签中代码也没有等到 a.js 和 b.js 执行完就已经执行了。通过 b.js 的执行时间可以看出，b.js 文件是下载完立即执行的，并没有等待 a.js 执行完。所以 anync 属性是并发下载，异步执行，也不会阻塞 DOM 渲染。</p> <h3 id="总结-3"><a href="#总结-3" class="header-anchor">#</a> 总结</h3> <ul><li>script 标签加载都是并发加载，这是浏览器提供的功能。但是执行是按照标签写入顺序同步执行，异步代码遵循 eventloop。</li> <li>defer 属性是延迟同步执行，也就是等到 html 文档解析到<code>&lt;/html&gt;</code>时才会回过头看 script 脚本是否全部下载完成？若是下载完成则按照顺序同步执行，否则继续等待所有标签下载完成在执行。</li> <li>async 属性是异步执行，也就是 script 脚本什么时候下载完，什么时候执行。</li></ul> <blockquote><p>https://juejin.cn/post/6913156226008711182</p></blockquote> <h2 id="includes-与-indexof"><a href="#includes-与-indexof" class="header-anchor">#</a> includes 与 indexOf</h2> <p>都是可以判断属性是否在数组中；区别</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">[</span><span class="token number">NaN</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token punctuation">[</span><span class="token number">NaN</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">)</span> <span class="token comment">// -1</span>
</code></pre></div><h2 id="slice-与-splice-之前的区别"><a href="#slice-与-splice-之前的区别" class="header-anchor">#</a> slice 与 splice 之前的区别</h2> <h3 id="slice"><a href="#slice" class="header-anchor">#</a> slice</h3> <p>slice(start,end)：方法可从已有数组中返回选定的元素，返回一个新数组，包含从 start 到 end（不包含该元素）的数组元素。</p> <blockquote><p>注意：该方法不会改变原数组，而是返回一个子数组，如果想删除数组中的一段元素，应该使用 Array.splice() 方法。</p></blockquote> <ul><li>start 参数：必须，规定从何处开始选取，如果为负数，规定从数组尾部算起的位置，-1 是指最后一个元素。</li> <li>end 参数：可选（如果该参数没有指定，那么切分的数组包含从 start 倒数组结束的所有元素，如果这个参数为负数，那么规定是从数组尾部开始算起的元素）。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//[2,3,4,5] 选择序列号从1到最后的所有元素组成的新数组。</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//[2,3] 不包含end，序列号为3的元素</span>
</code></pre></div><h3 id="splice"><a href="#splice" class="header-anchor">#</a> splice</h3> <p>该方法向或者从数组中添加或者删除项目，返回被删除的项目。（该方法会改变原数组）</p> <p>splice（index,howmany,item1,...itemX）</p> <ul><li>inde 参数：必须，整数，规定添加或者删除的位置，使用负数，从数组尾部规定位置。</li> <li>howmany 参数：必须，要删除的数量，如果为 0，则不删除项目。</li> <li>tem1,...itemX 参数：可选，向数组添加的新项目。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//[3] 返回的新数组</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//[1, 2, &quot;hello&quot;, 4, 5] 改变了原数组</span>
</code></pre></div><h2 id="扩展运算符"><a href="#扩展运算符" class="header-anchor">#</a> 扩展运算符</h2> <h3 id="使用扩展运算符可以快速扁平化二维数组"><a href="#使用扩展运算符可以快速扁平化二维数组" class="header-anchor">#</a> 使用扩展运算符可以快速扁平化二维数组</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> flatArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token operator">...</span>arr<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>flatArr<span class="token punctuation">)</span> <span class="token comment">// [1, 2, 3, 4, 5]</span>
</code></pre></div><p>使用递归，可以扁平化任意多维数组：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">flattenArray</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> flatArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token operator">...</span>arr<span class="token punctuation">)</span>
  <span class="token keyword">return</span> flatArr<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">flattenArray</span><span class="token punctuation">(</span>flatArr<span class="token punctuation">)</span> <span class="token operator">:</span> flatArr
<span class="token punctuation">}</span>

<span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token function">flattenArray</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token comment">// [1, 2, 3, 4, 5, 6, 7]</span>
</code></pre></div><h2 id="indexdb"><a href="#indexdb" class="header-anchor">#</a> indexDB</h2> <p>IndexedDB 是一种使用浏览器存储大量数据的方法.它创造的数据可以被查询，并且可以离线使用. IndexedDB 对于那些需要存储大量数据，或者是需要离线使用的程序是非常有效的解决方法。</p> <p>使用IndexedDB，你可以存储或者获取数据，使用一个 key 索引的。 你可以在事务(transaction)中完成对数据的修改。和大多数 web 存储解决方案相同，indexedDB 也遵从同源协议(same-origin policy). 所以你只能访问同域中存储的数据，而不能访问其他域的。</p> <p>API 包含异步(asynchronous) API 和同步(synchronous)API两种。异步 API 适合大多数情况, 同步API必须同 WebWorkers 一同使用. 目前，没有主流浏览器支持同步 API。 即使同步 API 被支持了，你也会在大多数的情况使用异步 API。</p> <h3 id="创建一个-indexeddb-数据库"><a href="#创建一个-indexeddb-数据库" class="header-anchor">#</a> 创建一个 indexedDB 数据库</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> request <span class="token operator">=</span> indexedDB<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'myDatabase'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

request<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'success'</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;连接数据库成功&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

request<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;连接数据库失败&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="创建一个对象仓库"><a href="#创建一个对象仓库" class="header-anchor">#</a> 创建一个对象仓库</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> request <span class="token operator">=</span> indexedDB<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'myDatabase'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

request<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'upgradeneeded'</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> db <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result
  <span class="token keyword">const</span>  store <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">createObjectStore</span><span class="token punctuation">(</span><span class="token string">'Users'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>keyPath<span class="token operator">:</span> <span class="token string">'userId'</span><span class="token punctuation">,</span> autoIncrement<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'创建对象仓库成功'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="操作数据"><a href="#操作数据" class="header-anchor">#</a> 操作数据</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 添加数据</span>
<span class="token keyword">const</span> request <span class="token operator">=</span> indexedDB<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'myDatabase'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>

request<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'success'</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> db <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result
  <span class="token keyword">const</span> tx <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token string">'Users'</span><span class="token punctuation">,</span><span class="token string">'readwrite'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> store <span class="token operator">=</span> tx<span class="token punctuation">.</span><span class="token function">objectStore</span><span class="token punctuation">(</span><span class="token string">'Users'</span><span class="token punctuation">)</span>
  <span class="token comment">// 保存数据</span>
  <span class="token keyword">const</span> reqAdd <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'userId'</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'userName'</span><span class="token operator">:</span> <span class="token string">'李白'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  reqAdd<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'success'</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'保存成功'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 获取数据</span>
<span class="token keyword">const</span> request <span class="token operator">=</span> indexedDB<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'myDatabase'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>

request<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'success'</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> db <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result
  <span class="token keyword">const</span> tx <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token string">'Users'</span><span class="token punctuation">,</span><span class="token string">'readwrite'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> store <span class="token operator">=</span> tx<span class="token punctuation">.</span><span class="token function">objectStore</span><span class="token punctuation">(</span><span class="token string">'Users'</span><span class="token punctuation">)</span>
  <span class="token comment">// 获取数据</span>
  <span class="token keyword">const</span> reqGet <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  reqGet<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'success'</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>result<span class="token punctuation">.</span>userName<span class="token punctuation">)</span><span class="token comment">// 李白</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 删除数据</span>
<span class="token keyword">const</span> request <span class="token operator">=</span> indexedDB<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'myDatabase'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>

request<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'success'</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> db <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result
  <span class="token keyword">const</span> tx <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token string">'Users'</span><span class="token punctuation">,</span><span class="token string">'readwrite'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> store <span class="token operator">=</span> tx<span class="token punctuation">.</span><span class="token function">objectStore</span><span class="token punctuation">(</span><span class="token string">'Users'</span><span class="token punctuation">)</span>
  <span class="token comment">// 删除数据</span>
  <span class="token keyword">const</span> reqDelete <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  reqDelete<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'success'</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'删除数据成功'</span><span class="token punctuation">)</span><span class="token comment">// 李白</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="javascript-空值合并操作符"><a href="#javascript-空值合并操作符" class="header-anchor">#</a> javaScript 空值合并操作符</h2> <p>只有当左侧为 null 和 undefined 时，才会返回右侧的数</p> <ul><li>空值合并操作符（??）是一个逻辑操作符，当左侧的操作数为 null 或者 undefined 时，返回其右侧操作数，否则返回左侧操作数。</li> <li>与逻辑或操作符（||）不同，逻辑或操作符会在左侧操作数为假值时返回右侧操作数。也就是说，如果使用 || 来为某些变量设置默认值，可能会遇到意料之外的行为。比如为假值（例如，'' 或 0）时。见下面的例子。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token keyword">undefined</span>
<span class="token keyword">let</span> result <span class="token operator">=</span> str <span class="token operator">??</span> <span class="token string">'你真好看'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token comment">// 你真好看</span>

<span class="token keyword">const</span> nullValue <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token keyword">const</span> emptyText <span class="token operator">=</span> <span class="token string">&quot;&quot;</span> <span class="token comment">// 空字符串，是一个假值，Boolean(&quot;&quot;) === false</span>
<span class="token keyword">const</span> someNumber <span class="token operator">=</span> <span class="token number">42</span>

<span class="token keyword">const</span> valA <span class="token operator">=</span> nullValue <span class="token operator">??</span> <span class="token string">'valA 的默认值'</span>
<span class="token keyword">const</span> valB <span class="token operator">=</span> emptyText <span class="token operator">??</span> <span class="token string">'valB 的默认值'</span>
<span class="token keyword">const</span> valC <span class="token operator">=</span> someNumber <span class="token operator">??</span> <span class="token number">0</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>valA<span class="token punctuation">)</span> <span class="token comment">// &quot;valA 的默认值&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>valB<span class="token punctuation">)</span> <span class="token comment">// &quot;&quot;（空字符串虽然是假值，但不是 null 或者 undefined）</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>valC<span class="token punctuation">)</span> <span class="token comment">// 42</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新:</span> <span class="time">7/12/2021, 12:14:08 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/note/javascript/几种循环.html" class="prev">
        几种循环
      </a></span> <span class="next"><a href="/note/javascript/css面试.html">
        css面试
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/note/assets/js/app.488c70a4.js" defer></script><script src="/note/assets/js/3.38c21980.js" defer></script><script src="/note/assets/js/7.0a11c70e.js" defer></script>
  </body>
</html>
