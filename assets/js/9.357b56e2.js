(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{371:function(t,a,s){t.exports=s.p+"assets/img/webglxuanran.e524ef1a.png"},372:function(t,a,s){t.exports=s.p+"assets/img/weglxuanranguocheng.35a20b95.png"},373:function(t,a,s){t.exports=s.p+"assets/img/glsl.f99a1d4f.png"},498:function(t,a,s){"use strict";s.r(a);var n=s(25),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"webgl-基础"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#webgl-基础"}},[t._v("#")]),t._v(" webGL 基础")]),t._v(" "),n("p",[t._v("我们是通过对 GPU 进行编程，进行渲染图形：对于 GPU 编程主要从下面两个方面进行编程：")]),t._v(" "),n("ul",[n("li",[t._v("webgl：API glTranslate/glRotatef")]),t._v(" "),n("li",[t._v("GLSL：顶点着色器 - gl_Position 和 片元着色器 - gl_FragColor")])]),t._v(" "),n("h3",{attrs:{id:"webgl-渲染管线"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#webgl-渲染管线"}},[t._v("#")]),t._v(" webgl 渲染管线")]),t._v(" "),n("p",[t._v("JavaScript 通过显存的 Buffer 来实现顶点着色器与片元着色器的数据传递。\n"),n("img",{attrs:{src:s(371),alt:"avatar"}})]),t._v(" "),n("p",[t._v("frame Buffer 是帧缓冲区，保存顶点着色器与片元着色器渲染后的结果，可以进行进一步的操作。")]),t._v(" "),n("h3",{attrs:{id:"渲染过程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#渲染过程"}},[t._v("#")]),t._v(" 渲染过程")]),t._v(" "),n("p",[n("img",{attrs:{src:s(372),alt:"avatar"}})]),t._v(" "),n("ol",[n("li",[t._v("传入坐标")]),t._v(" "),n("li",[t._v("计算显示坐标")]),t._v(" "),n("li",[t._v("图元装备（根据坐标，组成图形）")]),t._v(" "),n("li",[t._v("将装备好的图元变成像素的形式；（顶点着色器）")]),t._v(" "),n("li",[t._v("片元着色器对每一个像素点进行渲染")])]),t._v(" "),n("p",[t._v("顶点着色器的作用：将逻辑上的传入的顶点坐标，根据空间上的变换，进行计算屏幕上展示点的坐标。")]),t._v(" "),n("h3",{attrs:{id:"glsl"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#glsl"}},[t._v("#")]),t._v(" GLSL")]),t._v(" "),n("ul",[n("li",[t._v("OpenGL 着色器语言")]),t._v(" "),n("li",[t._v("让开发者可以对渲染过程拥有更多的控制")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(373),alt:"avatar"}})]),t._v(" "),n("blockquote",[n("p",[t._v("GLSL 参考：https://colin1994.github.io/2017/11/11/OpenGLES-Lesson04/")])]),t._v(" "),n("h4",{attrs:{id:"存储限定符"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#存储限定符"}},[t._v("#")]),t._v(" 存储限定符")]),t._v(" "),n("p",[t._v("对于着色器语言，具有三种数据类型：")]),t._v(" "),n("ul",[n("li",[t._v("attribute：只能在 vertex shader 中使用的变量，一般用于传递顶点数据；")]),t._v(" "),n("li",[t._v("uniform：常量，不能被 shader 修改，uniform 变量在 vertex 和 fragment 两者之间声明方式完全一致，则他可以在 vertex 和 fragment 共享使用，相当于一个被 vertex 和 fragment shader 共享的全局变量。")]),t._v(" "),n("li",[t._v("varying：varying 变量是vertex 和 fragment shader 之间做数据传递用的。")])]),t._v(" "),n("p",[t._v("如下代码，声明一个背景色为红色的三角形：")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("var VSHADER_SOURCE, FSHADER_SOURCE\n\nVSHADER_SOURCE "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'attribute vec4 a_Position;"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'")]),t._v(" + \n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'uniform mat4 u_ModelMatrix;"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'")]),t._v(" +\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'uniform mat4 u_ViewMatrix;"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'")]),t._v(" +\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'uniform mat4 u_ProjectionMatrix;"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'")]),t._v(" + \n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'void main () {"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'")]),t._v(" + \n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'gl_Position = u_ProjectionMatrix * u_ViewMatrix * u_ModelMatrix * a_Position;"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'")]),t._v(" + \n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'}"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'")]),t._v("\n\nFSHADER_SOURCE "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'void main () {"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'")]),t._v(" + \n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'")]),t._v(" + \n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'}"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'")]),t._v("\n\n")])])]),n("p",[t._v("也可以直接写在页面 script 标签中：")]),t._v(" "),n("div",{staticClass:"language-html extra-class"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[t._v("    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("notjs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("vertex-shader"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token script"}},[n("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n      # 传入坐标 vec4 是代表一个 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("x4 的浮点型矩阵\n      attribute vec4 a_Position"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      uniform mat4 u_ModelMatrix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      uniform mat4 u_ViewMatrix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      uniform mat4 u_ProjectionMatrix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        # 顶点位置"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("webgl 内置 "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("API")]),t._v("\n        gl_Position "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" u_ProjectionMatrix "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" u_ViewMatrix "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" u_ModelMatrix "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" a_Position"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    ")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("notjs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("fragment-shader"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token script"}},[n("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        # 设置背景色\n        gl_FragColor "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("vec4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    ")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" \n")])])]),n("p",[t._v("然后通过 dom 操作获取内容：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" vertexShaderSource "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vertex-shader'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fragShaderSource "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fragment-shader'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text\n")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);