<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>立方体绘制 | 学习笔记</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="学习笔记">
    <link rel="preload" href="/note/assets/css/0.styles.c9d983ba.css" as="style"><link rel="preload" href="/note/assets/js/app.f3710e1e.js" as="script"><link rel="preload" href="/note/assets/js/2.a05a71ea.js" as="script"><link rel="preload" href="/note/assets/js/6.caa615f9.js" as="script"><link rel="prefetch" href="/note/assets/js/10.a64fa943.js"><link rel="prefetch" href="/note/assets/js/100.b8de88e9.js"><link rel="prefetch" href="/note/assets/js/101.d75b1de8.js"><link rel="prefetch" href="/note/assets/js/102.8d08f712.js"><link rel="prefetch" href="/note/assets/js/103.b87ac91b.js"><link rel="prefetch" href="/note/assets/js/104.e158d7da.js"><link rel="prefetch" href="/note/assets/js/105.2e43fb0c.js"><link rel="prefetch" href="/note/assets/js/106.536b468d.js"><link rel="prefetch" href="/note/assets/js/107.67d90a50.js"><link rel="prefetch" href="/note/assets/js/108.25cee945.js"><link rel="prefetch" href="/note/assets/js/109.e490036d.js"><link rel="prefetch" href="/note/assets/js/11.5bdc95cd.js"><link rel="prefetch" href="/note/assets/js/110.8db368fb.js"><link rel="prefetch" href="/note/assets/js/111.dc7a5cee.js"><link rel="prefetch" href="/note/assets/js/112.fb10b9f8.js"><link rel="prefetch" href="/note/assets/js/113.8d049d1b.js"><link rel="prefetch" href="/note/assets/js/114.15bd48e9.js"><link rel="prefetch" href="/note/assets/js/115.f1115f03.js"><link rel="prefetch" href="/note/assets/js/116.b9fba6f5.js"><link rel="prefetch" href="/note/assets/js/117.a0f0f091.js"><link rel="prefetch" href="/note/assets/js/118.71c1fb29.js"><link rel="prefetch" href="/note/assets/js/119.07a978b6.js"><link rel="prefetch" href="/note/assets/js/12.8b81c3d8.js"><link rel="prefetch" href="/note/assets/js/120.71170567.js"><link rel="prefetch" href="/note/assets/js/121.f7390534.js"><link rel="prefetch" href="/note/assets/js/122.eb3aaeec.js"><link rel="prefetch" href="/note/assets/js/123.e002ffa5.js"><link rel="prefetch" href="/note/assets/js/124.b1a531fc.js"><link rel="prefetch" href="/note/assets/js/125.8f8892be.js"><link rel="prefetch" href="/note/assets/js/126.f473ea15.js"><link rel="prefetch" href="/note/assets/js/127.88d46a48.js"><link rel="prefetch" href="/note/assets/js/128.7e2a5c13.js"><link rel="prefetch" href="/note/assets/js/129.2c63873b.js"><link rel="prefetch" href="/note/assets/js/13.50e4862c.js"><link rel="prefetch" href="/note/assets/js/130.641fa751.js"><link rel="prefetch" href="/note/assets/js/131.74e6ab13.js"><link rel="prefetch" href="/note/assets/js/132.05de29a7.js"><link rel="prefetch" href="/note/assets/js/133.01ead98e.js"><link rel="prefetch" href="/note/assets/js/134.5d51770c.js"><link rel="prefetch" href="/note/assets/js/135.4d37d3bc.js"><link rel="prefetch" href="/note/assets/js/136.b8e969c2.js"><link rel="prefetch" href="/note/assets/js/137.964a7ea0.js"><link rel="prefetch" href="/note/assets/js/138.f3f9a446.js"><link rel="prefetch" href="/note/assets/js/139.cef76862.js"><link rel="prefetch" href="/note/assets/js/14.08c0da27.js"><link rel="prefetch" href="/note/assets/js/15.513243e9.js"><link rel="prefetch" href="/note/assets/js/16.75a49414.js"><link rel="prefetch" href="/note/assets/js/17.27c4032e.js"><link rel="prefetch" href="/note/assets/js/18.0aa1342f.js"><link rel="prefetch" href="/note/assets/js/19.30e88ecd.js"><link rel="prefetch" href="/note/assets/js/20.bb1b3780.js"><link rel="prefetch" href="/note/assets/js/21.86c24ca1.js"><link rel="prefetch" href="/note/assets/js/22.06d35504.js"><link rel="prefetch" href="/note/assets/js/23.12e25dfe.js"><link rel="prefetch" href="/note/assets/js/24.00efff3c.js"><link rel="prefetch" href="/note/assets/js/25.17cb9dc3.js"><link rel="prefetch" href="/note/assets/js/26.4d5d7743.js"><link rel="prefetch" href="/note/assets/js/27.d906d379.js"><link rel="prefetch" href="/note/assets/js/28.8de97cf3.js"><link rel="prefetch" href="/note/assets/js/29.58915b41.js"><link rel="prefetch" href="/note/assets/js/3.e0198381.js"><link rel="prefetch" href="/note/assets/js/30.54104fce.js"><link rel="prefetch" href="/note/assets/js/31.28fe5d0c.js"><link rel="prefetch" href="/note/assets/js/32.1750e77c.js"><link rel="prefetch" href="/note/assets/js/33.a2f30370.js"><link rel="prefetch" href="/note/assets/js/34.a9c3c2a7.js"><link rel="prefetch" href="/note/assets/js/35.39c7241b.js"><link rel="prefetch" href="/note/assets/js/36.eedad454.js"><link rel="prefetch" href="/note/assets/js/37.a2c809b5.js"><link rel="prefetch" href="/note/assets/js/38.10d4ed6c.js"><link rel="prefetch" href="/note/assets/js/39.e8b8db2b.js"><link rel="prefetch" href="/note/assets/js/4.a297dc64.js"><link rel="prefetch" href="/note/assets/js/40.2b5b33ad.js"><link rel="prefetch" href="/note/assets/js/41.2631f175.js"><link rel="prefetch" href="/note/assets/js/42.747be58d.js"><link rel="prefetch" href="/note/assets/js/43.40a7bcbc.js"><link rel="prefetch" href="/note/assets/js/44.3ea40ce5.js"><link rel="prefetch" href="/note/assets/js/45.7a80d7ca.js"><link rel="prefetch" href="/note/assets/js/46.836770a6.js"><link rel="prefetch" href="/note/assets/js/47.a52bdbf6.js"><link rel="prefetch" href="/note/assets/js/48.414dcfe8.js"><link rel="prefetch" href="/note/assets/js/49.d7cefa4e.js"><link rel="prefetch" href="/note/assets/js/5.5b5baac9.js"><link rel="prefetch" href="/note/assets/js/50.56ac26a0.js"><link rel="prefetch" href="/note/assets/js/51.0007e05b.js"><link rel="prefetch" href="/note/assets/js/52.f732e6cb.js"><link rel="prefetch" href="/note/assets/js/53.e474f510.js"><link rel="prefetch" href="/note/assets/js/54.18352a73.js"><link rel="prefetch" href="/note/assets/js/55.1e191d71.js"><link rel="prefetch" href="/note/assets/js/56.62353193.js"><link rel="prefetch" href="/note/assets/js/57.2bb047c7.js"><link rel="prefetch" href="/note/assets/js/58.0cd8fa53.js"><link rel="prefetch" href="/note/assets/js/59.de349ea5.js"><link rel="prefetch" href="/note/assets/js/60.6a8b8c29.js"><link rel="prefetch" href="/note/assets/js/61.c47027d1.js"><link rel="prefetch" href="/note/assets/js/62.c9b728e8.js"><link rel="prefetch" href="/note/assets/js/63.3aef3c58.js"><link rel="prefetch" href="/note/assets/js/64.f274394a.js"><link rel="prefetch" href="/note/assets/js/65.380d7630.js"><link rel="prefetch" href="/note/assets/js/66.0f94cf0d.js"><link rel="prefetch" href="/note/assets/js/67.9f7cbc10.js"><link rel="prefetch" href="/note/assets/js/68.be41584f.js"><link rel="prefetch" href="/note/assets/js/69.62dfb037.js"><link rel="prefetch" href="/note/assets/js/7.7e01e252.js"><link rel="prefetch" href="/note/assets/js/70.14dae2a4.js"><link rel="prefetch" href="/note/assets/js/71.506ee405.js"><link rel="prefetch" href="/note/assets/js/72.2ad6f7c7.js"><link rel="prefetch" href="/note/assets/js/73.dfbf98ca.js"><link rel="prefetch" href="/note/assets/js/74.b4c91d56.js"><link rel="prefetch" href="/note/assets/js/75.c95780c3.js"><link rel="prefetch" href="/note/assets/js/76.edc4f55d.js"><link rel="prefetch" href="/note/assets/js/77.f8a2a59c.js"><link rel="prefetch" href="/note/assets/js/78.37cc79d4.js"><link rel="prefetch" href="/note/assets/js/79.3133562a.js"><link rel="prefetch" href="/note/assets/js/8.8668d38f.js"><link rel="prefetch" href="/note/assets/js/80.ad51022d.js"><link rel="prefetch" href="/note/assets/js/81.babaa54f.js"><link rel="prefetch" href="/note/assets/js/82.a4f831c7.js"><link rel="prefetch" href="/note/assets/js/83.5afe7fc6.js"><link rel="prefetch" href="/note/assets/js/84.734ee63e.js"><link rel="prefetch" href="/note/assets/js/85.6e082d5f.js"><link rel="prefetch" href="/note/assets/js/86.0508b4a5.js"><link rel="prefetch" href="/note/assets/js/87.3cd80b10.js"><link rel="prefetch" href="/note/assets/js/88.716f3968.js"><link rel="prefetch" href="/note/assets/js/89.d287155e.js"><link rel="prefetch" href="/note/assets/js/9.044c3d55.js"><link rel="prefetch" href="/note/assets/js/90.98118a5b.js"><link rel="prefetch" href="/note/assets/js/91.ca7699c4.js"><link rel="prefetch" href="/note/assets/js/92.b1e16a2a.js"><link rel="prefetch" href="/note/assets/js/93.c73bb197.js"><link rel="prefetch" href="/note/assets/js/94.e82638ce.js"><link rel="prefetch" href="/note/assets/js/95.a62e885a.js"><link rel="prefetch" href="/note/assets/js/96.0609c6cd.js"><link rel="prefetch" href="/note/assets/js/97.7349a051.js"><link rel="prefetch" href="/note/assets/js/98.79bc737c.js"><link rel="prefetch" href="/note/assets/js/99.ebf6fd43.js">
    <link rel="stylesheet" href="/note/assets/css/0.styles.c9d983ba.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/note/" class="home-link router-link-active"><!----> <span class="site-name">学习笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/note/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/note/css/css基础.html" class="nav-link">
  css 相关
</a></div><div class="nav-item"><a href="/note/react/react基础.html" class="nav-link">
  react 相关
</a></div><div class="nav-item"><a href="/note/js-patterns/代理模式.html" class="nav-link">
  js 设计模式
</a></div><div class="nav-item"><a href="/note/typescript/typescript基础语法.html" class="nav-link">
  typescript
</a></div><div class="nav-item"><a href="/note/node/基础知识.html" class="nav-link">
  node
</a></div><div class="nav-item"><a href="/note/javascript/知识体系.html" class="nav-link">
  javascript
</a></div><div class="nav-item"><a href="/note/vue/相关笔记.html" class="nav-link">
  vue
</a></div><div class="nav-item"><a href="/note/webpack/基础知识.html" class="nav-link">
  webpack
</a></div><div class="nav-item"><a href="/note/webgis/坐标系相关.html" class="nav-link">
  webgis
</a></div><div class="nav-item"><a href="/note/http/HTTP协议基础.html" class="nav-link">
  http
</a></div><div class="nav-item"><a href="/note/Interview/forEach-forIn-forOf-map之间的区别.html" class="nav-link">
  Interview
</a></div><div class="nav-item"><a href="/note/gisAlgorithm/数据结构-矢量.html" class="nav-link">
  gis 算法
</a></div><div class="nav-item"><a href="/note/graphics/图形学基础.html" class="nav-link">
  图形学相关
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/note/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/note/css/css基础.html" class="nav-link">
  css 相关
</a></div><div class="nav-item"><a href="/note/react/react基础.html" class="nav-link">
  react 相关
</a></div><div class="nav-item"><a href="/note/js-patterns/代理模式.html" class="nav-link">
  js 设计模式
</a></div><div class="nav-item"><a href="/note/typescript/typescript基础语法.html" class="nav-link">
  typescript
</a></div><div class="nav-item"><a href="/note/node/基础知识.html" class="nav-link">
  node
</a></div><div class="nav-item"><a href="/note/javascript/知识体系.html" class="nav-link">
  javascript
</a></div><div class="nav-item"><a href="/note/vue/相关笔记.html" class="nav-link">
  vue
</a></div><div class="nav-item"><a href="/note/webpack/基础知识.html" class="nav-link">
  webpack
</a></div><div class="nav-item"><a href="/note/webgis/坐标系相关.html" class="nav-link">
  webgis
</a></div><div class="nav-item"><a href="/note/http/HTTP协议基础.html" class="nav-link">
  http
</a></div><div class="nav-item"><a href="/note/Interview/forEach-forIn-forOf-map之间的区别.html" class="nav-link">
  Interview
</a></div><div class="nav-item"><a href="/note/gisAlgorithm/数据结构-矢量.html" class="nav-link">
  gis 算法
</a></div><div class="nav-item"><a href="/note/graphics/图形学基础.html" class="nav-link">
  图形学相关
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/note/graphics/图形学基础.html" class="sidebar-link">图形学基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/graphics/图形学基础.html#图形学基础" class="sidebar-link">图形学基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/graphics/图形学基础.html#三角形网格" class="sidebar-link">三角形网格</a></li></ul></li></ul></li><li><a href="/note/graphics/数学基础.html" class="sidebar-link">数学基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/graphics/数学基础.html#数学基础" class="sidebar-link">数学基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/graphics/数学基础.html#什么是向量" class="sidebar-link">什么是向量</a></li><li class="sidebar-sub-header"><a href="/note/graphics/数学基础.html#三维直角坐标系" class="sidebar-link">三维直角坐标系</a></li><li class="sidebar-sub-header"><a href="/note/graphics/数学基础.html#向量的表示" class="sidebar-link">向量的表示</a></li><li class="sidebar-sub-header"><a href="/note/graphics/数学基础.html#向量乘以常数" class="sidebar-link">向量乘以常数</a></li><li class="sidebar-sub-header"><a href="/note/graphics/数学基础.html#向量的长度" class="sidebar-link">向量的长度</a></li><li class="sidebar-sub-header"><a href="/note/graphics/数学基础.html#线性组合" class="sidebar-link">线性组合</a></li><li class="sidebar-sub-header"><a href="/note/graphics/数学基础.html#单位圆" class="sidebar-link">单位圆</a></li><li class="sidebar-sub-header"><a href="/note/graphics/数学基础.html#弧度和角度" class="sidebar-link">弧度和角度</a></li><li class="sidebar-sub-header"><a href="/note/graphics/数学基础.html#极坐标" class="sidebar-link">极坐标</a></li><li class="sidebar-sub-header"><a href="/note/graphics/数学基础.html#极坐标系" class="sidebar-link">极坐标系</a></li><li class="sidebar-sub-header"><a href="/note/graphics/数学基础.html#三角函数的性质" class="sidebar-link">三角函数的性质</a></li><li class="sidebar-sub-header"><a href="/note/graphics/数学基础.html#旋转" class="sidebar-link">旋转</a></li><li class="sidebar-sub-header"><a href="/note/graphics/数学基础.html#向量的叉乘" class="sidebar-link">向量的叉乘</a></li><li class="sidebar-sub-header"><a href="/note/graphics/数学基础.html#_2d-叉乘符号的含义" class="sidebar-link">2d 叉乘符号的含义</a></li><li class="sidebar-sub-header"><a href="/note/graphics/数学基础.html#_3d-向量叉乘" class="sidebar-link">3d 向量叉乘</a></li><li class="sidebar-sub-header"><a href="/note/graphics/数学基础.html#_3d-叉乘的意义" class="sidebar-link">3D 叉乘的意义</a></li><li class="sidebar-sub-header"><a href="/note/graphics/数学基础.html#矩阵" class="sidebar-link">矩阵</a></li></ul></li></ul></li><li><a href="/note/graphics/webgl基础.html" class="sidebar-link">webgl基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/graphics/webgl基础.html#webgl-基础" class="sidebar-link">webGL 基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/graphics/webgl基础.html#webgl-程序的结构" class="sidebar-link">webGL 程序的结构</a></li><li class="sidebar-sub-header"><a href="/note/graphics/webgl基础.html#webgl-渲染管线" class="sidebar-link">webgl 渲染管线</a></li><li class="sidebar-sub-header"><a href="/note/graphics/webgl基础.html#渲染过程" class="sidebar-link">渲染过程</a></li><li class="sidebar-sub-header"><a href="/note/graphics/webgl基础.html#glsl" class="sidebar-link">GLSL</a></li><li class="sidebar-sub-header"><a href="/note/graphics/webgl基础.html#webgl-坐标系统" class="sidebar-link">webgl 坐标系统</a></li><li class="sidebar-sub-header"><a href="/note/graphics/webgl基础.html#webgl-机制-缓冲区对象（buffer-object）" class="sidebar-link">webgl 机制 —— 缓冲区对象（buffer object）</a></li><li class="sidebar-sub-header"><a href="/note/graphics/webgl基础.html#移动、旋转、缩放" class="sidebar-link">移动、旋转、缩放</a></li></ul></li></ul></li><li><a href="/note/graphics/webgl高级变换与动画基础.html" class="sidebar-link">webgl高级变换与动画基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/graphics/webgl高级变换与动画基础.html#动画" class="sidebar-link">动画</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/graphics/webgl高级变换与动画基础.html#requestanimationframe-方法" class="sidebar-link">requestAnimationFrame 方法</a></li></ul></li></ul></li><li><a href="/note/graphics/webgl颜色与纹理.html" class="sidebar-link">webgl颜色与纹理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/graphics/webgl颜色与纹理.html#颜色与纹理" class="sidebar-link">颜色与纹理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/graphics/webgl颜色与纹理.html#将非坐标数据传入顶点着色器" class="sidebar-link">将非坐标数据传入顶点着色器</a></li><li class="sidebar-sub-header"><a href="/note/graphics/webgl颜色与纹理.html#顶点着色器与片元着色器之间通讯" class="sidebar-link">顶点着色器与片元着色器之间通讯</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/graphics/webgl颜色与纹理.html#彩色三角形-几何形状的装配和光栅化" class="sidebar-link">彩色三角形——几何形状的装配和光栅化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/graphics/webgl颜色与纹理.html#几何形状的装配和光栅化" class="sidebar-link">几何形状的装配和光栅化</a></li><li class="sidebar-sub-header"><a href="/note/graphics/webgl颜色与纹理.html#调用片元着色器" class="sidebar-link">调用片元着色器</a></li><li class="sidebar-sub-header"><a href="/note/graphics/webgl颜色与纹理.html#varying-变量的作用和内插过程" class="sidebar-link">varying 变量的作用和内插过程</a></li><li class="sidebar-sub-header"><a href="/note/graphics/webgl颜色与纹理.html#矩形表面贴上图像" class="sidebar-link">矩形表面贴上图像</a></li><li class="sidebar-sub-header"><a href="/note/graphics/webgl颜色与纹理.html#使用多幅纹理" class="sidebar-link">使用多幅纹理</a></li></ul></li></ul></li><li><a href="/note/graphics/OpenGLES着色器语言.html" class="sidebar-link">OpenGLES着色器语言</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#glsl-es-概述" class="sidebar-link">GLSL ES 概述</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#基础" class="sidebar-link">基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#执行次序" class="sidebar-link">执行次序</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#注释" class="sidebar-link">注释</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#数据值类型（数值和布尔值）" class="sidebar-link">数据值类型（数值和布尔值）</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#变量" class="sidebar-link">变量</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#glsl-es-是强类型语言" class="sidebar-link">GLSL ES 是强类型语言</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#基本类型" class="sidebar-link">基本类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#赋值和类型转换" class="sidebar-link">赋值和类型转换</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#运算符" class="sidebar-link">运算符</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#矢量和矩阵" class="sidebar-link">矢量和矩阵</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#赋值和构造" class="sidebar-link">赋值和构造</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#矢量构造函数" class="sidebar-link">矢量构造函数</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#矩阵构造函数" class="sidebar-link">矩阵构造函数</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#访问元素" class="sidebar-link">访问元素</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#运算符-2" class="sidebar-link">运算符</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#运算符-3" class="sidebar-link">[] 运算符</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#运算符-4" class="sidebar-link">运算符</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#矩阵右乘矢量" class="sidebar-link">矩阵右乘矢量</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#矩阵左乘矢量" class="sidebar-link">矩阵左乘矢量</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#矩阵与矩阵相乘" class="sidebar-link">矩阵与矩阵相乘</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#结构体" class="sidebar-link">结构体</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#赋值和构造-2" class="sidebar-link">赋值和构造</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#访问成员" class="sidebar-link">访问成员</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#运算符-5" class="sidebar-link">运算符</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#数组" class="sidebar-link">数组</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#取样器（纹理）" class="sidebar-link">取样器（纹理）</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#运算符优先级" class="sidebar-link">运算符优先级</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#程序流程控制：分支和循环" class="sidebar-link">程序流程控制：分支和循环</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#if-语句和-if-else-语句" class="sidebar-link">if 语句和 if-else 语句</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#for-语句" class="sidebar-link">for 语句</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#continue、break-和-discard-语句" class="sidebar-link">continue、break 和 discard 语句</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#函数" class="sidebar-link">函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#规范声明" class="sidebar-link">规范声明</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#参数限定词" class="sidebar-link">参数限定词</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#内置函数" class="sidebar-link">内置函数</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#存储限定字" class="sidebar-link">存储限定字</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#const-变量" class="sidebar-link">const 变量</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#attribute-变量" class="sidebar-link">Attribute 变量</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#uniform-变量" class="sidebar-link">uniform 变量</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#varying-变量" class="sidebar-link">varying 变量</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#精度限定字" class="sidebar-link">精度限定字</a></li><li class="sidebar-sub-header"><a href="/note/graphics/OpenGLES着色器语言.html#预处理指令" class="sidebar-link">预处理指令</a></li></ul></li><li><a href="/note/graphics/threejs基础.html" class="sidebar-link">threejs基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/graphics/threejs基础.html#例子-渲染三角形" class="sidebar-link">例子-渲染三角形</a></li><li class="sidebar-sub-header"><a href="/note/graphics/threejs基础.html#世界坐标系到观察者坐标系" class="sidebar-link">世界坐标系到观察者坐标系</a></li><li class="sidebar-sub-header"><a href="/note/graphics/threejs基础.html#视图矩阵" class="sidebar-link">视图矩阵</a></li><li class="sidebar-sub-header"><a href="/note/graphics/threejs基础.html#投影矩阵" class="sidebar-link">投影矩阵</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/graphics/threejs基础.html#透视投影" class="sidebar-link">透视投影</a></li><li class="sidebar-sub-header"><a href="/note/graphics/threejs基础.html#正交投影" class="sidebar-link">正交投影</a></li><li class="sidebar-sub-header"><a href="/note/graphics/threejs基础.html#正交相机" class="sidebar-link">正交相机</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/graphics/threejs基础.html#shadow" class="sidebar-link">shadow</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="立方体绘制"><a href="#立方体绘制" class="header-anchor">#</a> 立方体绘制</h2> <p>三维物体也是由二维图形组成的，如下，一个由 12 个三角形组成的立方体：</p> <p><img src="/note/assets/img/lifangti.bff87365.png" alt="avatar"></p> <p>在三维世界里，跟二维不同的是，需要在三维世界定义观察者在什么地方、朝哪里看、视野有多宽、能看多远。</p> <h2 id="视点和视线"><a href="#视点和视线" class="header-anchor">#</a> 视点和视线</h2> <p>三维物体与二维图形最显著的区别就是，三维物体具有深度，也就是 z 轴。我们绘制出来的东西还是二维屏幕，只不过观察者可以处在任意位置观察。定义观察者，需要考虑下面两点：</p> <ul><li>观察方向：从哪个方向看过去，看哪一部分？</li> <li>可视距离：能看多远。</li></ul> <p>观察者的位置称为视点，从视点出发沿着观察方向的射线称为视线。</p> <p>在 webgl 系统中，默认情视点处于原点 (0, 0, 0)，视线为 z 轴负半轴（指向屏幕里面）</p> <p><img src="/note/assets/img/webglzbx.92d761ac.png" alt="avatar"></p> <h3 id="视点、观察目标点和上方向"><a href="#视点、观察目标点和上方向" class="header-anchor">#</a> 视点、观察目标点和上方向</h3> <p>为了确定观察者的状态，需要确定三个信息：</p> <ol><li>视点：观察者的位置；视线的起点；下面表述都用坐标 (eyeX, eyeY, eyeZ) 表示；</li> <li>观察目标点：被观察目标所在的点；他可以同来确定视线。观察目标点是一个点。观察点坐标用 (atX, atY, atZ) 表示；</li> <li>上方向：为了将观察到的景色绘制到屏幕上；它是具有三个分量的矢量，用 (upX, upY, upZ) 表示；</li></ol> <p><img src="/note/assets/img/shidianguanchadianshangfangx.64c10eaf.png" alt="avatar"></p> <p>在 webgl 中，可以用上述三个矢量创建一个视图矩阵。然后将该矩阵传给顶点着色器。</p> <p>封装创建视图矩阵的方法如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 创建视图矩阵
 * @param eyeX, 指定视点
 * @param atX, 指定观察点
 * @param upX, 指定上方向，如果上方向是 Y 轴正方向，那么传入(0, 1, 0)
 * @return this
 */</span>
<span class="token class-name">Matrix4</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">setLookAt</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">eyeX<span class="token punctuation">,</span> eyeY<span class="token punctuation">,</span> eyeZ<span class="token punctuation">,</span> atX<span class="token punctuation">,</span> atY<span class="token punctuation">,</span> atZ<span class="token punctuation">,</span> upX<span class="token punctuation">,</span> upY<span class="token punctuation">,</span> upZ</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> e<span class="token punctuation">,</span> fx<span class="token punctuation">,</span> fy<span class="token punctuation">,</span> fz<span class="token punctuation">,</span> rlf<span class="token punctuation">,</span> sx<span class="token punctuation">,</span> sy<span class="token punctuation">,</span> sz<span class="token punctuation">,</span> rls<span class="token punctuation">,</span> ux<span class="token punctuation">,</span> uy<span class="token punctuation">,</span> uz<span class="token punctuation">;</span>

  fx <span class="token operator">=</span> atX <span class="token operator">-</span> eyeX<span class="token punctuation">;</span>
  fy <span class="token operator">=</span> atY <span class="token operator">-</span> eyeY<span class="token punctuation">;</span>
  fz <span class="token operator">=</span> atZ <span class="token operator">-</span> eyeZ<span class="token punctuation">;</span>

  <span class="token comment">// Normalize f.</span>
  rlf <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>fx<span class="token operator">*</span>fx <span class="token operator">+</span> fy<span class="token operator">*</span>fy <span class="token operator">+</span> fz<span class="token operator">*</span>fz<span class="token punctuation">)</span><span class="token punctuation">;</span>
  fx <span class="token operator">*=</span> rlf<span class="token punctuation">;</span>
  fy <span class="token operator">*=</span> rlf<span class="token punctuation">;</span>
  fz <span class="token operator">*=</span> rlf<span class="token punctuation">;</span>

  <span class="token comment">// Calculate cross product of f and up.</span>
  sx <span class="token operator">=</span> fy <span class="token operator">*</span> upZ <span class="token operator">-</span> fz <span class="token operator">*</span> upY<span class="token punctuation">;</span>
  sy <span class="token operator">=</span> fz <span class="token operator">*</span> upX <span class="token operator">-</span> fx <span class="token operator">*</span> upZ<span class="token punctuation">;</span>
  sz <span class="token operator">=</span> fx <span class="token operator">*</span> upY <span class="token operator">-</span> fy <span class="token operator">*</span> upX<span class="token punctuation">;</span>

  <span class="token comment">// Normalize s.</span>
  rls <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>sx<span class="token operator">*</span>sx <span class="token operator">+</span> sy<span class="token operator">*</span>sy <span class="token operator">+</span> sz<span class="token operator">*</span>sz<span class="token punctuation">)</span><span class="token punctuation">;</span>
  sx <span class="token operator">*=</span> rls<span class="token punctuation">;</span>
  sy <span class="token operator">*=</span> rls<span class="token punctuation">;</span>
  sz <span class="token operator">*=</span> rls<span class="token punctuation">;</span>

  <span class="token comment">// Calculate cross product of s and f.</span>
  ux <span class="token operator">=</span> sy <span class="token operator">*</span> fz <span class="token operator">-</span> sz <span class="token operator">*</span> fy<span class="token punctuation">;</span>
  uy <span class="token operator">=</span> sz <span class="token operator">*</span> fx <span class="token operator">-</span> sx <span class="token operator">*</span> fz<span class="token punctuation">;</span>
  uz <span class="token operator">=</span> sx <span class="token operator">*</span> fy <span class="token operator">-</span> sy <span class="token operator">*</span> fx<span class="token punctuation">;</span>

  e <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>elements<span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> sx<span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> ux<span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>fx<span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  e<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> sy<span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> uy<span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>fy<span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  e<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> sz<span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> uz<span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>fz<span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  e<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token operator">-</span>eyeX<span class="token punctuation">,</span> <span class="token operator">-</span>eyeY<span class="token punctuation">,</span> <span class="token operator">-</span>eyeZ<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>在 webgl 中，观察者的默认状态是：</p> <ul><li>视点位于坐标系统圆点 (0, 0, 0);</li> <li>视线为 z 轴负方向，观察点为 (0, 0, -1)，上方向为 y 轴负方向，即 (0, 1, 0)</li></ul> <p>示例，添加视图矩阵，修改观察点位置：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 顶点着色器</span>
<span class="token keyword">var</span> <span class="token constant">VSHADER_SOURCE</span> <span class="token operator">=</span>
  <span class="token string">'attribute vec4 a_Position;\n'</span> <span class="token operator">+</span>
  <span class="token string">'attribute vec4 a_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'uniform mat4 u_ViewMatrix;\n'</span> <span class="token operator">+</span>
  <span class="token string">'varying vec4 v_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'void main() {\n'</span> <span class="token operator">+</span>
  <span class="token string">'  gl_Position = u_ViewMatrix * a_Position;\n'</span> <span class="token operator">+</span>
  <span class="token string">'  v_Color = a_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'}\n'</span><span class="token punctuation">;</span>

<span class="token comment">// 片元着色器</span>
<span class="token keyword">var</span> <span class="token constant">FSHADER_SOURCE</span> <span class="token operator">=</span>
  <span class="token string">'#ifdef GL_ES\n'</span> <span class="token operator">+</span>
  <span class="token string">'precision mediump float;\n'</span> <span class="token operator">+</span>
  <span class="token string">'#endif\n'</span> <span class="token operator">+</span>
  <span class="token string">'varying vec4 v_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'void main() {\n'</span> <span class="token operator">+</span>
  <span class="token string">'  gl_FragColor = v_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'}\n'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'webgl'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> gl <span class="token operator">=</span> <span class="token function">getWebGLContext</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the rendering context for WebGL'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">initShaders</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> <span class="token constant">VSHADER_SOURCE</span><span class="token punctuation">,</span> <span class="token constant">FSHADER_SOURCE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to intialize shaders.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 设置顶点坐标和颜色</span>
  <span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token function">initVertexBuffers</span><span class="token punctuation">(</span>gl<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to set the vertex information'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  gl<span class="token punctuation">.</span><span class="token function">clearColor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 获取 u_ViewMatrix 变量的存储地址</span>
  <span class="token keyword">var</span> u_ViewMatrix <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'u_ViewMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>u_ViewMatrix<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the storage locations of u_ViewMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 设置视点、视线和上方向</span>
  <span class="token keyword">var</span> viewMatrix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  viewMatrix<span class="token punctuation">.</span><span class="token function">setLookAt</span><span class="token punctuation">(</span><span class="token number">0.20</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 将视图矩阵传给 u_ViewMatrix 变量</span>
  gl<span class="token punctuation">.</span><span class="token function">uniformMatrix4fv</span><span class="token punctuation">(</span>u_ViewMatrix<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> viewMatrix<span class="token punctuation">.</span>elements<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">COLOR_BUFFER_BIT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 绘制三角形</span>
  gl<span class="token punctuation">.</span><span class="token function">drawArrays</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TRIANGLES</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">initVertexBuffers</span><span class="token punctuation">(</span><span class="token parameter">gl</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> verticesColors <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token comment">// 顶点坐标和颜色</span>
     <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token comment">// 绿色三角形在最后面</span>
    <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>
     <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span> 
   
     <span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">0.2</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token comment">// T黄色三角形在中间</span>
    <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">0.2</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>
     <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.6</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">0.2</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span> 

     <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.5</span><span class="token punctuation">,</span>   <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token comment">// 蓝色三角形在最前面</span>
    <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span>   <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
     <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span>   <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span> 
  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>

  <span class="token comment">// 创建缓冲区对象</span>
  <span class="token keyword">var</span> vertexColorbuffer <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">createBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>vertexColorbuffer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to create the buffer object'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  gl<span class="token punctuation">.</span><span class="token function">bindBuffer</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">ARRAY_BUFFER</span><span class="token punctuation">,</span> vertexColorbuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">bufferData</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">ARRAY_BUFFER</span><span class="token punctuation">,</span> verticesColors<span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">STATIC_DRAW</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> <span class="token constant">FSIZE</span> <span class="token operator">=</span> verticesColors<span class="token punctuation">.</span><span class="token constant">BYTES_PER_ELEMENT</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> a_Position <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getAttribLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'a_Position'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>a_Position <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the storage location of a_Position'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  gl<span class="token punctuation">.</span><span class="token function">vertexAttribPointer</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">FLOAT</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token constant">FSIZE</span> <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">enableVertexAttribArray</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> a_Color <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getAttribLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'a_Color'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>a_Color <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the storage location of a_Color'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  gl<span class="token punctuation">.</span><span class="token function">vertexAttribPointer</span><span class="token punctuation">(</span>a_Color<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">FLOAT</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token constant">FSIZE</span> <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token constant">FSIZE</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">enableVertexAttribArray</span><span class="token punctuation">(</span>a_Color<span class="token punctuation">)</span><span class="token punctuation">;</span>

  gl<span class="token punctuation">.</span><span class="token function">bindBuffer</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">ARRAY_BUFFER</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> n<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>结果：</p> <p><img src="/note/assets/img/gbstjz.8dd154af.png" alt="avatar"></p> <p>实际上，根据自定义的观察者状态，绘制观察者看到的景象，与使用默认的观察状态，但是对三维对象进行平移、旋转等变换，在绘制观察者看到的景象是一致的。</p> <p><img src="/note/assets/img/ydsdyydwt.9b7fd7bb.png" alt="avatar"></p> <h3 id="从指定视点观察旋转后的三角形"><a href="#从指定视点观察旋转后的三角形" class="header-anchor">#</a> 从指定视点观察旋转后的三角形</h3> <p>完成上面的操作，我们需要两个矩阵：旋转矩阵（三角形旋转操作）和视图矩阵，我们操作的步骤是先旋转三角形，然后从这个视点来观察，就需要先对三角形进行旋转变换，再对旋转后的三角形进行视图矩阵的变换，如下等式：</p> <p>从视点看去的旋转后的顶点 = 视图矩阵 × 旋转矩阵 × 原始顶点坐标</p> <p>除了旋转矩阵，还可以对顶点坐标进行基本的平移、旋转等变换矩阵操作，这是这些操作的组合成为模型矩阵。</p> <p>从视点看去的旋转后的顶点 = 视图矩阵 × 模型矩阵 × 原始顶点坐标</p> <p>示例代码：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 顶点着色器</span>
<span class="token keyword">var</span> <span class="token constant">VSHADER_SOURCE</span> <span class="token operator">=</span>
  <span class="token string">'attribute vec4 a_Position;\n'</span> <span class="token operator">+</span>
  <span class="token string">'attribute vec4 a_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'uniform mat4 u_ViewMatrix;\n'</span> <span class="token operator">+</span>
  <span class="token string">'uniform mat4 u_ModelMatrix;\n'</span> <span class="token operator">+</span>
  <span class="token string">'varying vec4 v_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'void main() {\n'</span> <span class="token operator">+</span>
  <span class="token string">'  gl_Position = u_ViewMatrix * u_ModelMatrix * a_Position;\n'</span> <span class="token operator">+</span>
  <span class="token string">'  v_Color = a_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'}\n'</span><span class="token punctuation">;</span>

<span class="token comment">// 片元着色器</span>
<span class="token keyword">var</span> <span class="token constant">FSHADER_SOURCE</span> <span class="token operator">=</span>
  <span class="token string">'#ifdef GL_ES\n'</span> <span class="token operator">+</span>
  <span class="token string">'precision mediump float;\n'</span> <span class="token operator">+</span>
  <span class="token string">'#endif\n'</span> <span class="token operator">+</span>
  <span class="token string">'varying vec4 v_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'void main() {\n'</span> <span class="token operator">+</span>
  <span class="token string">'  gl_FragColor = v_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'}\n'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'webgl'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> gl <span class="token operator">=</span> <span class="token function">getWebGLContext</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the rendering context for WebGL'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">initShaders</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> <span class="token constant">VSHADER_SOURCE</span><span class="token punctuation">,</span> <span class="token constant">FSHADER_SOURCE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to intialize shaders.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token function">initVertexBuffers</span><span class="token punctuation">(</span>gl<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to set the vertex information'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  gl<span class="token punctuation">.</span><span class="token function">clearColor</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 获取 u_ViewMatrix 和 u_ModelMatrix 的存储地址</span>
  <span class="token keyword">var</span> u_ViewMatrix <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'u_ViewMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> u_ModelMatrix <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'u_ModelMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>u_ViewMatrix <span class="token operator">||</span> <span class="token operator">!</span>u_ModelMatrix<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the storage location of u_viewMatrix or u_ModelMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 指定视点和视线-视点，观察目标点，上方向</span>
  <span class="token keyword">var</span> viewMatrix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  viewMatrix<span class="token punctuation">.</span><span class="token function">setLookAt</span><span class="token punctuation">(</span><span class="token number">0.20</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 计算旋转矩阵-绕 z 轴旋转 10°</span>
  <span class="token keyword">var</span> modelMatrix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  modelMatrix<span class="token punctuation">.</span><span class="token function">setRotate</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  gl<span class="token punctuation">.</span><span class="token function">uniformMatrix4fv</span><span class="token punctuation">(</span>u_ViewMatrix<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> viewMatrix<span class="token punctuation">.</span>elements<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">uniformMatrix4fv</span><span class="token punctuation">(</span>u_ModelMatrix<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> modelMatrix<span class="token punctuation">.</span>elements<span class="token punctuation">)</span><span class="token punctuation">;</span>

  gl<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">COLOR_BUFFER_BIT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  gl<span class="token punctuation">.</span><span class="token function">drawArrays</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TRIANGLES</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">initVertexBuffers</span><span class="token punctuation">(</span><span class="token parameter">gl</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> verticesColors <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
     <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>
     <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span> 
   
     <span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">0.2</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">0.2</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>
     <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.6</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">0.2</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span> 

     <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.5</span><span class="token punctuation">,</span>   <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span>   <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
     <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span>   <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span> 
  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> vertexColorBuffer <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">createBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>vertexColorBuffer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to create the buffer object'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  gl<span class="token punctuation">.</span><span class="token function">bindBuffer</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">ARRAY_BUFFER</span><span class="token punctuation">,</span> vertexColorBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">bufferData</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">ARRAY_BUFFER</span><span class="token punctuation">,</span> verticesColors<span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">STATIC_DRAW</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> <span class="token constant">FSIZE</span> <span class="token operator">=</span> verticesColors<span class="token punctuation">.</span><span class="token constant">BYTES_PER_ELEMENT</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> a_Position <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getAttribLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'a_Position'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>a_Position <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the storage location of a_Position'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  gl<span class="token punctuation">.</span><span class="token function">vertexAttribPointer</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">FLOAT</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token constant">FSIZE</span> <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">enableVertexAttribArray</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> a_Color <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getAttribLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'a_Color'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>a_Color <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the storage location of a_Color'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  gl<span class="token punctuation">.</span><span class="token function">vertexAttribPointer</span><span class="token punctuation">(</span>a_Color<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">FLOAT</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token constant">FSIZE</span> <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token constant">FSIZE</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">enableVertexAttribArray</span><span class="token punctuation">(</span>a_Color<span class="token punctuation">)</span><span class="token punctuation">;</span>

  gl<span class="token punctuation">.</span><span class="token function">bindBuffer</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">ARRAY_BUFFER</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> n<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>上面例子，在着色器中，我们通过对每个顶点进行计算视图矩阵 × 模型矩阵。如果顶点数量过多，这一步操作就会造成不必要的开销。因为，无论哪个顶点而言，式子中两个矩阵相乘的结果都是一样的。所以我们可以在 JavaScript 中计算好两个矩阵相乘的结果，然后传入到顶点着色器。这两个矩阵相乘得到的结果被称为模型视图矩阵。</p> <p>模型视图矩阵 = 视图矩阵 × 模型矩阵，所以 从视点看去的旋转后的顶点 = 模型视图矩阵 × 原始顶点坐标；</p> <p>上面的例子，修改之后如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 顶点着色器</span>
<span class="token keyword">var</span> <span class="token constant">VSHADER_SOURCE</span> <span class="token operator">=</span>
  <span class="token string">'attribute vec4 a_Position;\n'</span> <span class="token operator">+</span>
  <span class="token string">'attribute vec4 a_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'uniform mat4 u_ModelViewMatrix;\n'</span> <span class="token operator">+</span>
  <span class="token string">'varying vec4 v_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'void main() {\n'</span> <span class="token operator">+</span>
  <span class="token string">'  gl_Position = u_ModelViewMatrix * a_Position;\n'</span> <span class="token operator">+</span>
  <span class="token string">'  v_Color = a_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'}\n'</span><span class="token punctuation">;</span>
<span class="token comment">// 片元着色器同上例子</span>
<span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'webgl'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> gl <span class="token operator">=</span> <span class="token function">getWebGLContext</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the rendering context for WebGL'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">initShaders</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> <span class="token constant">VSHADER_SOURCE</span><span class="token punctuation">,</span> <span class="token constant">FSHADER_SOURCE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to intialize shaders.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token function">initVertexBuffers</span><span class="token punctuation">(</span>gl<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to set the vertex information'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  gl<span class="token punctuation">.</span><span class="token function">clearColor</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> u_ModelViewMatrix <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'u_ModelViewMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>u_ModelViewMatrix<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the storage location of u_ModelViewMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> viewMatrix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  viewMatrix<span class="token punctuation">.</span><span class="token function">setLookAt</span><span class="token punctuation">(</span><span class="token number">0.20</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> modelMatrix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  modelMatrix<span class="token punctuation">.</span><span class="token function">setRotate</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 获取两个矩阵相乘结果  viewMatrix * modelMatrix</span>
  <span class="token keyword">var</span> modelViewMatrix <span class="token operator">=</span> viewMatrix<span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>modelMatrix<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">uniformMatrix4fv</span><span class="token punctuation">(</span>u_ModelViewMatrix<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> modelViewMatrix<span class="token punctuation">.</span>elements<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">COLOR_BUFFER_BIT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">drawArrays</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TRIANGLES</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="使用键盘改变视点"><a href="#使用键盘改变视点" class="header-anchor">#</a> 使用键盘改变视点</h3> <p>实现通过键盘左右键，修改视点的 x 坐标；
如下代码</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 着色器部分同上代码</span>
<span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'webgl'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> gl <span class="token operator">=</span> <span class="token function">getWebGLContext</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the rendering context for WebGL'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">initShaders</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> <span class="token constant">VSHADER_SOURCE</span><span class="token punctuation">,</span> <span class="token constant">FSHADER_SOURCE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to intialize shaders.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token function">initVertexBuffers</span><span class="token punctuation">(</span>gl<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to set the vertex information'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  gl<span class="token punctuation">.</span><span class="token function">clearColor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> u_ViewMatrix <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'u_ViewMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>u_ViewMatrix<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the storage locations of u_ViewMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">var</span> viewMatrix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 注册键盘事件响应函数</span>
  document<span class="token punctuation">.</span><span class="token function-variable function">onkeydown</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">ev</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">keydown</span><span class="token punctuation">(</span>ev<span class="token punctuation">,</span> gl<span class="token punctuation">,</span> n<span class="token punctuation">,</span> u_ViewMatrix<span class="token punctuation">,</span> viewMatrix<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">draw</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> n<span class="token punctuation">,</span> u_ViewMatrix<span class="token punctuation">,</span> viewMatrix<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 视点</span>
<span class="token keyword">var</span> g_eyeX <span class="token operator">=</span> <span class="token number">0.20</span><span class="token punctuation">,</span> g_eyeY <span class="token operator">=</span> <span class="token number">0.25</span><span class="token punctuation">,</span> g_eyeZ <span class="token operator">=</span> <span class="token number">0.25</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">keydown</span><span class="token punctuation">(</span><span class="token parameter">ev<span class="token punctuation">,</span> gl<span class="token punctuation">,</span> n<span class="token punctuation">,</span> u_ViewMatrix<span class="token punctuation">,</span> viewMatrix</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 按下左键</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>keyCode <span class="token operator">==</span> <span class="token number">39</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      g_eyeX <span class="token operator">+=</span> <span class="token number">0.01</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ev<span class="token punctuation">.</span>keyCode <span class="token operator">==</span> <span class="token number">37</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 按下左键</span>
      g_eyeX <span class="token operator">-=</span> <span class="token number">0.01</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token function">draw</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> n<span class="token punctuation">,</span> u_ViewMatrix<span class="token punctuation">,</span> viewMatrix<span class="token punctuation">)</span><span class="token punctuation">;</span>    
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token parameter">gl<span class="token punctuation">,</span> n<span class="token punctuation">,</span> u_ViewMatrix<span class="token punctuation">,</span> viewMatrix</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 设置视点和视线</span>
  viewMatrix<span class="token punctuation">.</span><span class="token function">setLookAt</span><span class="token punctuation">(</span>g_eyeX<span class="token punctuation">,</span> g_eyeY<span class="token punctuation">,</span> g_eyeZ<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 传递视图矩阵</span>
  gl<span class="token punctuation">.</span><span class="token function">uniformMatrix4fv</span><span class="token punctuation">(</span>u_ViewMatrix<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> viewMatrix<span class="token punctuation">.</span>elements<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">COLOR_BUFFER_BIT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">drawArrays</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TRIANGLES</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="可视范围（正射类型）"><a href="#可视范围（正射类型）" class="header-anchor">#</a> 可视范围（正射类型）</h2> <p>在三维空间中，只有当在可视范围内的时候，webgl 才会去绘制物体，这样可以降低程序的开销。webgl 通过定义水平视角、垂直视角和可视深度（能够看多远）来定义可视空间。</p> <h3 id="可视空间"><a href="#可视空间" class="header-anchor">#</a> 可视空间</h3> <p>有两类常用的可视空间：</p> <ul><li>长方体可视空间，也称盒状空间，由正射投影产生。</li> <li>四棱锥/金字塔可视空间，由透视投影产生。</li></ul> <p>我们平时观察的世界用的就是透视投影，相比之下，正射投影的好处是用户可以方便地比较场景中的物体的大小，因为物体看上去的大小与其所在的位置没有关系。</p> <ul><li>正射投影</li></ul> <p>如图，可视空间由前后两个矩形表面确定分别称为近裁剪面和远裁剪面，前者四个顶点为 (right, top, -near), (-left, top, -near), (-left, -bottom, -near), (right, -bottom, -near) 后者的四个顶点为 (right, top, far), (-left, -bottom, far), (right, -bottom, far)</p> <p><img src="/note/assets/img/hezhuangkeshikongjian.4bdaf0b5.png" alt="avatar"></p> <p>canvas 上显示的就是可视看见中物体在近裁剪平面上的投影。如果裁剪面的宽高比和 canvas 不一样，那么画面就会被按照 canvas 的宽高比进行压缩，物体会被扭曲。近裁剪面与远裁剪面之间的盒型空间就是可视空间，只有在此空间内的物体才会被显示出来。如果有的物体一部分在盒子里一部分在外面，就只显示盒子里面的部分。</p> <h3 id="定义盒状可视空间"><a href="#定义盒状可视空间" class="header-anchor">#</a> 定义盒状可视空间</h3> <p>封装如下方法，来设置矩阵：这个矩阵被称为正射投影矩阵。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Matrix4</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">setOrtho</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">left<span class="token punctuation">,</span> right<span class="token punctuation">,</span> bottom<span class="token punctuation">,</span> top<span class="token punctuation">,</span> near<span class="token punctuation">,</span> far</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> e<span class="token punctuation">,</span> rw<span class="token punctuation">,</span> rh<span class="token punctuation">,</span> rd<span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">===</span> right <span class="token operator">||</span> bottom <span class="token operator">===</span> top <span class="token operator">||</span> near <span class="token operator">===</span> far<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token string">'null frustum'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  rw <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span>right <span class="token operator">-</span> left<span class="token punctuation">)</span><span class="token punctuation">;</span>
  rh <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span>top <span class="token operator">-</span> bottom<span class="token punctuation">)</span><span class="token punctuation">;</span>
  rd <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span>far <span class="token operator">-</span> near<span class="token punctuation">)</span><span class="token punctuation">;</span>

  e <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>elements<span class="token punctuation">;</span>

  e<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> rw<span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  e<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> rh<span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  e<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> rd<span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  e<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span>right <span class="token operator">+</span> left<span class="token punctuation">)</span> <span class="token operator">*</span> rw<span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span>top <span class="token operator">+</span> bottom<span class="token punctuation">)</span> <span class="token operator">*</span> rh<span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span>far <span class="token operator">+</span> near<span class="token punctuation">)</span> <span class="token operator">*</span> rd<span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>正射投影矩阵如下：</p> <p><img src="/note/assets/img/zhengshetouyingjuzhen.d14d8f45.png" alt="avatar"></p> <p>下面例子是实现一个将视点设置在原点，视线为 z 轴负方向，可视空间如下图，near = 0.0, far = 0.5, left = -1.0, right = 1.0, bottom = -1.0, top = 1.0, 三角形处于 z 轴 0.0 到 -0.4 区间上。</p> <p><img src="/note/assets/img/zhegnshetoyingjuzhen.16f4de20.png" alt="avatar"></p> <p>代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 顶点着色器</span>
<span class="token keyword">var</span> <span class="token constant">VSHADER_SOURCE</span> <span class="token operator">=</span>
  <span class="token string">'attribute vec4 a_Position;\n'</span> <span class="token operator">+</span>
  <span class="token string">'attribute vec4 a_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'uniform mat4 u_ProjMatrix;\n'</span> <span class="token operator">+</span>
  <span class="token string">'varying vec4 v_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'void main() {\n'</span> <span class="token operator">+</span>
  <span class="token string">'  gl_Position = u_ProjMatrix * a_Position;\n'</span> <span class="token operator">+</span>
  <span class="token string">'  v_Color = a_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'}\n'</span><span class="token punctuation">;</span>
<span class="token comment">// 片元着色器同上例子</span>
<span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 初始化同上</span>

  <span class="token keyword">var</span> n <span class="token operator">=</span>  <span class="token function">initVertexBuffers</span><span class="token punctuation">(</span>gl<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to set the vertex information'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  gl<span class="token punctuation">.</span><span class="token function">clearColor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> u_ProjMatrix <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'u_ProjMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>u_ProjMatrix<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the storage location of u_ProjMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> projMatrix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 注册键盘事件响应函数</span>
  document<span class="token punctuation">.</span><span class="token function-variable function">onkeydown</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">ev</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">keydown</span><span class="token punctuation">(</span>ev<span class="token punctuation">,</span> gl<span class="token punctuation">,</span> n<span class="token punctuation">,</span> u_ProjMatrix<span class="token punctuation">,</span> projMatrix<span class="token punctuation">,</span> nf<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">draw</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> n<span class="token punctuation">,</span> u_ProjMatrix<span class="token punctuation">,</span> projMatrix<span class="token punctuation">,</span> nf<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">initVertexBuffers</span><span class="token punctuation">(</span><span class="token parameter">gl</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> verticesColors <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
     <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.6</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>
     <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span> 
   
     <span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">0.2</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">0.2</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>
     <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.6</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">0.2</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span> 

     <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.5</span><span class="token punctuation">,</span>   <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span>   <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
     <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span>   <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span> 
  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> vertexColorbuffer <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">createBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>vertexColorbuffer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to create the buffer object'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  gl<span class="token punctuation">.</span><span class="token function">bindBuffer</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">ARRAY_BUFFER</span><span class="token punctuation">,</span> vertexColorbuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">bufferData</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">ARRAY_BUFFER</span><span class="token punctuation">,</span> verticesColors<span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">STATIC_DRAW</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> <span class="token constant">FSIZE</span> <span class="token operator">=</span> verticesColors<span class="token punctuation">.</span><span class="token constant">BYTES_PER_ELEMENT</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> a_Position <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getAttribLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'a_Position'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>a_Position <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the storage location of a_Position'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  gl<span class="token punctuation">.</span><span class="token function">vertexAttribPointer</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">FLOAT</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token constant">FSIZE</span> <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">enableVertexAttribArray</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> a_Color <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getAttribLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'a_Color'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>a_Color <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the storage location of a_Color'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  gl<span class="token punctuation">.</span><span class="token function">vertexAttribPointer</span><span class="token punctuation">(</span>a_Color<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">FLOAT</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token constant">FSIZE</span> <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token constant">FSIZE</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">enableVertexAttribArray</span><span class="token punctuation">(</span>a_Color<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> n<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 视点与近、远裁剪面的距离</span>
<span class="token keyword">var</span> g_near <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">,</span> g_far <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">keydown</span><span class="token punctuation">(</span><span class="token parameter">ev<span class="token punctuation">,</span> gl<span class="token punctuation">,</span> n<span class="token punctuation">,</span> u_ProjMatrix<span class="token punctuation">,</span> projMatrix<span class="token punctuation">,</span> nf</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>keyCode<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token number">39</span><span class="token operator">:</span> g_near <span class="token operator">+=</span> <span class="token number">0.01</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>  <span class="token comment">// 右键</span>
    <span class="token keyword">case</span> <span class="token number">37</span><span class="token operator">:</span> g_near <span class="token operator">-=</span> <span class="token number">0.01</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>  <span class="token comment">// 左键</span>
    <span class="token keyword">case</span> <span class="token number">38</span><span class="token operator">:</span> g_far <span class="token operator">+=</span> <span class="token number">0.01</span><span class="token punctuation">;</span>  <span class="token keyword">break</span><span class="token punctuation">;</span>  <span class="token comment">// 上键</span>
    <span class="token keyword">case</span> <span class="token number">40</span><span class="token operator">:</span> g_far <span class="token operator">-=</span> <span class="token number">0.01</span><span class="token punctuation">;</span>  <span class="token keyword">break</span><span class="token punctuation">;</span>  <span class="token comment">// 下键</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
 
  <span class="token function">draw</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> n<span class="token punctuation">,</span> u_ProjMatrix<span class="token punctuation">,</span> projMatrix<span class="token punctuation">,</span> nf<span class="token punctuation">)</span><span class="token punctuation">;</span>    
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token parameter">gl<span class="token punctuation">,</span> n<span class="token punctuation">,</span> u_ProjMatrix<span class="token punctuation">,</span> projMatrix<span class="token punctuation">,</span> nf</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 设置可视空间</span>
  projMatrix<span class="token punctuation">.</span><span class="token function">setOrtho</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> g_near<span class="token punctuation">,</span> g_far<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 将投影矩阵传递给 u_ProjMatrix 变量</span>
  gl<span class="token punctuation">.</span><span class="token function">uniformMatrix4fv</span><span class="token punctuation">(</span>u_ProjMatrix<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> projMatrix<span class="token punctuation">.</span>elements<span class="token punctuation">)</span><span class="token punctuation">;</span>

  gl<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">COLOR_BUFFER_BIT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 显示当前的 near 和 far 值</span>
  nf<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'near: '</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>g_near <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">100</span> <span class="token operator">+</span> <span class="token string">', far: '</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>g_far<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">;</span>

  gl<span class="token punctuation">.</span><span class="token function">drawArrays</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TRIANGLES</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// Draw the triangles</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="结合视图矩阵正射投影矩阵"><a href="#结合视图矩阵正射投影矩阵" class="header-anchor">#</a> 结合视图矩阵正射投影矩阵</h3> <p>我们使用视图矩阵以及正射投影矩阵修改视图矩阵那个例子，如下代码：</p> <p>我们传递给顶点着色器的公式：正射投影矩阵 × 视图矩阵 × 顶点坐标</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 顶点着色器</span>
<span class="token keyword">var</span> <span class="token constant">VSHADER_SOURCE</span> <span class="token operator">=</span>
  <span class="token string">'attribute vec4 a_Position;\n'</span> <span class="token operator">+</span>
  <span class="token string">'attribute vec4 a_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'uniform mat4 u_ViewMatrix;\n'</span> <span class="token operator">+</span>
  <span class="token string">'uniform mat4 u_ProjMatrix;\n'</span> <span class="token operator">+</span>
  <span class="token string">'varying vec4 v_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'void main() {\n'</span> <span class="token operator">+</span>
  <span class="token string">'  gl_Position = u_ProjMatrix * u_ViewMatrix * a_Position;\n'</span> <span class="token operator">+</span>
  <span class="token string">'  v_Color = a_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'}\n'</span><span class="token punctuation">;</span>

<span class="token comment">// 片元着色器同上</span>

<span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'webgl'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> gl <span class="token operator">=</span> <span class="token function">getWebGLContext</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the rendering context for WebGL'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">initShaders</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> <span class="token constant">VSHADER_SOURCE</span><span class="token punctuation">,</span> <span class="token constant">FSHADER_SOURCE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to intialize shaders.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token function">initVertexBuffers</span><span class="token punctuation">(</span>gl<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to specify the vertex infromation'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  gl<span class="token punctuation">.</span><span class="token function">clearColor</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> u_ViewMatrix <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'u_ViewMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> u_ProjMatrix <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'u_ProjMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>u_ViewMatrix <span class="token operator">||</span> <span class="token operator">!</span>u_ProjMatrix<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get u_ViewMatrix or u_ProjMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> viewMatrix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 注册键盘事件</span>
 document<span class="token punctuation">.</span><span class="token function-variable function">onkeydown</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">ev</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">keydown</span><span class="token punctuation">(</span>ev<span class="token punctuation">,</span> gl<span class="token punctuation">,</span> n<span class="token punctuation">,</span> u_ViewMatrix<span class="token punctuation">,</span> viewMatrix<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token comment">// 创建指定可视空间的矩阵并传给 u_ProjMatrix 变量</span>
  <span class="token keyword">var</span> projMatrix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  projMatrix<span class="token punctuation">.</span><span class="token function">setOrtho</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">uniformMatrix4fv</span><span class="token punctuation">(</span>u_ProjMatrix<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> projMatrix<span class="token punctuation">.</span>elements<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">draw</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> n<span class="token punctuation">,</span> u_ViewMatrix<span class="token punctuation">,</span> viewMatrix<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// Draw the triangles</span>
<span class="token punctuation">}</span>
<span class="token comment">// 其他代码与视图矩阵例子一致</span>
</code></pre></div><h2 id="可视空间（透视投影）"><a href="#可视空间（透视投影）" class="header-anchor">#</a> 可视空间（透视投影）</h2> <p>在正射投影的可视空间中，不管三角形与视点的距离是远还是近，他又多大，那么画出来的就有多大。可以使用透视投影产生深度感。</p> <h3 id="定义透视投影可视空间"><a href="#定义透视投影可视空间" class="header-anchor">#</a> 定义透视投影可视空间</h3> <p>透视投影可视空间如下图，跟盒状可视空间一样，透视投影可视空间也有视点、视线、近裁剪面和远裁剪面，这样可视空间内的物体才会被显示，可视空间外的物体不会显示。</p> <p><img src="/note/assets/img/tstykskj.1ca4463e.png" alt="avatar"></p> <p>下面是封装了透视投影矩阵生成方法：该矩阵称为透视投影矩阵</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 通过个参数计算透视投影矩阵，将其存储在 Matrix4 中，注意 near 的值必须小于 far
 * @param fovy 指定垂直视角，即可视空间顶面和地面间的夹角，必须大于 0
 * @param aspect 指定近裁剪面的宽高比（宽度/高度）
 * @param near 指定近裁剪面和远裁剪面的位置，即可视空间的近边界和远边界（near 和 far 必须都大于 0）
 * @param far 
 * @return this
 */</span>
<span class="token class-name">Matrix4</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">setPerspective</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fovy<span class="token punctuation">,</span> aspect<span class="token punctuation">,</span> near<span class="token punctuation">,</span> far</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> e<span class="token punctuation">,</span> rd<span class="token punctuation">,</span> s<span class="token punctuation">,</span> ct<span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>near <span class="token operator">===</span> far <span class="token operator">||</span> aspect <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token string">'null frustum'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>near <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token string">'near &lt;= 0'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>far <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token string">'far &lt;= 0'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  fovy <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> fovy <span class="token operator">/</span> <span class="token number">180</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
  s <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>fovy<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token string">'null frustum'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  rd <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span>far <span class="token operator">-</span> near<span class="token punctuation">)</span><span class="token punctuation">;</span>
  ct <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>fovy<span class="token punctuation">)</span> <span class="token operator">/</span> s<span class="token punctuation">;</span>

  e <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>elements<span class="token punctuation">;</span>

  e<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token operator">=</span> ct <span class="token operator">/</span> aspect<span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  e<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>  <span class="token operator">=</span> ct<span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  e<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span>far <span class="token operator">+</span> near<span class="token punctuation">)</span> <span class="token operator">*</span> rd<span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

  e<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> near <span class="token operator">*</span> far <span class="token operator">*</span> rd<span class="token punctuation">;</span>
  e<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>透视投影创建的矩阵如下：</p> <p><img src="/note/assets/img/toushijuzhen.ad3cec87.png" alt="avatar"></p> <p>下图是该例子中三角形的位置，
<img src="/note/assets/img/tstysjxwz.09d9a062.png" alt="avatar"></p> <p>下图是各个三角形与可视空间的相对位置，我们指定了 near = 1.0, far = 100, aspect = 1.0 宽高相等，以及 fov = 30.0
<img src="/note/assets/img/sanjiaoxkskjwz.450f495c.png" alt="avatar"></p> <p>代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 顶点着色器</span>
<span class="token keyword">var</span> <span class="token constant">VSHADER_SOURCE</span> <span class="token operator">=</span>
  <span class="token string">'attribute vec4 a_Position;\n'</span> <span class="token operator">+</span>
  <span class="token string">'attribute vec4 a_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'uniform mat4 u_ViewMatrix;\n'</span> <span class="token operator">+</span>
  <span class="token string">'uniform mat4 u_ProjMatrix;\n'</span> <span class="token operator">+</span>
  <span class="token string">'varying vec4 v_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'void main() {\n'</span> <span class="token operator">+</span>
  <span class="token string">'  gl_Position = u_ProjMatrix * u_ViewMatrix * a_Position;\n'</span> <span class="token operator">+</span>
  <span class="token string">'  v_Color = a_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'}\n'</span><span class="token punctuation">;</span>

<span class="token comment">// 片元着色器同上例子</span>
<span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'webgl'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> gl <span class="token operator">=</span> <span class="token function">getWebGLContext</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the rendering context for WebGL'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>s
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">initShaders</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> <span class="token constant">VSHADER_SOURCE</span><span class="token punctuation">,</span> <span class="token constant">FSHADER_SOURCE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to intialize shaders.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token function">initVertexBuffers</span><span class="token punctuation">(</span>gl<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to set the vertex information'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  gl<span class="token punctuation">.</span><span class="token function">clearColor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> u_ViewMatrix <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'u_ViewMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> u_ProjMatrix <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'u_ProjMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>u_ViewMatrix <span class="token operator">||</span> <span class="token operator">!</span>u_ProjMatrix<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the storage location of u_ViewMatrix and/or u_ProjMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">var</span> viewMatrix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>　<span class="token comment">// 视图矩阵</span>
  <span class="token keyword">var</span> projMatrix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 投影矩阵</span>

  <span class="token comment">// 计算视图矩阵与投影矩阵</span>
  viewMatrix<span class="token punctuation">.</span><span class="token function">setLookAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  projMatrix<span class="token punctuation">.</span><span class="token function">setPerspective</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> canvas<span class="token punctuation">.</span>width<span class="token operator">/</span>canvas<span class="token punctuation">.</span>height<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  gl<span class="token punctuation">.</span><span class="token function">uniformMatrix4fv</span><span class="token punctuation">(</span>u_ViewMatrix<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> viewMatrix<span class="token punctuation">.</span>elements<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">uniformMatrix4fv</span><span class="token punctuation">(</span>u_ProjMatrix<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> projMatrix<span class="token punctuation">.</span>elements<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">COLOR_BUFFER_BIT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">drawArrays</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TRIANGLES</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">initVertexBuffers</span><span class="token punctuation">(</span><span class="token parameter">gl</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> verticesColors <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token comment">// 右侧三个三角形</span>
    <span class="token number">0.75</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">4.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>
    <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">4.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>
    <span class="token number">1.25</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">4.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span> 

    <span class="token number">0.75</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">2.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>
    <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">2.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>
    <span class="token number">1.25</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">2.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span> 

    <span class="token number">0.75</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>   <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span>   <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token number">1.25</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span>   <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span> 

    <span class="token comment">// 左侧三个三角形</span>
   <span class="token operator">-</span><span class="token number">0.75</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">4.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>
   <span class="token operator">-</span><span class="token number">1.25</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">4.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>
   <span class="token operator">-</span><span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">4.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span> 

   <span class="token operator">-</span><span class="token number">0.75</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">2.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>
   <span class="token operator">-</span><span class="token number">1.25</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">2.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>
   <span class="token operator">-</span><span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">2.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span> 

   <span class="token operator">-</span><span class="token number">0.75</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>   <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
   <span class="token operator">-</span><span class="token number">1.25</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span>   <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
   <span class="token operator">-</span><span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span>   <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span> 
  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span> <span class="token comment">// 绘制 6 个三角形</span>
  <span class="token keyword">var</span> vertexColorbuffer <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">createBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>vertexColorbuffer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to create the buffer object'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  gl<span class="token punctuation">.</span><span class="token function">bindBuffer</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">ARRAY_BUFFER</span><span class="token punctuation">,</span> vertexColorbuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">bufferData</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">ARRAY_BUFFER</span><span class="token punctuation">,</span> verticesColors<span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">STATIC_DRAW</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> <span class="token constant">FSIZE</span> <span class="token operator">=</span> verticesColors<span class="token punctuation">.</span><span class="token constant">BYTES_PER_ELEMENT</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> a_Position <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getAttribLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'a_Position'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>a_Position <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the storage location of a_Position'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  gl<span class="token punctuation">.</span><span class="token function">vertexAttribPointer</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">FLOAT</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token constant">FSIZE</span> <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">enableVertexAttribArray</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> a_Color <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getAttribLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'a_Color'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>a_Color <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the storage location of a_Color'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  gl<span class="token punctuation">.</span><span class="token function">vertexAttribPointer</span><span class="token punctuation">(</span>a_Color<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">FLOAT</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token constant">FSIZE</span> <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token constant">FSIZE</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">enableVertexAttribArray</span><span class="token punctuation">(</span>a_Color<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> n<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>结果如下：</p> <p><img src="/note/assets/img/toushijieguo.882eedc6.png" alt="avatar"></p> <p>其实透视投影矩阵对三角形进行了两次变换：</p> <ol><li>根据三角形与视点的距离，按比例对三角形进行了缩小变换。</li> <li>对三角形进行平移变换，使其贴近视线。</li></ol> <p><img src="/note/assets/img/toushitouyingbianhuansyt.2309723e.png" alt="avatar"></p> <p>透视投影矩阵实际是将金字塔状的可视空间变换为了盒状的可视空间，这个盒状的可视空间又称为规范立方体。正射投影矩阵不能产生深度感，正射投影矩阵的工作仅仅是将顶点从盒状的可视空间映射到规范立方体中。顶点着色器输出的顶点都必须在规范立方体中，这样才会显示在屏幕上。</p> <h2 id="视图矩阵、模型矩阵和投影矩阵"><a href="#视图矩阵、模型矩阵和投影矩阵" class="header-anchor">#</a> 视图矩阵、模型矩阵和投影矩阵</h2> <p>我们使用下面公式来实现一个综合的例子：投影矩阵 × 视图矩阵 × 模型矩阵 × 顶点坐标，</p> <p>代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 顶点着色器</span>
<span class="token keyword">var</span> <span class="token constant">VSHADER_SOURCE</span> <span class="token operator">=</span>
  <span class="token string">'attribute vec4 a_Position;\n'</span> <span class="token operator">+</span>
  <span class="token string">'attribute vec4 a_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'uniform mat4 u_ModelMatrix;\n'</span> <span class="token operator">+</span>
  <span class="token string">'uniform mat4 u_ViewMatrix;\n'</span> <span class="token operator">+</span>
  <span class="token string">'uniform mat4 u_ProjMatrix;\n'</span> <span class="token operator">+</span>
  <span class="token string">'varying vec4 v_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'void main() {\n'</span> <span class="token operator">+</span>
  <span class="token string">'  gl_Position = u_ProjMatrix * u_ViewMatrix * u_ModelMatrix * a_Position;\n'</span> <span class="token operator">+</span>
  <span class="token string">'  v_Color = a_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'}\n'</span><span class="token punctuation">;</span>

<span class="token comment">// 片元着色器同上</span>

<span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token function">initVertexBuffers</span><span class="token punctuation">(</span>gl<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> u_ModelMatrix <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'u_ModelMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> u_ViewMatrix <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'u_ViewMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> u_ProjMatrix <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'u_ProjMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>u_ModelMatrix <span class="token operator">||</span> <span class="token operator">!</span>u_ViewMatrix <span class="token operator">||</span> <span class="token operator">!</span>u_ProjMatrix<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to Get the storage locations of u_ModelMatrix, u_ViewMatrix, and/or u_ProjMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">var</span> modelMatrix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 模型矩阵</span>
  <span class="token keyword">var</span> viewMatrix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 视图矩阵</span>
  <span class="token keyword">var</span> projMatrix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 投影矩阵</span>

  <span class="token comment">// 计算模型矩阵、视图矩阵和投影矩阵 matrix</span>
  modelMatrix<span class="token punctuation">.</span><span class="token function">setTranslate</span><span class="token punctuation">(</span><span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// x 轴平移 0.75 个单位</span>
  viewMatrix<span class="token punctuation">.</span><span class="token function">setLookAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  projMatrix<span class="token punctuation">.</span><span class="token function">setPerspective</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> canvas<span class="token punctuation">.</span>width<span class="token operator">/</span>canvas<span class="token punctuation">.</span>height<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  gl<span class="token punctuation">.</span><span class="token function">uniformMatrix4fv</span><span class="token punctuation">(</span>u_ModelMatrix<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> modelMatrix<span class="token punctuation">.</span>elements<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">uniformMatrix4fv</span><span class="token punctuation">(</span>u_ViewMatrix<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> viewMatrix<span class="token punctuation">.</span>elements<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">uniformMatrix4fv</span><span class="token punctuation">(</span>u_ProjMatrix<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> projMatrix<span class="token punctuation">.</span>elements<span class="token punctuation">)</span><span class="token punctuation">;</span>

  gl<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">COLOR_BUFFER_BIT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  gl<span class="token punctuation">.</span><span class="token function">drawArrays</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TRIANGLES</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 绘制右侧的一组三角形</span>

  <span class="token comment">// 为另一侧的三角形重新计算模型矩阵</span>
  modelMatrix<span class="token punctuation">.</span><span class="token function">setTranslate</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// x 轴平移 -0.75 单位</span>
  <span class="token comment">// 修改模型矩阵</span>
  gl<span class="token punctuation">.</span><span class="token function">uniformMatrix4fv</span><span class="token punctuation">(</span>u_ModelMatrix<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> modelMatrix<span class="token punctuation">.</span>elements<span class="token punctuation">)</span><span class="token punctuation">;</span>

  gl<span class="token punctuation">.</span><span class="token function">drawArrays</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TRIANGLES</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 绘制左侧的一组三角形</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">initVertexBuffers</span><span class="token punctuation">(</span><span class="token parameter">gl</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> verticesColors <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token comment">// 顶点坐标以及颜色</span>
     <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">4.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">4.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>
     <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">4.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span> 

     <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">2.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">2.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>
     <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">2.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span> 

     <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>   <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span>   <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
     <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span>   <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span>  <span class="token number">0.4</span><span class="token punctuation">,</span> 
  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> vertexColorbuffer <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">createBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>vertexColorbuffer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to create the buffer object'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  gl<span class="token punctuation">.</span><span class="token function">bindBuffer</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">ARRAY_BUFFER</span><span class="token punctuation">,</span> vertexColorbuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">bufferData</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">ARRAY_BUFFER</span><span class="token punctuation">,</span> verticesColors<span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">STATIC_DRAW</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> <span class="token constant">FSIZE</span> <span class="token operator">=</span> verticesColors<span class="token punctuation">.</span><span class="token constant">BYTES_PER_ELEMENT</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> a_Position <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getAttribLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'a_Position'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>a_Position <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the storage location of a_Position'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  gl<span class="token punctuation">.</span><span class="token function">vertexAttribPointer</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">FLOAT</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token constant">FSIZE</span> <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">enableVertexAttribArray</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> a_Color <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getAttribLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'a_Color'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>a_Color <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the storage location of a_Color'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  gl<span class="token punctuation">.</span><span class="token function">vertexAttribPointer</span><span class="token punctuation">(</span>a_Color<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">FLOAT</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token constant">FSIZE</span> <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token constant">FSIZE</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">enableVertexAttribArray</span><span class="token punctuation">(</span>a_Color<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> n<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>上面例子中，我们通过在顶点着色器中计算好矩阵进行相乘计算最终的结果，可以在 JavaScript 中计算好结果然后传递给顶点着色器，传入的矩阵被称为模型视图投影矩阵。如下代码：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 顶点着色器</span>
<span class="token keyword">var</span> <span class="token constant">VSHADER_SOURCE</span> <span class="token operator">=</span>
  <span class="token string">'attribute vec4 a_Position;\n'</span> <span class="token operator">+</span>
  <span class="token string">'attribute vec4 a_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'uniform mat4 u_MvpMatrix;\n'</span> <span class="token operator">+</span>
  <span class="token string">'varying vec4 v_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'void main() {\n'</span> <span class="token operator">+</span>
  <span class="token string">'  gl_Position = u_MvpMatrix * a_Position;\n'</span> <span class="token operator">+</span>
  <span class="token string">'  v_Color = a_Color;\n'</span> <span class="token operator">+</span>
  <span class="token string">'}\n'</span><span class="token punctuation">;</span>

<span class="token comment">// 片元着色器同上</span>

<span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> u_MvpMatrix <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">'u_MvpMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>u_MvpMatrix<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Failed to get the storage location of u_MvpMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">var</span> modelMatrix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 模型矩阵</span>
  <span class="token keyword">var</span> viewMatrix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 视图矩阵</span>
  <span class="token keyword">var</span> projMatrix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 投影矩阵</span>
  <span class="token keyword">var</span> mvpMatrix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 模型视图投影矩阵</span>

  <span class="token comment">// 计算模型、视图、投影矩阵</span>
  modelMatrix<span class="token punctuation">.</span><span class="token function">setTranslate</span><span class="token punctuation">(</span><span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  viewMatrix<span class="token punctuation">.</span><span class="token function">setLookAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  projMatrix<span class="token punctuation">.</span><span class="token function">setPerspective</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> canvas<span class="token punctuation">.</span>width<span class="token operator">/</span>canvas<span class="token punctuation">.</span>height<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 计算模型视图投影矩阵</span>
  mvpMatrix<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>projMatrix<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>viewMatrix<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>modelMatrix<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 将模型视图投影矩阵传递给 u_MvpMatrix</span>
  gl<span class="token punctuation">.</span><span class="token function">uniformMatrix4fv</span><span class="token punctuation">(</span>u_MvpMatrix<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> mvpMatrix<span class="token punctuation">.</span>elements<span class="token punctuation">)</span><span class="token punctuation">;</span>

  gl<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">COLOR_BUFFER_BIT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  gl<span class="token punctuation">.</span><span class="token function">drawArrays</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TRIANGLES</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>

  modelMatrix<span class="token punctuation">.</span><span class="token function">setTranslate</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  mvpMatrix<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>projMatrix<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>viewMatrix<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>modelMatrix<span class="token punctuation">)</span><span class="token punctuation">;</span>

  gl<span class="token punctuation">.</span><span class="token function">uniformMatrix4fv</span><span class="token punctuation">(</span>u_MvpMatrix<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> mvpMatrix<span class="token punctuation">.</span>elements<span class="token punctuation">)</span><span class="token punctuation">;</span>

  gl<span class="token punctuation">.</span><span class="token function">drawArrays</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TRIANGLES</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="正确处理对象的前后关系"><a href="#正确处理对象的前后关系" class="header-anchor">#</a> 正确处理对象的前后关系</h2> <p>webgl 在默认情况下会按照缓冲区中的顺序绘制图形，而且后绘制的图形覆盖先绘制的图形，因为这样做很高效。如果场景中的对象不发生运动，观察者的状态也是唯一的，那么这种做法没有问题。但是如果，比如说你希望不断移动视点，从不同的角度看物体，那么你不可能事先决定对象出现的顺序。</p> <h3 id="隐藏面消失"><a href="#隐藏面消失" class="header-anchor">#</a> 隐藏面消失</h3> <p>webgl 提供了隐藏面消失功能。可以消除那些被遮挡的表面。</p> <p>开启隐藏面消除功能需要两步：</p> <ol><li>开启隐藏消除功能：gl.enable(gl.DEPTH_TEST)</li> <li>在绘制之前，清除深度缓冲区：gl.clear(gl.DEPTH_BUFFER_BIT)</li></ol> <p>gl.enable() 函数说明如下：</p> <p><img src="/note/assets/img/glenable.9be763d2.png" alt="avatar"></p> <p>在第二步中，清除深度缓冲区，深度缓冲区是一个中间对象，其作用是帮助 webgl 进行隐藏；</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新:</span> <span class="time">11/3/2020, 5:35:57 PM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/note/assets/js/app.f3710e1e.js" defer></script><script src="/note/assets/js/2.a05a71ea.js" defer></script><script src="/note/assets/js/6.caa615f9.js" defer></script>
  </body>
</html>
